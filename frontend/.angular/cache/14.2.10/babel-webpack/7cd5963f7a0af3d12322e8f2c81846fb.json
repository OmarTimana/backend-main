{"ast":null,"code":"/*!\nFullCalendar v5.11.3\nDocs & License: https://fullcalendar.io/\n(c) 2022 Adam Shaw\n*/\nimport './main.css';\nimport { hasBgRendering, Splitter, createFormatter, createElement, ViewContextType, RenderHook, BaseComponent, createRef, diffDays, buildNavLinkAttrs, WeekNumberRoot, getStickyHeaderDates, ViewRoot, SimpleScrollGrid, getStickyFooterScrollbar, NowTimer, NowIndicatorRoot, renderScrollShim, DateComponent, rangeContainsMarker, startOfDay, asRoughMs, createDuration, RefMap, PositionCache, MoreLinkRoot, setRef, SegHierarchy, groupIntersectingEntries, buildEntryKey, binarySearch, getEntrySpanEnd, StandardEvent, DayCellContent, Fragment, getSegMeta, memoize, sortEventSegs, DayCellRoot, buildIsoString, computeEarliestSegStart, buildEventRangeKey, BgEvent, renderFill, addDurations, multiplyDuration, wholeDivideDurations, intersectRanges, Slicer, formatIsoTimeString, DayHeader, DaySeriesModel, DayTableModel, createPlugin } from '@fullcalendar/common';\nimport { __extends, __assign } from 'tslib';\nimport { DayTable } from '@fullcalendar/daygrid';\n\nvar AllDaySplitter =\n/** @class */\nfunction (_super) {\n  __extends(AllDaySplitter, _super);\n\n  function AllDaySplitter() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  AllDaySplitter.prototype.getKeyInfo = function () {\n    return {\n      allDay: {},\n      timed: {}\n    };\n  };\n\n  AllDaySplitter.prototype.getKeysForDateSpan = function (dateSpan) {\n    if (dateSpan.allDay) {\n      return ['allDay'];\n    }\n\n    return ['timed'];\n  };\n\n  AllDaySplitter.prototype.getKeysForEventDef = function (eventDef) {\n    if (!eventDef.allDay) {\n      return ['timed'];\n    }\n\n    if (hasBgRendering(eventDef)) {\n      return ['timed', 'allDay'];\n    }\n\n    return ['allDay'];\n  };\n\n  return AllDaySplitter;\n}(Splitter);\n\nvar DEFAULT_SLAT_LABEL_FORMAT = createFormatter({\n  hour: 'numeric',\n  minute: '2-digit',\n  omitZeroMinute: true,\n  meridiem: 'short'\n});\n\nfunction TimeColsAxisCell(props) {\n  var classNames = ['fc-timegrid-slot', 'fc-timegrid-slot-label', props.isLabeled ? 'fc-scrollgrid-shrink' : 'fc-timegrid-slot-minor'];\n  return createElement(ViewContextType.Consumer, null, function (context) {\n    if (!props.isLabeled) {\n      return createElement(\"td\", {\n        className: classNames.join(' '),\n        \"data-time\": props.isoTimeStr\n      });\n    }\n\n    var dateEnv = context.dateEnv,\n        options = context.options,\n        viewApi = context.viewApi;\n    var labelFormat = // TODO: fully pre-parse\n    options.slotLabelFormat == null ? DEFAULT_SLAT_LABEL_FORMAT : Array.isArray(options.slotLabelFormat) ? createFormatter(options.slotLabelFormat[0]) : createFormatter(options.slotLabelFormat);\n    var hookProps = {\n      level: 0,\n      time: props.time,\n      date: dateEnv.toDate(props.date),\n      view: viewApi,\n      text: dateEnv.format(props.date, labelFormat)\n    };\n    return createElement(RenderHook, {\n      hookProps: hookProps,\n      classNames: options.slotLabelClassNames,\n      content: options.slotLabelContent,\n      defaultContent: renderInnerContent,\n      didMount: options.slotLabelDidMount,\n      willUnmount: options.slotLabelWillUnmount\n    }, function (rootElRef, customClassNames, innerElRef, innerContent) {\n      return createElement(\"td\", {\n        ref: rootElRef,\n        className: classNames.concat(customClassNames).join(' '),\n        \"data-time\": props.isoTimeStr\n      }, createElement(\"div\", {\n        className: \"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame\"\n      }, createElement(\"div\", {\n        className: \"fc-timegrid-slot-label-cushion fc-scrollgrid-shrink-cushion\",\n        ref: innerElRef\n      }, innerContent)));\n    });\n  });\n}\n\nfunction renderInnerContent(props) {\n  return props.text;\n}\n\nvar TimeBodyAxis =\n/** @class */\nfunction (_super) {\n  __extends(TimeBodyAxis, _super);\n\n  function TimeBodyAxis() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeBodyAxis.prototype.render = function () {\n    return this.props.slatMetas.map(function (slatMeta) {\n      return createElement(\"tr\", {\n        key: slatMeta.key\n      }, createElement(TimeColsAxisCell, __assign({}, slatMeta)));\n    });\n  };\n\n  return TimeBodyAxis;\n}(BaseComponent);\n\nvar DEFAULT_WEEK_NUM_FORMAT = createFormatter({\n  week: 'short'\n});\nvar AUTO_ALL_DAY_MAX_EVENT_ROWS = 5;\n\nvar TimeColsView =\n/** @class */\nfunction (_super) {\n  __extends(TimeColsView, _super);\n\n  function TimeColsView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.allDaySplitter = new AllDaySplitter(); // for use by subclasses\n\n    _this.headerElRef = createRef();\n    _this.rootElRef = createRef();\n    _this.scrollerElRef = createRef();\n    _this.state = {\n      slatCoords: null\n    };\n\n    _this.handleScrollTopRequest = function (scrollTop) {\n      var scrollerEl = _this.scrollerElRef.current;\n\n      if (scrollerEl) {\n        // TODO: not sure how this could ever be null. weirdness with the reducer\n        scrollerEl.scrollTop = scrollTop;\n      }\n    };\n    /* Header Render Methods\n    ------------------------------------------------------------------------------------------------------------------*/\n\n\n    _this.renderHeadAxis = function (rowKey, frameHeight) {\n      if (frameHeight === void 0) {\n        frameHeight = '';\n      }\n\n      var options = _this.context.options;\n      var dateProfile = _this.props.dateProfile;\n      var range = dateProfile.renderRange;\n      var dayCnt = diffDays(range.start, range.end);\n      var navLinkAttrs = dayCnt === 1 // only do in day views (to avoid doing in week views that dont need it)\n      ? buildNavLinkAttrs(_this.context, range.start, 'week') : {};\n\n      if (options.weekNumbers && rowKey === 'day') {\n        return createElement(WeekNumberRoot, {\n          date: range.start,\n          defaultFormat: DEFAULT_WEEK_NUM_FORMAT\n        }, function (rootElRef, classNames, innerElRef, innerContent) {\n          return createElement(\"th\", {\n            ref: rootElRef,\n            \"aria-hidden\": true,\n            className: ['fc-timegrid-axis', 'fc-scrollgrid-shrink'].concat(classNames).join(' ')\n          }, createElement(\"div\", {\n            className: \"fc-timegrid-axis-frame fc-scrollgrid-shrink-frame fc-timegrid-axis-frame-liquid\",\n            style: {\n              height: frameHeight\n            }\n          }, createElement(\"a\", __assign({\n            ref: innerElRef,\n            className: \"fc-timegrid-axis-cushion fc-scrollgrid-shrink-cushion fc-scrollgrid-sync-inner\"\n          }, navLinkAttrs), innerContent)));\n        });\n      }\n\n      return createElement(\"th\", {\n        \"aria-hidden\": true,\n        className: \"fc-timegrid-axis\"\n      }, createElement(\"div\", {\n        className: \"fc-timegrid-axis-frame\",\n        style: {\n          height: frameHeight\n        }\n      }));\n    };\n    /* Table Component Render Methods\n    ------------------------------------------------------------------------------------------------------------------*/\n    // only a one-way height sync. we don't send the axis inner-content height to the DayGrid,\n    // but DayGrid still needs to have classNames on inner elements in order to measure.\n\n\n    _this.renderTableRowAxis = function (rowHeight) {\n      var _a = _this.context,\n          options = _a.options,\n          viewApi = _a.viewApi;\n      var hookProps = {\n        text: options.allDayText,\n        view: viewApi\n      };\n      return (// TODO: make reusable hook. used in list view too\n        createElement(RenderHook, {\n          hookProps: hookProps,\n          classNames: options.allDayClassNames,\n          content: options.allDayContent,\n          defaultContent: renderAllDayInner,\n          didMount: options.allDayDidMount,\n          willUnmount: options.allDayWillUnmount\n        }, function (rootElRef, classNames, innerElRef, innerContent) {\n          return createElement(\"td\", {\n            ref: rootElRef,\n            \"aria-hidden\": true,\n            className: ['fc-timegrid-axis', 'fc-scrollgrid-shrink'].concat(classNames).join(' ')\n          }, createElement(\"div\", {\n            className: 'fc-timegrid-axis-frame fc-scrollgrid-shrink-frame' + (rowHeight == null ? ' fc-timegrid-axis-frame-liquid' : ''),\n            style: {\n              height: rowHeight\n            }\n          }, createElement(\"span\", {\n            className: \"fc-timegrid-axis-cushion fc-scrollgrid-shrink-cushion fc-scrollgrid-sync-inner\",\n            ref: innerElRef\n          }, innerContent)));\n        })\n      );\n    };\n\n    _this.handleSlatCoords = function (slatCoords) {\n      _this.setState({\n        slatCoords: slatCoords\n      });\n    };\n\n    return _this;\n  } // rendering\n  // ----------------------------------------------------------------------------------------------------\n\n\n  TimeColsView.prototype.renderSimpleLayout = function (headerRowContent, allDayContent, timeContent) {\n    var _a = this,\n        context = _a.context,\n        props = _a.props;\n\n    var sections = [];\n    var stickyHeaderDates = getStickyHeaderDates(context.options);\n\n    if (headerRowContent) {\n      sections.push({\n        type: 'header',\n        key: 'header',\n        isSticky: stickyHeaderDates,\n        chunk: {\n          elRef: this.headerElRef,\n          tableClassName: 'fc-col-header',\n          rowContent: headerRowContent\n        }\n      });\n    }\n\n    if (allDayContent) {\n      sections.push({\n        type: 'body',\n        key: 'all-day',\n        chunk: {\n          content: allDayContent\n        }\n      });\n      sections.push({\n        type: 'body',\n        key: 'all-day-divider',\n        outerContent: // TODO: rename to cellContent so don't need to define <tr>?\n        createElement(\"tr\", {\n          role: \"presentation\",\n          className: \"fc-scrollgrid-section\"\n        }, createElement(\"td\", {\n          className: 'fc-timegrid-divider ' + context.theme.getClass('tableCellShaded')\n        }))\n      });\n    }\n\n    sections.push({\n      type: 'body',\n      key: 'body',\n      liquid: true,\n      expandRows: Boolean(context.options.expandRows),\n      chunk: {\n        scrollerElRef: this.scrollerElRef,\n        content: timeContent\n      }\n    });\n    return createElement(ViewRoot, {\n      viewSpec: context.viewSpec,\n      elRef: this.rootElRef\n    }, function (rootElRef, classNames) {\n      return createElement(\"div\", {\n        className: ['fc-timegrid'].concat(classNames).join(' '),\n        ref: rootElRef\n      }, createElement(SimpleScrollGrid, {\n        liquid: !props.isHeightAuto && !props.forPrint,\n        collapsibleWidth: props.forPrint,\n        cols: [{\n          width: 'shrink'\n        }],\n        sections: sections\n      }));\n    });\n  };\n\n  TimeColsView.prototype.renderHScrollLayout = function (headerRowContent, allDayContent, timeContent, colCnt, dayMinWidth, slatMetas, slatCoords) {\n    var _this = this;\n\n    var ScrollGrid = this.context.pluginHooks.scrollGridImpl;\n\n    if (!ScrollGrid) {\n      throw new Error('No ScrollGrid implementation');\n    }\n\n    var _a = this,\n        context = _a.context,\n        props = _a.props;\n\n    var stickyHeaderDates = !props.forPrint && getStickyHeaderDates(context.options);\n    var stickyFooterScrollbar = !props.forPrint && getStickyFooterScrollbar(context.options);\n    var sections = [];\n\n    if (headerRowContent) {\n      sections.push({\n        type: 'header',\n        key: 'header',\n        isSticky: stickyHeaderDates,\n        syncRowHeights: true,\n        chunks: [{\n          key: 'axis',\n          rowContent: function (arg) {\n            return createElement(\"tr\", {\n              role: \"presentation\"\n            }, _this.renderHeadAxis('day', arg.rowSyncHeights[0]));\n          }\n        }, {\n          key: 'cols',\n          elRef: this.headerElRef,\n          tableClassName: 'fc-col-header',\n          rowContent: headerRowContent\n        }]\n      });\n    }\n\n    if (allDayContent) {\n      sections.push({\n        type: 'body',\n        key: 'all-day',\n        syncRowHeights: true,\n        chunks: [{\n          key: 'axis',\n          rowContent: function (contentArg) {\n            return createElement(\"tr\", {\n              role: \"presentation\"\n            }, _this.renderTableRowAxis(contentArg.rowSyncHeights[0]));\n          }\n        }, {\n          key: 'cols',\n          content: allDayContent\n        }]\n      });\n      sections.push({\n        key: 'all-day-divider',\n        type: 'body',\n        outerContent: // TODO: rename to cellContent so don't need to define <tr>?\n        createElement(\"tr\", {\n          role: \"presentation\",\n          className: \"fc-scrollgrid-section\"\n        }, createElement(\"td\", {\n          colSpan: 2,\n          className: 'fc-timegrid-divider ' + context.theme.getClass('tableCellShaded')\n        }))\n      });\n    }\n\n    var isNowIndicator = context.options.nowIndicator;\n    sections.push({\n      type: 'body',\n      key: 'body',\n      liquid: true,\n      expandRows: Boolean(context.options.expandRows),\n      chunks: [{\n        key: 'axis',\n        content: function (arg) {\n          return (// TODO: make this now-indicator arrow more DRY with TimeColsContent\n            createElement(\"div\", {\n              className: \"fc-timegrid-axis-chunk\"\n            }, createElement(\"table\", {\n              \"aria-hidden\": true,\n              style: {\n                height: arg.expandRows ? arg.clientHeight : ''\n              }\n            }, arg.tableColGroupNode, createElement(\"tbody\", null, createElement(TimeBodyAxis, {\n              slatMetas: slatMetas\n            }))), createElement(\"div\", {\n              className: \"fc-timegrid-now-indicator-container\"\n            }, createElement(NowTimer, {\n              unit: isNowIndicator ? 'minute' : 'day'\n              /* hacky */\n\n            }, function (nowDate) {\n              var nowIndicatorTop = isNowIndicator && slatCoords && slatCoords.safeComputeTop(nowDate); // might return void\n\n              if (typeof nowIndicatorTop === 'number') {\n                return createElement(NowIndicatorRoot, {\n                  isAxis: true,\n                  date: nowDate\n                }, function (rootElRef, classNames, innerElRef, innerContent) {\n                  return createElement(\"div\", {\n                    ref: rootElRef,\n                    className: ['fc-timegrid-now-indicator-arrow'].concat(classNames).join(' '),\n                    style: {\n                      top: nowIndicatorTop\n                    }\n                  }, innerContent);\n                });\n              }\n\n              return null;\n            })))\n          );\n        }\n      }, {\n        key: 'cols',\n        scrollerElRef: this.scrollerElRef,\n        content: timeContent\n      }]\n    });\n\n    if (stickyFooterScrollbar) {\n      sections.push({\n        key: 'footer',\n        type: 'footer',\n        isSticky: true,\n        chunks: [{\n          key: 'axis',\n          content: renderScrollShim\n        }, {\n          key: 'cols',\n          content: renderScrollShim\n        }]\n      });\n    }\n\n    return createElement(ViewRoot, {\n      viewSpec: context.viewSpec,\n      elRef: this.rootElRef\n    }, function (rootElRef, classNames) {\n      return createElement(\"div\", {\n        className: ['fc-timegrid'].concat(classNames).join(' '),\n        ref: rootElRef\n      }, createElement(ScrollGrid, {\n        liquid: !props.isHeightAuto && !props.forPrint,\n        collapsibleWidth: false,\n        colGroups: [{\n          width: 'shrink',\n          cols: [{\n            width: 'shrink'\n          }]\n        }, {\n          cols: [{\n            span: colCnt,\n            minWidth: dayMinWidth\n          }]\n        }],\n        sections: sections\n      }));\n    });\n  };\n  /* Dimensions\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  TimeColsView.prototype.getAllDayMaxEventProps = function () {\n    var _a = this.context.options,\n        dayMaxEvents = _a.dayMaxEvents,\n        dayMaxEventRows = _a.dayMaxEventRows;\n\n    if (dayMaxEvents === true || dayMaxEventRows === true) {\n      // is auto?\n      dayMaxEvents = undefined;\n      dayMaxEventRows = AUTO_ALL_DAY_MAX_EVENT_ROWS; // make sure \"auto\" goes to a real number\n    }\n\n    return {\n      dayMaxEvents: dayMaxEvents,\n      dayMaxEventRows: dayMaxEventRows\n    };\n  };\n\n  return TimeColsView;\n}(DateComponent);\n\nfunction renderAllDayInner(hookProps) {\n  return hookProps.text;\n}\n\nvar TimeColsSlatsCoords =\n/** @class */\nfunction () {\n  function TimeColsSlatsCoords(positions, dateProfile, slotDuration) {\n    this.positions = positions;\n    this.dateProfile = dateProfile;\n    this.slotDuration = slotDuration;\n  }\n\n  TimeColsSlatsCoords.prototype.safeComputeTop = function (date) {\n    var dateProfile = this.dateProfile;\n\n    if (rangeContainsMarker(dateProfile.currentRange, date)) {\n      var startOfDayDate = startOfDay(date);\n      var timeMs = date.valueOf() - startOfDayDate.valueOf();\n\n      if (timeMs >= asRoughMs(dateProfile.slotMinTime) && timeMs < asRoughMs(dateProfile.slotMaxTime)) {\n        return this.computeTimeTop(createDuration(timeMs));\n      }\n    }\n\n    return null;\n  }; // Computes the top coordinate, relative to the bounds of the grid, of the given date.\n  // A `startOfDayDate` must be given for avoiding ambiguity over how to treat midnight.\n\n\n  TimeColsSlatsCoords.prototype.computeDateTop = function (when, startOfDayDate) {\n    if (!startOfDayDate) {\n      startOfDayDate = startOfDay(when);\n    }\n\n    return this.computeTimeTop(createDuration(when.valueOf() - startOfDayDate.valueOf()));\n  }; // Computes the top coordinate, relative to the bounds of the grid, of the given time (a Duration).\n  // This is a makeshify way to compute the time-top. Assumes all slatMetas dates are uniform.\n  // Eventually allow computation with arbirary slat dates.\n\n\n  TimeColsSlatsCoords.prototype.computeTimeTop = function (duration) {\n    var _a = this,\n        positions = _a.positions,\n        dateProfile = _a.dateProfile;\n\n    var len = positions.els.length; // floating-point value of # of slots covered\n\n    var slatCoverage = (duration.milliseconds - asRoughMs(dateProfile.slotMinTime)) / asRoughMs(this.slotDuration);\n    var slatIndex;\n    var slatRemainder; // compute a floating-point number for how many slats should be progressed through.\n    // from 0 to number of slats (inclusive)\n    // constrained because slotMinTime/slotMaxTime might be customized.\n\n    slatCoverage = Math.max(0, slatCoverage);\n    slatCoverage = Math.min(len, slatCoverage); // an integer index of the furthest whole slat\n    // from 0 to number slats (*exclusive*, so len-1)\n\n    slatIndex = Math.floor(slatCoverage);\n    slatIndex = Math.min(slatIndex, len - 1); // how much further through the slatIndex slat (from 0.0-1.0) must be covered in addition.\n    // could be 1.0 if slatCoverage is covering *all* the slots\n\n    slatRemainder = slatCoverage - slatIndex;\n    return positions.tops[slatIndex] + positions.getHeight(slatIndex) * slatRemainder;\n  };\n\n  return TimeColsSlatsCoords;\n}();\n\nvar TimeColsSlatsBody =\n/** @class */\nfunction (_super) {\n  __extends(TimeColsSlatsBody, _super);\n\n  function TimeColsSlatsBody() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeColsSlatsBody.prototype.render = function () {\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var options = context.options;\n    var slatElRefs = props.slatElRefs;\n    return createElement(\"tbody\", null, props.slatMetas.map(function (slatMeta, i) {\n      var hookProps = {\n        time: slatMeta.time,\n        date: context.dateEnv.toDate(slatMeta.date),\n        view: context.viewApi\n      };\n      var classNames = ['fc-timegrid-slot', 'fc-timegrid-slot-lane', slatMeta.isLabeled ? '' : 'fc-timegrid-slot-minor'];\n      return createElement(\"tr\", {\n        key: slatMeta.key,\n        ref: slatElRefs.createRef(slatMeta.key)\n      }, props.axis && createElement(TimeColsAxisCell, __assign({}, slatMeta)), createElement(RenderHook, {\n        hookProps: hookProps,\n        classNames: options.slotLaneClassNames,\n        content: options.slotLaneContent,\n        didMount: options.slotLaneDidMount,\n        willUnmount: options.slotLaneWillUnmount\n      }, function (rootElRef, customClassNames, innerElRef, innerContent) {\n        return createElement(\"td\", {\n          ref: rootElRef,\n          className: classNames.concat(customClassNames).join(' '),\n          \"data-time\": slatMeta.isoTimeStr\n        }, innerContent);\n      }));\n    }));\n  };\n\n  return TimeColsSlatsBody;\n}(BaseComponent);\n/*\nfor the horizontal \"slats\" that run width-wise. Has a time axis on a side. Depends on RTL.\n*/\n\n\nvar TimeColsSlats =\n/** @class */\nfunction (_super) {\n  __extends(TimeColsSlats, _super);\n\n  function TimeColsSlats() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.rootElRef = createRef();\n    _this.slatElRefs = new RefMap();\n    return _this;\n  }\n\n  TimeColsSlats.prototype.render = function () {\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    return createElement(\"div\", {\n      ref: this.rootElRef,\n      className: \"fc-timegrid-slots\"\n    }, createElement(\"table\", {\n      \"aria-hidden\": true,\n      className: context.theme.getClass('table'),\n      style: {\n        minWidth: props.tableMinWidth,\n        width: props.clientWidth,\n        height: props.minHeight\n      }\n    }, props.tableColGroupNode\n    /* relies on there only being a single <col> for the axis */\n    , createElement(TimeColsSlatsBody, {\n      slatElRefs: this.slatElRefs,\n      axis: props.axis,\n      slatMetas: props.slatMetas\n    })));\n  };\n\n  TimeColsSlats.prototype.componentDidMount = function () {\n    this.updateSizing();\n  };\n\n  TimeColsSlats.prototype.componentDidUpdate = function () {\n    this.updateSizing();\n  };\n\n  TimeColsSlats.prototype.componentWillUnmount = function () {\n    if (this.props.onCoords) {\n      this.props.onCoords(null);\n    }\n  };\n\n  TimeColsSlats.prototype.updateSizing = function () {\n    var _a = this,\n        context = _a.context,\n        props = _a.props;\n\n    if (props.onCoords && props.clientWidth !== null // means sizing has stabilized\n    ) {\n      var rootEl = this.rootElRef.current;\n\n      if (rootEl.offsetHeight) {\n        // not hidden by css\n        props.onCoords(new TimeColsSlatsCoords(new PositionCache(this.rootElRef.current, collectSlatEls(this.slatElRefs.currentMap, props.slatMetas), false, true), this.props.dateProfile, context.options.slotDuration));\n      }\n    }\n  };\n\n  return TimeColsSlats;\n}(BaseComponent);\n\nfunction collectSlatEls(elMap, slatMetas) {\n  return slatMetas.map(function (slatMeta) {\n    return elMap[slatMeta.key];\n  });\n}\n\nfunction splitSegsByCol(segs, colCnt) {\n  var segsByCol = [];\n  var i;\n\n  for (i = 0; i < colCnt; i += 1) {\n    segsByCol.push([]);\n  }\n\n  if (segs) {\n    for (i = 0; i < segs.length; i += 1) {\n      segsByCol[segs[i].col].push(segs[i]);\n    }\n  }\n\n  return segsByCol;\n}\n\nfunction splitInteractionByCol(ui, colCnt) {\n  var byRow = [];\n\n  if (!ui) {\n    for (var i = 0; i < colCnt; i += 1) {\n      byRow[i] = null;\n    }\n  } else {\n    for (var i = 0; i < colCnt; i += 1) {\n      byRow[i] = {\n        affectedInstances: ui.affectedInstances,\n        isEvent: ui.isEvent,\n        segs: []\n      };\n    }\n\n    for (var _i = 0, _a = ui.segs; _i < _a.length; _i++) {\n      var seg = _a[_i];\n      byRow[seg.col].segs.push(seg);\n    }\n  }\n\n  return byRow;\n}\n\nvar TimeColMoreLink =\n/** @class */\nfunction (_super) {\n  __extends(TimeColMoreLink, _super);\n\n  function TimeColMoreLink() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.rootElRef = createRef();\n    return _this;\n  }\n\n  TimeColMoreLink.prototype.render = function () {\n    var _this = this;\n\n    var props = this.props;\n    return createElement(MoreLinkRoot, {\n      allDayDate: null,\n      moreCnt: props.hiddenSegs.length,\n      allSegs: props.hiddenSegs,\n      hiddenSegs: props.hiddenSegs,\n      alignmentElRef: this.rootElRef,\n      defaultContent: renderMoreLinkInner,\n      extraDateSpan: props.extraDateSpan,\n      dateProfile: props.dateProfile,\n      todayRange: props.todayRange,\n      popoverContent: function () {\n        return renderPlainFgSegs(props.hiddenSegs, props);\n      }\n    }, function (rootElRef, classNames, innerElRef, innerContent, handleClick, title, isExpanded, popoverId) {\n      return createElement(\"a\", {\n        ref: function (el) {\n          setRef(rootElRef, el);\n          setRef(_this.rootElRef, el);\n        },\n        className: ['fc-timegrid-more-link'].concat(classNames).join(' '),\n        style: {\n          top: props.top,\n          bottom: props.bottom\n        },\n        onClick: handleClick,\n        title: title,\n        \"aria-expanded\": isExpanded,\n        \"aria-controls\": popoverId\n      }, createElement(\"div\", {\n        ref: innerElRef,\n        className: \"fc-timegrid-more-link-inner fc-sticky\"\n      }, innerContent));\n    });\n  };\n\n  return TimeColMoreLink;\n}(BaseComponent);\n\nfunction renderMoreLinkInner(props) {\n  return props.shortText;\n} // segInputs assumed sorted\n\n\nfunction buildPositioning(segInputs, strictOrder, maxStackCnt) {\n  var hierarchy = new SegHierarchy();\n\n  if (strictOrder != null) {\n    hierarchy.strictOrder = strictOrder;\n  }\n\n  if (maxStackCnt != null) {\n    hierarchy.maxStackCnt = maxStackCnt;\n  }\n\n  var hiddenEntries = hierarchy.addSegs(segInputs);\n  var hiddenGroups = groupIntersectingEntries(hiddenEntries);\n  var web = buildWeb(hierarchy);\n  web = stretchWeb(web, 1); // all levelCoords/thickness will have 0.0-1.0\n\n  var segRects = webToRects(web);\n  return {\n    segRects: segRects,\n    hiddenGroups: hiddenGroups\n  };\n}\n\nfunction buildWeb(hierarchy) {\n  var entriesByLevel = hierarchy.entriesByLevel;\n  var buildNode = cacheable(function (level, lateral) {\n    return level + ':' + lateral;\n  }, function (level, lateral) {\n    var siblingRange = findNextLevelSegs(hierarchy, level, lateral);\n    var nextLevelRes = buildNodes(siblingRange, buildNode);\n    var entry = entriesByLevel[level][lateral];\n    return [__assign(__assign({}, entry), {\n      nextLevelNodes: nextLevelRes[0]\n    }), entry.thickness + nextLevelRes[1] // the pressure builds\n    ];\n  });\n  return buildNodes(entriesByLevel.length ? {\n    level: 0,\n    lateralStart: 0,\n    lateralEnd: entriesByLevel[0].length\n  } : null, buildNode)[0];\n}\n\nfunction buildNodes(siblingRange, buildNode) {\n  if (!siblingRange) {\n    return [[], 0];\n  }\n\n  var level = siblingRange.level,\n      lateralStart = siblingRange.lateralStart,\n      lateralEnd = siblingRange.lateralEnd;\n  var lateral = lateralStart;\n  var pairs = [];\n\n  while (lateral < lateralEnd) {\n    pairs.push(buildNode(level, lateral));\n    lateral += 1;\n  }\n\n  pairs.sort(cmpDescPressures);\n  return [pairs.map(extractNode), pairs[0][1] // first item's pressure\n  ];\n}\n\nfunction cmpDescPressures(a, b) {\n  return b[1] - a[1];\n}\n\nfunction extractNode(a) {\n  return a[0];\n}\n\nfunction findNextLevelSegs(hierarchy, subjectLevel, subjectLateral) {\n  var levelCoords = hierarchy.levelCoords,\n      entriesByLevel = hierarchy.entriesByLevel;\n  var subjectEntry = entriesByLevel[subjectLevel][subjectLateral];\n  var afterSubject = levelCoords[subjectLevel] + subjectEntry.thickness;\n  var levelCnt = levelCoords.length;\n  var level = subjectLevel; // skip past levels that are too high up\n\n  for (; level < levelCnt && levelCoords[level] < afterSubject; level += 1); // do nothing\n\n\n  for (; level < levelCnt; level += 1) {\n    var entries = entriesByLevel[level];\n    var entry = void 0;\n    var searchIndex = binarySearch(entries, subjectEntry.span.start, getEntrySpanEnd);\n    var lateralStart = searchIndex[0] + searchIndex[1]; // if exact match (which doesn't collide), go to next one\n\n    var lateralEnd = lateralStart;\n\n    while ( // loop through entries that horizontally intersect\n    (entry = entries[lateralEnd]) && // but not past the whole seg list\n    entry.span.start < subjectEntry.span.end) {\n      lateralEnd += 1;\n    }\n\n    if (lateralStart < lateralEnd) {\n      return {\n        level: level,\n        lateralStart: lateralStart,\n        lateralEnd: lateralEnd\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction stretchWeb(topLevelNodes, totalThickness) {\n  var stretchNode = cacheable(function (node, startCoord, prevThickness) {\n    return buildEntryKey(node);\n  }, function (node, startCoord, prevThickness) {\n    var nextLevelNodes = node.nextLevelNodes,\n        thickness = node.thickness;\n    var allThickness = thickness + prevThickness;\n    var thicknessFraction = thickness / allThickness;\n    var endCoord;\n    var newChildren = [];\n\n    if (!nextLevelNodes.length) {\n      endCoord = totalThickness;\n    } else {\n      for (var _i = 0, nextLevelNodes_1 = nextLevelNodes; _i < nextLevelNodes_1.length; _i++) {\n        var childNode = nextLevelNodes_1[_i];\n\n        if (endCoord === undefined) {\n          var res = stretchNode(childNode, startCoord, allThickness);\n          endCoord = res[0];\n          newChildren.push(res[1]);\n        } else {\n          var res = stretchNode(childNode, endCoord, 0);\n          newChildren.push(res[1]);\n        }\n      }\n    }\n\n    var newThickness = (endCoord - startCoord) * thicknessFraction;\n    return [endCoord - newThickness, __assign(__assign({}, node), {\n      thickness: newThickness,\n      nextLevelNodes: newChildren\n    })];\n  });\n  return topLevelNodes.map(function (node) {\n    return stretchNode(node, 0, 0)[1];\n  });\n} // not sorted in any particular order\n\n\nfunction webToRects(topLevelNodes) {\n  var rects = [];\n  var processNode = cacheable(function (node, levelCoord, stackDepth) {\n    return buildEntryKey(node);\n  }, function (node, levelCoord, stackDepth) {\n    var rect = __assign(__assign({}, node), {\n      levelCoord: levelCoord,\n      stackDepth: stackDepth,\n      stackForward: 0\n    });\n\n    rects.push(rect);\n    return rect.stackForward = processNodes(node.nextLevelNodes, levelCoord + node.thickness, stackDepth + 1) + 1;\n  });\n\n  function processNodes(nodes, levelCoord, stackDepth) {\n    var stackForward = 0;\n\n    for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n      var node = nodes_1[_i];\n      stackForward = Math.max(processNode(node, levelCoord, stackDepth), stackForward);\n    }\n\n    return stackForward;\n  }\n\n  processNodes(topLevelNodes, 0, 0);\n  return rects; // TODO: sort rects by levelCoord to be consistent with toRects?\n} // TODO: move to general util\n\n\nfunction cacheable(keyFunc, workFunc) {\n  var cache = {};\n  return function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    var key = keyFunc.apply(void 0, args);\n    return key in cache ? cache[key] : cache[key] = workFunc.apply(void 0, args);\n  };\n}\n\nfunction computeSegVCoords(segs, colDate, slatCoords, eventMinHeight) {\n  if (slatCoords === void 0) {\n    slatCoords = null;\n  }\n\n  if (eventMinHeight === void 0) {\n    eventMinHeight = 0;\n  }\n\n  var vcoords = [];\n\n  if (slatCoords) {\n    for (var i = 0; i < segs.length; i += 1) {\n      var seg = segs[i];\n      var spanStart = slatCoords.computeDateTop(seg.start, colDate);\n      var spanEnd = Math.max(spanStart + (eventMinHeight || 0), // :(\n      slatCoords.computeDateTop(seg.end, colDate));\n      vcoords.push({\n        start: Math.round(spanStart),\n        end: Math.round(spanEnd) //\n\n      });\n    }\n  }\n\n  return vcoords;\n}\n\nfunction computeFgSegPlacements(segs, segVCoords, // might not have for every seg\neventOrderStrict, eventMaxStack) {\n  var segInputs = [];\n  var dumbSegs = []; // segs without coords\n\n  for (var i = 0; i < segs.length; i += 1) {\n    var vcoords = segVCoords[i];\n\n    if (vcoords) {\n      segInputs.push({\n        index: i,\n        thickness: 1,\n        span: vcoords\n      });\n    } else {\n      dumbSegs.push(segs[i]);\n    }\n  }\n\n  var _a = buildPositioning(segInputs, eventOrderStrict, eventMaxStack),\n      segRects = _a.segRects,\n      hiddenGroups = _a.hiddenGroups;\n\n  var segPlacements = [];\n\n  for (var _i = 0, segRects_1 = segRects; _i < segRects_1.length; _i++) {\n    var segRect = segRects_1[_i];\n    segPlacements.push({\n      seg: segs[segRect.index],\n      rect: segRect\n    });\n  }\n\n  for (var _b = 0, dumbSegs_1 = dumbSegs; _b < dumbSegs_1.length; _b++) {\n    var dumbSeg = dumbSegs_1[_b];\n    segPlacements.push({\n      seg: dumbSeg,\n      rect: null\n    });\n  }\n\n  return {\n    segPlacements: segPlacements,\n    hiddenGroups: hiddenGroups\n  };\n}\n\nvar DEFAULT_TIME_FORMAT = createFormatter({\n  hour: 'numeric',\n  minute: '2-digit',\n  meridiem: false\n});\n\nvar TimeColEvent =\n/** @class */\nfunction (_super) {\n  __extends(TimeColEvent, _super);\n\n  function TimeColEvent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeColEvent.prototype.render = function () {\n    var classNames = ['fc-timegrid-event', 'fc-v-event'];\n\n    if (this.props.isShort) {\n      classNames.push('fc-timegrid-event-short');\n    }\n\n    return createElement(StandardEvent, __assign({}, this.props, {\n      defaultTimeFormat: DEFAULT_TIME_FORMAT,\n      extraClassNames: classNames\n    }));\n  };\n\n  return TimeColEvent;\n}(BaseComponent);\n\nvar TimeColMisc =\n/** @class */\nfunction (_super) {\n  __extends(TimeColMisc, _super);\n\n  function TimeColMisc() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeColMisc.prototype.render = function () {\n    var props = this.props;\n    return createElement(DayCellContent, {\n      date: props.date,\n      dateProfile: props.dateProfile,\n      todayRange: props.todayRange,\n      extraHookProps: props.extraHookProps\n    }, function (innerElRef, innerContent) {\n      return innerContent && createElement(\"div\", {\n        className: \"fc-timegrid-col-misc\",\n        ref: innerElRef\n      }, innerContent);\n    });\n  };\n\n  return TimeColMisc;\n}(BaseComponent);\n\nvar TimeCol =\n/** @class */\nfunction (_super) {\n  __extends(TimeCol, _super);\n\n  function TimeCol() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.sortEventSegs = memoize(sortEventSegs);\n    return _this;\n  } // TODO: memoize event-placement?\n\n\n  TimeCol.prototype.render = function () {\n    var _this = this;\n\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var isSelectMirror = context.options.selectMirror;\n    var mirrorSegs = props.eventDrag && props.eventDrag.segs || props.eventResize && props.eventResize.segs || isSelectMirror && props.dateSelectionSegs || [];\n    var interactionAffectedInstances = // TODO: messy way to compute this\n    props.eventDrag && props.eventDrag.affectedInstances || props.eventResize && props.eventResize.affectedInstances || {};\n    var sortedFgSegs = this.sortEventSegs(props.fgEventSegs, context.options.eventOrder);\n    return createElement(DayCellRoot, {\n      elRef: props.elRef,\n      date: props.date,\n      dateProfile: props.dateProfile,\n      todayRange: props.todayRange,\n      extraHookProps: props.extraHookProps\n    }, function (rootElRef, classNames, dataAttrs) {\n      return createElement(\"td\", __assign({\n        ref: rootElRef,\n        role: \"gridcell\",\n        className: ['fc-timegrid-col'].concat(classNames, props.extraClassNames || []).join(' ')\n      }, dataAttrs, props.extraDataAttrs), createElement(\"div\", {\n        className: \"fc-timegrid-col-frame\"\n      }, createElement(\"div\", {\n        className: \"fc-timegrid-col-bg\"\n      }, _this.renderFillSegs(props.businessHourSegs, 'non-business'), _this.renderFillSegs(props.bgEventSegs, 'bg-event'), _this.renderFillSegs(props.dateSelectionSegs, 'highlight')), createElement(\"div\", {\n        className: \"fc-timegrid-col-events\"\n      }, _this.renderFgSegs(sortedFgSegs, interactionAffectedInstances, false, false, false)), createElement(\"div\", {\n        className: \"fc-timegrid-col-events\"\n      }, _this.renderFgSegs(mirrorSegs, {}, Boolean(props.eventDrag), Boolean(props.eventResize), Boolean(isSelectMirror))), createElement(\"div\", {\n        className: \"fc-timegrid-now-indicator-container\"\n      }, _this.renderNowIndicator(props.nowIndicatorSegs)), createElement(TimeColMisc, {\n        date: props.date,\n        dateProfile: props.dateProfile,\n        todayRange: props.todayRange,\n        extraHookProps: props.extraHookProps\n      })));\n    });\n  };\n\n  TimeCol.prototype.renderFgSegs = function (sortedFgSegs, segIsInvisible, isDragging, isResizing, isDateSelecting) {\n    var props = this.props;\n\n    if (props.forPrint) {\n      return renderPlainFgSegs(sortedFgSegs, props);\n    }\n\n    return this.renderPositionedFgSegs(sortedFgSegs, segIsInvisible, isDragging, isResizing, isDateSelecting);\n  };\n\n  TimeCol.prototype.renderPositionedFgSegs = function (segs, // if not mirror, needs to be sorted\n  segIsInvisible, isDragging, isResizing, isDateSelecting) {\n    var _this = this;\n\n    var _a = this.context.options,\n        eventMaxStack = _a.eventMaxStack,\n        eventShortHeight = _a.eventShortHeight,\n        eventOrderStrict = _a.eventOrderStrict,\n        eventMinHeight = _a.eventMinHeight;\n    var _b = this.props,\n        date = _b.date,\n        slatCoords = _b.slatCoords,\n        eventSelection = _b.eventSelection,\n        todayRange = _b.todayRange,\n        nowDate = _b.nowDate;\n    var isMirror = isDragging || isResizing || isDateSelecting;\n    var segVCoords = computeSegVCoords(segs, date, slatCoords, eventMinHeight);\n\n    var _c = computeFgSegPlacements(segs, segVCoords, eventOrderStrict, eventMaxStack),\n        segPlacements = _c.segPlacements,\n        hiddenGroups = _c.hiddenGroups;\n\n    return createElement(Fragment, null, this.renderHiddenGroups(hiddenGroups, segs), segPlacements.map(function (segPlacement) {\n      var seg = segPlacement.seg,\n          rect = segPlacement.rect;\n      var instanceId = seg.eventRange.instance.instanceId;\n      var isVisible = isMirror || Boolean(!segIsInvisible[instanceId] && rect);\n      var vStyle = computeSegVStyle(rect && rect.span);\n      var hStyle = !isMirror && rect ? _this.computeSegHStyle(rect) : {\n        left: 0,\n        right: 0\n      };\n      var isInset = Boolean(rect) && rect.stackForward > 0;\n      var isShort = Boolean(rect) && rect.span.end - rect.span.start < eventShortHeight; // look at other places for this problem\n\n      return createElement(\"div\", {\n        className: 'fc-timegrid-event-harness' + (isInset ? ' fc-timegrid-event-harness-inset' : ''),\n        key: instanceId,\n        style: __assign(__assign({\n          visibility: isVisible ? '' : 'hidden'\n        }, vStyle), hStyle)\n      }, createElement(TimeColEvent, __assign({\n        seg: seg,\n        isDragging: isDragging,\n        isResizing: isResizing,\n        isDateSelecting: isDateSelecting,\n        isSelected: instanceId === eventSelection,\n        isShort: isShort\n      }, getSegMeta(seg, todayRange, nowDate))));\n    }));\n  }; // will already have eventMinHeight applied because segInputs already had it\n\n\n  TimeCol.prototype.renderHiddenGroups = function (hiddenGroups, segs) {\n    var _a = this.props,\n        extraDateSpan = _a.extraDateSpan,\n        dateProfile = _a.dateProfile,\n        todayRange = _a.todayRange,\n        nowDate = _a.nowDate,\n        eventSelection = _a.eventSelection,\n        eventDrag = _a.eventDrag,\n        eventResize = _a.eventResize;\n    return createElement(Fragment, null, hiddenGroups.map(function (hiddenGroup) {\n      var positionCss = computeSegVStyle(hiddenGroup.span);\n      var hiddenSegs = compileSegsFromEntries(hiddenGroup.entries, segs);\n      return createElement(TimeColMoreLink, {\n        key: buildIsoString(computeEarliestSegStart(hiddenSegs)),\n        hiddenSegs: hiddenSegs,\n        top: positionCss.top,\n        bottom: positionCss.bottom,\n        extraDateSpan: extraDateSpan,\n        dateProfile: dateProfile,\n        todayRange: todayRange,\n        nowDate: nowDate,\n        eventSelection: eventSelection,\n        eventDrag: eventDrag,\n        eventResize: eventResize\n      });\n    }));\n  };\n\n  TimeCol.prototype.renderFillSegs = function (segs, fillType) {\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var segVCoords = computeSegVCoords(segs, props.date, props.slatCoords, context.options.eventMinHeight); // don't assume all populated\n\n    var children = segVCoords.map(function (vcoords, i) {\n      var seg = segs[i];\n      return createElement(\"div\", {\n        key: buildEventRangeKey(seg.eventRange),\n        className: \"fc-timegrid-bg-harness\",\n        style: computeSegVStyle(vcoords)\n      }, fillType === 'bg-event' ? createElement(BgEvent, __assign({\n        seg: seg\n      }, getSegMeta(seg, props.todayRange, props.nowDate))) : renderFill(fillType));\n    });\n    return createElement(Fragment, null, children);\n  };\n\n  TimeCol.prototype.renderNowIndicator = function (segs) {\n    var _a = this.props,\n        slatCoords = _a.slatCoords,\n        date = _a.date;\n\n    if (!slatCoords) {\n      return null;\n    }\n\n    return segs.map(function (seg, i) {\n      return createElement(NowIndicatorRoot, {\n        isAxis: false,\n        date: date,\n        // key doesn't matter. will only ever be one\n        key: i\n      }, function (rootElRef, classNames, innerElRef, innerContent) {\n        return createElement(\"div\", {\n          ref: rootElRef,\n          className: ['fc-timegrid-now-indicator-line'].concat(classNames).join(' '),\n          style: {\n            top: slatCoords.computeDateTop(seg.start, date)\n          }\n        }, innerContent);\n      });\n    });\n  };\n\n  TimeCol.prototype.computeSegHStyle = function (segHCoords) {\n    var _a = this.context,\n        isRtl = _a.isRtl,\n        options = _a.options;\n    var shouldOverlap = options.slotEventOverlap;\n    var nearCoord = segHCoords.levelCoord; // the left side if LTR. the right side if RTL. floating-point\n\n    var farCoord = segHCoords.levelCoord + segHCoords.thickness; // the right side if LTR. the left side if RTL. floating-point\n\n    var left; // amount of space from left edge, a fraction of the total width\n\n    var right; // amount of space from right edge, a fraction of the total width\n\n    if (shouldOverlap) {\n      // double the width, but don't go beyond the maximum forward coordinate (1.0)\n      farCoord = Math.min(1, nearCoord + (farCoord - nearCoord) * 2);\n    }\n\n    if (isRtl) {\n      left = 1 - farCoord;\n      right = nearCoord;\n    } else {\n      left = nearCoord;\n      right = 1 - farCoord;\n    }\n\n    var props = {\n      zIndex: segHCoords.stackDepth + 1,\n      left: left * 100 + '%',\n      right: right * 100 + '%'\n    };\n\n    if (shouldOverlap && !segHCoords.stackForward) {\n      // add padding to the edge so that forward stacked events don't cover the resizer's icon\n      props[isRtl ? 'marginLeft' : 'marginRight'] = 10 * 2; // 10 is a guesstimate of the icon's width\n    }\n\n    return props;\n  };\n\n  return TimeCol;\n}(BaseComponent);\n\nfunction renderPlainFgSegs(sortedFgSegs, _a) {\n  var todayRange = _a.todayRange,\n      nowDate = _a.nowDate,\n      eventSelection = _a.eventSelection,\n      eventDrag = _a.eventDrag,\n      eventResize = _a.eventResize;\n  var hiddenInstances = (eventDrag ? eventDrag.affectedInstances : null) || (eventResize ? eventResize.affectedInstances : null) || {};\n  return createElement(Fragment, null, sortedFgSegs.map(function (seg) {\n    var instanceId = seg.eventRange.instance.instanceId;\n    return createElement(\"div\", {\n      key: instanceId,\n      style: {\n        visibility: hiddenInstances[instanceId] ? 'hidden' : ''\n      }\n    }, createElement(TimeColEvent, __assign({\n      seg: seg,\n      isDragging: false,\n      isResizing: false,\n      isDateSelecting: false,\n      isSelected: instanceId === eventSelection,\n      isShort: false\n    }, getSegMeta(seg, todayRange, nowDate))));\n  }));\n}\n\nfunction computeSegVStyle(segVCoords) {\n  if (!segVCoords) {\n    return {\n      top: '',\n      bottom: ''\n    };\n  }\n\n  return {\n    top: segVCoords.start,\n    bottom: -segVCoords.end\n  };\n}\n\nfunction compileSegsFromEntries(segEntries, allSegs) {\n  return segEntries.map(function (segEntry) {\n    return allSegs[segEntry.index];\n  });\n}\n\nvar TimeColsContent =\n/** @class */\nfunction (_super) {\n  __extends(TimeColsContent, _super);\n\n  function TimeColsContent() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.splitFgEventSegs = memoize(splitSegsByCol);\n    _this.splitBgEventSegs = memoize(splitSegsByCol);\n    _this.splitBusinessHourSegs = memoize(splitSegsByCol);\n    _this.splitNowIndicatorSegs = memoize(splitSegsByCol);\n    _this.splitDateSelectionSegs = memoize(splitSegsByCol);\n    _this.splitEventDrag = memoize(splitInteractionByCol);\n    _this.splitEventResize = memoize(splitInteractionByCol);\n    _this.rootElRef = createRef();\n    _this.cellElRefs = new RefMap();\n    return _this;\n  }\n\n  TimeColsContent.prototype.render = function () {\n    var _this = this;\n\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var nowIndicatorTop = context.options.nowIndicator && props.slatCoords && props.slatCoords.safeComputeTop(props.nowDate); // might return void\n\n    var colCnt = props.cells.length;\n    var fgEventSegsByRow = this.splitFgEventSegs(props.fgEventSegs, colCnt);\n    var bgEventSegsByRow = this.splitBgEventSegs(props.bgEventSegs, colCnt);\n    var businessHourSegsByRow = this.splitBusinessHourSegs(props.businessHourSegs, colCnt);\n    var nowIndicatorSegsByRow = this.splitNowIndicatorSegs(props.nowIndicatorSegs, colCnt);\n    var dateSelectionSegsByRow = this.splitDateSelectionSegs(props.dateSelectionSegs, colCnt);\n    var eventDragByRow = this.splitEventDrag(props.eventDrag, colCnt);\n    var eventResizeByRow = this.splitEventResize(props.eventResize, colCnt);\n    return createElement(\"div\", {\n      className: \"fc-timegrid-cols\",\n      ref: this.rootElRef\n    }, createElement(\"table\", {\n      role: \"presentation\",\n      style: {\n        minWidth: props.tableMinWidth,\n        width: props.clientWidth\n      }\n    }, props.tableColGroupNode, createElement(\"tbody\", {\n      role: \"presentation\"\n    }, createElement(\"tr\", {\n      role: \"row\"\n    }, props.axis && createElement(\"td\", {\n      \"aria-hidden\": true,\n      className: \"fc-timegrid-col fc-timegrid-axis\"\n    }, createElement(\"div\", {\n      className: \"fc-timegrid-col-frame\"\n    }, createElement(\"div\", {\n      className: \"fc-timegrid-now-indicator-container\"\n    }, typeof nowIndicatorTop === 'number' && createElement(NowIndicatorRoot, {\n      isAxis: true,\n      date: props.nowDate\n    }, function (rootElRef, classNames, innerElRef, innerContent) {\n      return createElement(\"div\", {\n        ref: rootElRef,\n        className: ['fc-timegrid-now-indicator-arrow'].concat(classNames).join(' '),\n        style: {\n          top: nowIndicatorTop\n        }\n      }, innerContent);\n    })))), props.cells.map(function (cell, i) {\n      return createElement(TimeCol, {\n        key: cell.key,\n        elRef: _this.cellElRefs.createRef(cell.key),\n        dateProfile: props.dateProfile,\n        date: cell.date,\n        nowDate: props.nowDate,\n        todayRange: props.todayRange,\n        extraHookProps: cell.extraHookProps,\n        extraDataAttrs: cell.extraDataAttrs,\n        extraClassNames: cell.extraClassNames,\n        extraDateSpan: cell.extraDateSpan,\n        fgEventSegs: fgEventSegsByRow[i],\n        bgEventSegs: bgEventSegsByRow[i],\n        businessHourSegs: businessHourSegsByRow[i],\n        nowIndicatorSegs: nowIndicatorSegsByRow[i],\n        dateSelectionSegs: dateSelectionSegsByRow[i],\n        eventDrag: eventDragByRow[i],\n        eventResize: eventResizeByRow[i],\n        slatCoords: props.slatCoords,\n        eventSelection: props.eventSelection,\n        forPrint: props.forPrint\n      });\n    })))));\n  };\n\n  TimeColsContent.prototype.componentDidMount = function () {\n    this.updateCoords();\n  };\n\n  TimeColsContent.prototype.componentDidUpdate = function () {\n    this.updateCoords();\n  };\n\n  TimeColsContent.prototype.updateCoords = function () {\n    var props = this.props;\n\n    if (props.onColCoords && props.clientWidth !== null // means sizing has stabilized\n    ) {\n      props.onColCoords(new PositionCache(this.rootElRef.current, collectCellEls(this.cellElRefs.currentMap, props.cells), true, // horizontal\n      false));\n    }\n  };\n\n  return TimeColsContent;\n}(BaseComponent);\n\nfunction collectCellEls(elMap, cells) {\n  return cells.map(function (cell) {\n    return elMap[cell.key];\n  });\n}\n/* A component that renders one or more columns of vertical time slots\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nvar TimeCols =\n/** @class */\nfunction (_super) {\n  __extends(TimeCols, _super);\n\n  function TimeCols() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.processSlotOptions = memoize(processSlotOptions);\n    _this.state = {\n      slatCoords: null\n    };\n\n    _this.handleRootEl = function (el) {\n      if (el) {\n        _this.context.registerInteractiveComponent(_this, {\n          el: el,\n          isHitComboAllowed: _this.props.isHitComboAllowed\n        });\n      } else {\n        _this.context.unregisterInteractiveComponent(_this);\n      }\n    };\n\n    _this.handleScrollRequest = function (request) {\n      var onScrollTopRequest = _this.props.onScrollTopRequest;\n      var slatCoords = _this.state.slatCoords;\n\n      if (onScrollTopRequest && slatCoords) {\n        if (request.time) {\n          var top_1 = slatCoords.computeTimeTop(request.time);\n          top_1 = Math.ceil(top_1); // zoom can give weird floating-point values. rather scroll a little bit further\n\n          if (top_1) {\n            top_1 += 1; // to overcome top border that slots beyond the first have. looks better\n          }\n\n          onScrollTopRequest(top_1);\n        }\n\n        return true;\n      }\n\n      return false;\n    };\n\n    _this.handleColCoords = function (colCoords) {\n      _this.colCoords = colCoords;\n    };\n\n    _this.handleSlatCoords = function (slatCoords) {\n      _this.setState({\n        slatCoords: slatCoords\n      });\n\n      if (_this.props.onSlatCoords) {\n        _this.props.onSlatCoords(slatCoords);\n      }\n    };\n\n    return _this;\n  }\n\n  TimeCols.prototype.render = function () {\n    var _a = this,\n        props = _a.props,\n        state = _a.state;\n\n    return createElement(\"div\", {\n      className: \"fc-timegrid-body\",\n      ref: this.handleRootEl,\n      style: {\n        // these props are important to give this wrapper correct dimensions for interactions\n        // TODO: if we set it here, can we avoid giving to inner tables?\n        width: props.clientWidth,\n        minWidth: props.tableMinWidth\n      }\n    }, createElement(TimeColsSlats, {\n      axis: props.axis,\n      dateProfile: props.dateProfile,\n      slatMetas: props.slatMetas,\n      clientWidth: props.clientWidth,\n      minHeight: props.expandRows ? props.clientHeight : '',\n      tableMinWidth: props.tableMinWidth,\n      tableColGroupNode: props.axis ? props.tableColGroupNode : null\n      /* axis depends on the colgroup's shrinking */\n      ,\n      onCoords: this.handleSlatCoords\n    }), createElement(TimeColsContent, {\n      cells: props.cells,\n      axis: props.axis,\n      dateProfile: props.dateProfile,\n      businessHourSegs: props.businessHourSegs,\n      bgEventSegs: props.bgEventSegs,\n      fgEventSegs: props.fgEventSegs,\n      dateSelectionSegs: props.dateSelectionSegs,\n      eventSelection: props.eventSelection,\n      eventDrag: props.eventDrag,\n      eventResize: props.eventResize,\n      todayRange: props.todayRange,\n      nowDate: props.nowDate,\n      nowIndicatorSegs: props.nowIndicatorSegs,\n      clientWidth: props.clientWidth,\n      tableMinWidth: props.tableMinWidth,\n      tableColGroupNode: props.tableColGroupNode,\n      slatCoords: state.slatCoords,\n      onColCoords: this.handleColCoords,\n      forPrint: props.forPrint\n    }));\n  };\n\n  TimeCols.prototype.componentDidMount = function () {\n    this.scrollResponder = this.context.createScrollResponder(this.handleScrollRequest);\n  };\n\n  TimeCols.prototype.componentDidUpdate = function (prevProps) {\n    this.scrollResponder.update(prevProps.dateProfile !== this.props.dateProfile);\n  };\n\n  TimeCols.prototype.componentWillUnmount = function () {\n    this.scrollResponder.detach();\n  };\n\n  TimeCols.prototype.queryHit = function (positionLeft, positionTop) {\n    var _a = this.context,\n        dateEnv = _a.dateEnv,\n        options = _a.options;\n    var colCoords = this.colCoords;\n    var dateProfile = this.props.dateProfile;\n    var slatCoords = this.state.slatCoords;\n\n    var _b = this.processSlotOptions(this.props.slotDuration, options.snapDuration),\n        snapDuration = _b.snapDuration,\n        snapsPerSlot = _b.snapsPerSlot;\n\n    var colIndex = colCoords.leftToIndex(positionLeft);\n    var slatIndex = slatCoords.positions.topToIndex(positionTop);\n\n    if (colIndex != null && slatIndex != null) {\n      var cell = this.props.cells[colIndex];\n      var slatTop = slatCoords.positions.tops[slatIndex];\n      var slatHeight = slatCoords.positions.getHeight(slatIndex);\n      var partial = (positionTop - slatTop) / slatHeight; // floating point number between 0 and 1\n\n      var localSnapIndex = Math.floor(partial * snapsPerSlot); // the snap # relative to start of slat\n\n      var snapIndex = slatIndex * snapsPerSlot + localSnapIndex;\n      var dayDate = this.props.cells[colIndex].date;\n      var time = addDurations(dateProfile.slotMinTime, multiplyDuration(snapDuration, snapIndex));\n      var start = dateEnv.add(dayDate, time);\n      var end = dateEnv.add(start, snapDuration);\n      return {\n        dateProfile: dateProfile,\n        dateSpan: __assign({\n          range: {\n            start: start,\n            end: end\n          },\n          allDay: false\n        }, cell.extraDateSpan),\n        dayEl: colCoords.els[colIndex],\n        rect: {\n          left: colCoords.lefts[colIndex],\n          right: colCoords.rights[colIndex],\n          top: slatTop,\n          bottom: slatTop + slatHeight\n        },\n        layer: 0\n      };\n    }\n\n    return null;\n  };\n\n  return TimeCols;\n}(DateComponent);\n\nfunction processSlotOptions(slotDuration, snapDurationOverride) {\n  var snapDuration = snapDurationOverride || slotDuration;\n  var snapsPerSlot = wholeDivideDurations(slotDuration, snapDuration);\n\n  if (snapsPerSlot === null) {\n    snapDuration = slotDuration;\n    snapsPerSlot = 1; // TODO: say warning?\n  }\n\n  return {\n    snapDuration: snapDuration,\n    snapsPerSlot: snapsPerSlot\n  };\n}\n\nvar DayTimeColsSlicer =\n/** @class */\nfunction (_super) {\n  __extends(DayTimeColsSlicer, _super);\n\n  function DayTimeColsSlicer() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DayTimeColsSlicer.prototype.sliceRange = function (range, dayRanges) {\n    var segs = [];\n\n    for (var col = 0; col < dayRanges.length; col += 1) {\n      var segRange = intersectRanges(range, dayRanges[col]);\n\n      if (segRange) {\n        segs.push({\n          start: segRange.start,\n          end: segRange.end,\n          isStart: segRange.start.valueOf() === range.start.valueOf(),\n          isEnd: segRange.end.valueOf() === range.end.valueOf(),\n          col: col\n        });\n      }\n    }\n\n    return segs;\n  };\n\n  return DayTimeColsSlicer;\n}(Slicer);\n\nvar DayTimeCols =\n/** @class */\nfunction (_super) {\n  __extends(DayTimeCols, _super);\n\n  function DayTimeCols() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.buildDayRanges = memoize(buildDayRanges);\n    _this.slicer = new DayTimeColsSlicer();\n    _this.timeColsRef = createRef();\n    return _this;\n  }\n\n  DayTimeCols.prototype.render = function () {\n    var _this = this;\n\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var dateProfile = props.dateProfile,\n        dayTableModel = props.dayTableModel;\n    var isNowIndicator = context.options.nowIndicator;\n    var dayRanges = this.buildDayRanges(dayTableModel, dateProfile, context.dateEnv); // give it the first row of cells\n    // TODO: would move this further down hierarchy, but sliceNowDate needs it\n\n    return createElement(NowTimer, {\n      unit: isNowIndicator ? 'minute' : 'day'\n    }, function (nowDate, todayRange) {\n      return createElement(TimeCols, __assign({\n        ref: _this.timeColsRef\n      }, _this.slicer.sliceProps(props, dateProfile, null, context, dayRanges), {\n        forPrint: props.forPrint,\n        axis: props.axis,\n        dateProfile: dateProfile,\n        slatMetas: props.slatMetas,\n        slotDuration: props.slotDuration,\n        cells: dayTableModel.cells[0],\n        tableColGroupNode: props.tableColGroupNode,\n        tableMinWidth: props.tableMinWidth,\n        clientWidth: props.clientWidth,\n        clientHeight: props.clientHeight,\n        expandRows: props.expandRows,\n        nowDate: nowDate,\n        nowIndicatorSegs: isNowIndicator && _this.slicer.sliceNowDate(nowDate, context, dayRanges),\n        todayRange: todayRange,\n        onScrollTopRequest: props.onScrollTopRequest,\n        onSlatCoords: props.onSlatCoords\n      }));\n    });\n  };\n\n  return DayTimeCols;\n}(DateComponent);\n\nfunction buildDayRanges(dayTableModel, dateProfile, dateEnv) {\n  var ranges = [];\n\n  for (var _i = 0, _a = dayTableModel.headerDates; _i < _a.length; _i++) {\n    var date = _a[_i];\n    ranges.push({\n      start: dateEnv.add(date, dateProfile.slotMinTime),\n      end: dateEnv.add(date, dateProfile.slotMaxTime)\n    });\n  }\n\n  return ranges;\n} // potential nice values for the slot-duration and interval-duration\n// from largest to smallest\n\n\nvar STOCK_SUB_DURATIONS = [{\n  hours: 1\n}, {\n  minutes: 30\n}, {\n  minutes: 15\n}, {\n  seconds: 30\n}, {\n  seconds: 15\n}];\n\nfunction buildSlatMetas(slotMinTime, slotMaxTime, explicitLabelInterval, slotDuration, dateEnv) {\n  var dayStart = new Date(0);\n  var slatTime = slotMinTime;\n  var slatIterator = createDuration(0);\n  var labelInterval = explicitLabelInterval || computeLabelInterval(slotDuration);\n  var metas = [];\n\n  while (asRoughMs(slatTime) < asRoughMs(slotMaxTime)) {\n    var date = dateEnv.add(dayStart, slatTime);\n    var isLabeled = wholeDivideDurations(slatIterator, labelInterval) !== null;\n    metas.push({\n      date: date,\n      time: slatTime,\n      key: date.toISOString(),\n      isoTimeStr: formatIsoTimeString(date),\n      isLabeled: isLabeled\n    });\n    slatTime = addDurations(slatTime, slotDuration);\n    slatIterator = addDurations(slatIterator, slotDuration);\n  }\n\n  return metas;\n} // Computes an automatic value for slotLabelInterval\n\n\nfunction computeLabelInterval(slotDuration) {\n  var i;\n  var labelInterval;\n  var slotsPerLabel; // find the smallest stock label interval that results in more than one slots-per-label\n\n  for (i = STOCK_SUB_DURATIONS.length - 1; i >= 0; i -= 1) {\n    labelInterval = createDuration(STOCK_SUB_DURATIONS[i]);\n    slotsPerLabel = wholeDivideDurations(labelInterval, slotDuration);\n\n    if (slotsPerLabel !== null && slotsPerLabel > 1) {\n      return labelInterval;\n    }\n  }\n\n  return slotDuration; // fall back\n}\n\nvar DayTimeColsView =\n/** @class */\nfunction (_super) {\n  __extends(DayTimeColsView, _super);\n\n  function DayTimeColsView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.buildTimeColsModel = memoize(buildTimeColsModel);\n    _this.buildSlatMetas = memoize(buildSlatMetas);\n    return _this;\n  }\n\n  DayTimeColsView.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.context,\n        options = _a.options,\n        dateEnv = _a.dateEnv,\n        dateProfileGenerator = _a.dateProfileGenerator;\n    var props = this.props;\n    var dateProfile = props.dateProfile;\n    var dayTableModel = this.buildTimeColsModel(dateProfile, dateProfileGenerator);\n    var splitProps = this.allDaySplitter.splitProps(props);\n    var slatMetas = this.buildSlatMetas(dateProfile.slotMinTime, dateProfile.slotMaxTime, options.slotLabelInterval, options.slotDuration, dateEnv);\n    var dayMinWidth = options.dayMinWidth;\n    var hasAttachedAxis = !dayMinWidth;\n    var hasDetachedAxis = dayMinWidth;\n    var headerContent = options.dayHeaders && createElement(DayHeader, {\n      dates: dayTableModel.headerDates,\n      dateProfile: dateProfile,\n      datesRepDistinctDays: true,\n      renderIntro: hasAttachedAxis ? this.renderHeadAxis : null\n    });\n\n    var allDayContent = options.allDaySlot !== false && function (contentArg) {\n      return createElement(DayTable, __assign({}, splitProps.allDay, {\n        dateProfile: dateProfile,\n        dayTableModel: dayTableModel,\n        nextDayThreshold: options.nextDayThreshold,\n        tableMinWidth: contentArg.tableMinWidth,\n        colGroupNode: contentArg.tableColGroupNode,\n        renderRowIntro: hasAttachedAxis ? _this.renderTableRowAxis : null,\n        showWeekNumbers: false,\n        expandRows: false,\n        headerAlignElRef: _this.headerElRef,\n        clientWidth: contentArg.clientWidth,\n        clientHeight: contentArg.clientHeight,\n        forPrint: props.forPrint\n      }, _this.getAllDayMaxEventProps()));\n    };\n\n    var timeGridContent = function (contentArg) {\n      return createElement(DayTimeCols, __assign({}, splitProps.timed, {\n        dayTableModel: dayTableModel,\n        dateProfile: dateProfile,\n        axis: hasAttachedAxis,\n        slotDuration: options.slotDuration,\n        slatMetas: slatMetas,\n        forPrint: props.forPrint,\n        tableColGroupNode: contentArg.tableColGroupNode,\n        tableMinWidth: contentArg.tableMinWidth,\n        clientWidth: contentArg.clientWidth,\n        clientHeight: contentArg.clientHeight,\n        onSlatCoords: _this.handleSlatCoords,\n        expandRows: contentArg.expandRows,\n        onScrollTopRequest: _this.handleScrollTopRequest\n      }));\n    };\n\n    return hasDetachedAxis ? this.renderHScrollLayout(headerContent, allDayContent, timeGridContent, dayTableModel.colCnt, dayMinWidth, slatMetas, this.state.slatCoords) : this.renderSimpleLayout(headerContent, allDayContent, timeGridContent);\n  };\n\n  return DayTimeColsView;\n}(TimeColsView);\n\nfunction buildTimeColsModel(dateProfile, dateProfileGenerator) {\n  var daySeries = new DaySeriesModel(dateProfile.renderRange, dateProfileGenerator);\n  return new DayTableModel(daySeries, false);\n}\n\nvar OPTION_REFINERS = {\n  allDaySlot: Boolean\n};\nvar main = createPlugin({\n  initialView: 'timeGridWeek',\n  optionRefiners: OPTION_REFINERS,\n  views: {\n    timeGrid: {\n      component: DayTimeColsView,\n      usesMinMaxTime: true,\n      allDaySlot: true,\n      slotDuration: '00:30:00',\n      slotEventOverlap: true // a bad name. confused with overlap/constraint system\n\n    },\n    timeGridDay: {\n      type: 'timeGrid',\n      duration: {\n        days: 1\n      }\n    },\n    timeGridWeek: {\n      type: 'timeGrid',\n      duration: {\n        weeks: 1\n      }\n    }\n  }\n});\nexport default main;\nexport { DayTimeCols, DayTimeColsSlicer, DayTimeColsView, TimeCols, TimeColsSlatsCoords, TimeColsView, buildDayRanges, buildSlatMetas, buildTimeColsModel };","map":{"version":3,"names":["hasBgRendering","Splitter","createFormatter","createElement","ViewContextType","RenderHook","BaseComponent","createRef","diffDays","buildNavLinkAttrs","WeekNumberRoot","getStickyHeaderDates","ViewRoot","SimpleScrollGrid","getStickyFooterScrollbar","NowTimer","NowIndicatorRoot","renderScrollShim","DateComponent","rangeContainsMarker","startOfDay","asRoughMs","createDuration","RefMap","PositionCache","MoreLinkRoot","setRef","SegHierarchy","groupIntersectingEntries","buildEntryKey","binarySearch","getEntrySpanEnd","StandardEvent","DayCellContent","Fragment","getSegMeta","memoize","sortEventSegs","DayCellRoot","buildIsoString","computeEarliestSegStart","buildEventRangeKey","BgEvent","renderFill","addDurations","multiplyDuration","wholeDivideDurations","intersectRanges","Slicer","formatIsoTimeString","DayHeader","DaySeriesModel","DayTableModel","createPlugin","__extends","__assign","DayTable","AllDaySplitter","_super","apply","arguments","prototype","getKeyInfo","allDay","timed","getKeysForDateSpan","dateSpan","getKeysForEventDef","eventDef","DEFAULT_SLAT_LABEL_FORMAT","hour","minute","omitZeroMinute","meridiem","TimeColsAxisCell","props","classNames","isLabeled","Consumer","context","className","join","isoTimeStr","dateEnv","options","viewApi","labelFormat","slotLabelFormat","Array","isArray","hookProps","level","time","date","toDate","view","text","format","slotLabelClassNames","content","slotLabelContent","defaultContent","renderInnerContent","didMount","slotLabelDidMount","willUnmount","slotLabelWillUnmount","rootElRef","customClassNames","innerElRef","innerContent","ref","concat","TimeBodyAxis","render","slatMetas","map","slatMeta","key","DEFAULT_WEEK_NUM_FORMAT","week","AUTO_ALL_DAY_MAX_EVENT_ROWS","TimeColsView","_this","allDaySplitter","headerElRef","scrollerElRef","state","slatCoords","handleScrollTopRequest","scrollTop","scrollerEl","current","renderHeadAxis","rowKey","frameHeight","dateProfile","range","renderRange","dayCnt","start","end","navLinkAttrs","weekNumbers","defaultFormat","style","height","renderTableRowAxis","rowHeight","_a","allDayText","allDayClassNames","allDayContent","renderAllDayInner","allDayDidMount","allDayWillUnmount","handleSlatCoords","setState","renderSimpleLayout","headerRowContent","timeContent","sections","stickyHeaderDates","push","type","isSticky","chunk","elRef","tableClassName","rowContent","outerContent","role","theme","getClass","liquid","expandRows","Boolean","viewSpec","isHeightAuto","forPrint","collapsibleWidth","cols","width","renderHScrollLayout","colCnt","dayMinWidth","ScrollGrid","pluginHooks","scrollGridImpl","Error","stickyFooterScrollbar","syncRowHeights","chunks","arg","rowSyncHeights","contentArg","colSpan","isNowIndicator","nowIndicator","clientHeight","tableColGroupNode","unit","nowDate","nowIndicatorTop","safeComputeTop","isAxis","top","colGroups","span","minWidth","getAllDayMaxEventProps","dayMaxEvents","dayMaxEventRows","undefined","TimeColsSlatsCoords","positions","slotDuration","currentRange","startOfDayDate","timeMs","valueOf","slotMinTime","slotMaxTime","computeTimeTop","computeDateTop","when","duration","len","els","length","slatCoverage","milliseconds","slatIndex","slatRemainder","Math","max","min","floor","tops","getHeight","TimeColsSlatsBody","slatElRefs","i","axis","slotLaneClassNames","slotLaneContent","slotLaneDidMount","slotLaneWillUnmount","TimeColsSlats","tableMinWidth","clientWidth","minHeight","componentDidMount","updateSizing","componentDidUpdate","componentWillUnmount","onCoords","rootEl","offsetHeight","collectSlatEls","currentMap","elMap","splitSegsByCol","segs","segsByCol","col","splitInteractionByCol","ui","byRow","affectedInstances","isEvent","_i","seg","TimeColMoreLink","allDayDate","moreCnt","hiddenSegs","allSegs","alignmentElRef","renderMoreLinkInner","extraDateSpan","todayRange","popoverContent","renderPlainFgSegs","handleClick","title","isExpanded","popoverId","el","bottom","onClick","shortText","buildPositioning","segInputs","strictOrder","maxStackCnt","hierarchy","hiddenEntries","addSegs","hiddenGroups","web","buildWeb","stretchWeb","segRects","webToRects","entriesByLevel","buildNode","cacheable","lateral","siblingRange","findNextLevelSegs","nextLevelRes","buildNodes","entry","nextLevelNodes","thickness","lateralStart","lateralEnd","pairs","sort","cmpDescPressures","extractNode","a","b","subjectLevel","subjectLateral","levelCoords","subjectEntry","afterSubject","levelCnt","entries","searchIndex","topLevelNodes","totalThickness","stretchNode","node","startCoord","prevThickness","allThickness","thicknessFraction","endCoord","newChildren","nextLevelNodes_1","childNode","res","newThickness","rects","processNode","levelCoord","stackDepth","rect","stackForward","processNodes","nodes","nodes_1","keyFunc","workFunc","cache","args","computeSegVCoords","colDate","eventMinHeight","vcoords","spanStart","spanEnd","round","computeFgSegPlacements","segVCoords","eventOrderStrict","eventMaxStack","dumbSegs","index","segPlacements","segRects_1","segRect","_b","dumbSegs_1","dumbSeg","DEFAULT_TIME_FORMAT","TimeColEvent","isShort","defaultTimeFormat","extraClassNames","TimeColMisc","extraHookProps","TimeCol","isSelectMirror","selectMirror","mirrorSegs","eventDrag","eventResize","dateSelectionSegs","interactionAffectedInstances","sortedFgSegs","fgEventSegs","eventOrder","dataAttrs","extraDataAttrs","renderFillSegs","businessHourSegs","bgEventSegs","renderFgSegs","renderNowIndicator","nowIndicatorSegs","segIsInvisible","isDragging","isResizing","isDateSelecting","renderPositionedFgSegs","eventShortHeight","eventSelection","isMirror","_c","renderHiddenGroups","segPlacement","instanceId","eventRange","instance","isVisible","vStyle","computeSegVStyle","hStyle","computeSegHStyle","left","right","isInset","visibility","isSelected","hiddenGroup","positionCss","compileSegsFromEntries","fillType","children","segHCoords","isRtl","shouldOverlap","slotEventOverlap","nearCoord","farCoord","zIndex","hiddenInstances","segEntries","segEntry","TimeColsContent","splitFgEventSegs","splitBgEventSegs","splitBusinessHourSegs","splitNowIndicatorSegs","splitDateSelectionSegs","splitEventDrag","splitEventResize","cellElRefs","cells","fgEventSegsByRow","bgEventSegsByRow","businessHourSegsByRow","nowIndicatorSegsByRow","dateSelectionSegsByRow","eventDragByRow","eventResizeByRow","cell","updateCoords","onColCoords","collectCellEls","TimeCols","processSlotOptions","handleRootEl","registerInteractiveComponent","isHitComboAllowed","unregisterInteractiveComponent","handleScrollRequest","request","onScrollTopRequest","top_1","ceil","handleColCoords","colCoords","onSlatCoords","scrollResponder","createScrollResponder","prevProps","update","detach","queryHit","positionLeft","positionTop","snapDuration","snapsPerSlot","colIndex","leftToIndex","topToIndex","slatTop","slatHeight","partial","localSnapIndex","snapIndex","dayDate","add","dayEl","lefts","rights","layer","snapDurationOverride","DayTimeColsSlicer","sliceRange","dayRanges","segRange","isStart","isEnd","DayTimeCols","buildDayRanges","slicer","timeColsRef","dayTableModel","sliceProps","sliceNowDate","ranges","headerDates","STOCK_SUB_DURATIONS","hours","minutes","seconds","buildSlatMetas","explicitLabelInterval","dayStart","Date","slatTime","slatIterator","labelInterval","computeLabelInterval","metas","toISOString","slotsPerLabel","DayTimeColsView","buildTimeColsModel","dateProfileGenerator","splitProps","slotLabelInterval","hasAttachedAxis","hasDetachedAxis","headerContent","dayHeaders","dates","datesRepDistinctDays","renderIntro","allDaySlot","nextDayThreshold","colGroupNode","renderRowIntro","showWeekNumbers","headerAlignElRef","timeGridContent","daySeries","OPTION_REFINERS","main","initialView","optionRefiners","views","timeGrid","component","usesMinMaxTime","timeGridDay","days","timeGridWeek","weeks"],"sources":["C:/Users/Udenar/Desktop/backend-main/frontend/node_modules/@fullcalendar/timegrid/main.js"],"sourcesContent":["/*!\nFullCalendar v5.11.3\nDocs & License: https://fullcalendar.io/\n(c) 2022 Adam Shaw\n*/\nimport './main.css';\n\nimport { hasBgRendering, Splitter, createFormatter, createElement, ViewContextType, RenderHook, BaseComponent, createRef, diffDays, buildNavLinkAttrs, WeekNumberRoot, getStickyHeaderDates, ViewRoot, SimpleScrollGrid, getStickyFooterScrollbar, NowTimer, NowIndicatorRoot, renderScrollShim, DateComponent, rangeContainsMarker, startOfDay, asRoughMs, createDuration, RefMap, PositionCache, MoreLinkRoot, setRef, SegHierarchy, groupIntersectingEntries, buildEntryKey, binarySearch, getEntrySpanEnd, StandardEvent, DayCellContent, Fragment, getSegMeta, memoize, sortEventSegs, DayCellRoot, buildIsoString, computeEarliestSegStart, buildEventRangeKey, BgEvent, renderFill, addDurations, multiplyDuration, wholeDivideDurations, intersectRanges, Slicer, formatIsoTimeString, DayHeader, DaySeriesModel, DayTableModel, createPlugin } from '@fullcalendar/common';\nimport { __extends, __assign } from 'tslib';\nimport { DayTable } from '@fullcalendar/daygrid';\n\nvar AllDaySplitter = /** @class */ (function (_super) {\n    __extends(AllDaySplitter, _super);\n    function AllDaySplitter() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AllDaySplitter.prototype.getKeyInfo = function () {\n        return {\n            allDay: {},\n            timed: {},\n        };\n    };\n    AllDaySplitter.prototype.getKeysForDateSpan = function (dateSpan) {\n        if (dateSpan.allDay) {\n            return ['allDay'];\n        }\n        return ['timed'];\n    };\n    AllDaySplitter.prototype.getKeysForEventDef = function (eventDef) {\n        if (!eventDef.allDay) {\n            return ['timed'];\n        }\n        if (hasBgRendering(eventDef)) {\n            return ['timed', 'allDay'];\n        }\n        return ['allDay'];\n    };\n    return AllDaySplitter;\n}(Splitter));\n\nvar DEFAULT_SLAT_LABEL_FORMAT = createFormatter({\n    hour: 'numeric',\n    minute: '2-digit',\n    omitZeroMinute: true,\n    meridiem: 'short',\n});\nfunction TimeColsAxisCell(props) {\n    var classNames = [\n        'fc-timegrid-slot',\n        'fc-timegrid-slot-label',\n        props.isLabeled ? 'fc-scrollgrid-shrink' : 'fc-timegrid-slot-minor',\n    ];\n    return (createElement(ViewContextType.Consumer, null, function (context) {\n        if (!props.isLabeled) {\n            return (createElement(\"td\", { className: classNames.join(' '), \"data-time\": props.isoTimeStr }));\n        }\n        var dateEnv = context.dateEnv, options = context.options, viewApi = context.viewApi;\n        var labelFormat = // TODO: fully pre-parse\n         options.slotLabelFormat == null ? DEFAULT_SLAT_LABEL_FORMAT :\n            Array.isArray(options.slotLabelFormat) ? createFormatter(options.slotLabelFormat[0]) :\n                createFormatter(options.slotLabelFormat);\n        var hookProps = {\n            level: 0,\n            time: props.time,\n            date: dateEnv.toDate(props.date),\n            view: viewApi,\n            text: dateEnv.format(props.date, labelFormat),\n        };\n        return (createElement(RenderHook, { hookProps: hookProps, classNames: options.slotLabelClassNames, content: options.slotLabelContent, defaultContent: renderInnerContent, didMount: options.slotLabelDidMount, willUnmount: options.slotLabelWillUnmount }, function (rootElRef, customClassNames, innerElRef, innerContent) { return (createElement(\"td\", { ref: rootElRef, className: classNames.concat(customClassNames).join(' '), \"data-time\": props.isoTimeStr },\n            createElement(\"div\", { className: \"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame\" },\n                createElement(\"div\", { className: \"fc-timegrid-slot-label-cushion fc-scrollgrid-shrink-cushion\", ref: innerElRef }, innerContent)))); }));\n    }));\n}\nfunction renderInnerContent(props) {\n    return props.text;\n}\n\nvar TimeBodyAxis = /** @class */ (function (_super) {\n    __extends(TimeBodyAxis, _super);\n    function TimeBodyAxis() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimeBodyAxis.prototype.render = function () {\n        return this.props.slatMetas.map(function (slatMeta) { return (createElement(\"tr\", { key: slatMeta.key },\n            createElement(TimeColsAxisCell, __assign({}, slatMeta)))); });\n    };\n    return TimeBodyAxis;\n}(BaseComponent));\n\nvar DEFAULT_WEEK_NUM_FORMAT = createFormatter({ week: 'short' });\nvar AUTO_ALL_DAY_MAX_EVENT_ROWS = 5;\nvar TimeColsView = /** @class */ (function (_super) {\n    __extends(TimeColsView, _super);\n    function TimeColsView() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.allDaySplitter = new AllDaySplitter(); // for use by subclasses\n        _this.headerElRef = createRef();\n        _this.rootElRef = createRef();\n        _this.scrollerElRef = createRef();\n        _this.state = {\n            slatCoords: null,\n        };\n        _this.handleScrollTopRequest = function (scrollTop) {\n            var scrollerEl = _this.scrollerElRef.current;\n            if (scrollerEl) { // TODO: not sure how this could ever be null. weirdness with the reducer\n                scrollerEl.scrollTop = scrollTop;\n            }\n        };\n        /* Header Render Methods\n        ------------------------------------------------------------------------------------------------------------------*/\n        _this.renderHeadAxis = function (rowKey, frameHeight) {\n            if (frameHeight === void 0) { frameHeight = ''; }\n            var options = _this.context.options;\n            var dateProfile = _this.props.dateProfile;\n            var range = dateProfile.renderRange;\n            var dayCnt = diffDays(range.start, range.end);\n            var navLinkAttrs = (dayCnt === 1) // only do in day views (to avoid doing in week views that dont need it)\n                ? buildNavLinkAttrs(_this.context, range.start, 'week')\n                : {};\n            if (options.weekNumbers && rowKey === 'day') {\n                return (createElement(WeekNumberRoot, { date: range.start, defaultFormat: DEFAULT_WEEK_NUM_FORMAT }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"th\", { ref: rootElRef, \"aria-hidden\": true, className: [\n                        'fc-timegrid-axis',\n                        'fc-scrollgrid-shrink',\n                    ].concat(classNames).join(' ') },\n                    createElement(\"div\", { className: \"fc-timegrid-axis-frame fc-scrollgrid-shrink-frame fc-timegrid-axis-frame-liquid\", style: { height: frameHeight } },\n                        createElement(\"a\", __assign({ ref: innerElRef, className: \"fc-timegrid-axis-cushion fc-scrollgrid-shrink-cushion fc-scrollgrid-sync-inner\" }, navLinkAttrs), innerContent)))); }));\n            }\n            return (createElement(\"th\", { \"aria-hidden\": true, className: \"fc-timegrid-axis\" },\n                createElement(\"div\", { className: \"fc-timegrid-axis-frame\", style: { height: frameHeight } })));\n        };\n        /* Table Component Render Methods\n        ------------------------------------------------------------------------------------------------------------------*/\n        // only a one-way height sync. we don't send the axis inner-content height to the DayGrid,\n        // but DayGrid still needs to have classNames on inner elements in order to measure.\n        _this.renderTableRowAxis = function (rowHeight) {\n            var _a = _this.context, options = _a.options, viewApi = _a.viewApi;\n            var hookProps = {\n                text: options.allDayText,\n                view: viewApi,\n            };\n            return (\n            // TODO: make reusable hook. used in list view too\n            createElement(RenderHook, { hookProps: hookProps, classNames: options.allDayClassNames, content: options.allDayContent, defaultContent: renderAllDayInner, didMount: options.allDayDidMount, willUnmount: options.allDayWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"td\", { ref: rootElRef, \"aria-hidden\": true, className: [\n                    'fc-timegrid-axis',\n                    'fc-scrollgrid-shrink',\n                ].concat(classNames).join(' ') },\n                createElement(\"div\", { className: 'fc-timegrid-axis-frame fc-scrollgrid-shrink-frame' + (rowHeight == null ? ' fc-timegrid-axis-frame-liquid' : ''), style: { height: rowHeight } },\n                    createElement(\"span\", { className: \"fc-timegrid-axis-cushion fc-scrollgrid-shrink-cushion fc-scrollgrid-sync-inner\", ref: innerElRef }, innerContent)))); }));\n        };\n        _this.handleSlatCoords = function (slatCoords) {\n            _this.setState({ slatCoords: slatCoords });\n        };\n        return _this;\n    }\n    // rendering\n    // ----------------------------------------------------------------------------------------------------\n    TimeColsView.prototype.renderSimpleLayout = function (headerRowContent, allDayContent, timeContent) {\n        var _a = this, context = _a.context, props = _a.props;\n        var sections = [];\n        var stickyHeaderDates = getStickyHeaderDates(context.options);\n        if (headerRowContent) {\n            sections.push({\n                type: 'header',\n                key: 'header',\n                isSticky: stickyHeaderDates,\n                chunk: {\n                    elRef: this.headerElRef,\n                    tableClassName: 'fc-col-header',\n                    rowContent: headerRowContent,\n                },\n            });\n        }\n        if (allDayContent) {\n            sections.push({\n                type: 'body',\n                key: 'all-day',\n                chunk: { content: allDayContent },\n            });\n            sections.push({\n                type: 'body',\n                key: 'all-day-divider',\n                outerContent: ( // TODO: rename to cellContent so don't need to define <tr>?\n                createElement(\"tr\", { role: \"presentation\", className: \"fc-scrollgrid-section\" },\n                    createElement(\"td\", { className: 'fc-timegrid-divider ' + context.theme.getClass('tableCellShaded') }))),\n            });\n        }\n        sections.push({\n            type: 'body',\n            key: 'body',\n            liquid: true,\n            expandRows: Boolean(context.options.expandRows),\n            chunk: {\n                scrollerElRef: this.scrollerElRef,\n                content: timeContent,\n            },\n        });\n        return (createElement(ViewRoot, { viewSpec: context.viewSpec, elRef: this.rootElRef }, function (rootElRef, classNames) { return (createElement(\"div\", { className: ['fc-timegrid'].concat(classNames).join(' '), ref: rootElRef },\n            createElement(SimpleScrollGrid, { liquid: !props.isHeightAuto && !props.forPrint, collapsibleWidth: props.forPrint, cols: [{ width: 'shrink' }], sections: sections }))); }));\n    };\n    TimeColsView.prototype.renderHScrollLayout = function (headerRowContent, allDayContent, timeContent, colCnt, dayMinWidth, slatMetas, slatCoords) {\n        var _this = this;\n        var ScrollGrid = this.context.pluginHooks.scrollGridImpl;\n        if (!ScrollGrid) {\n            throw new Error('No ScrollGrid implementation');\n        }\n        var _a = this, context = _a.context, props = _a.props;\n        var stickyHeaderDates = !props.forPrint && getStickyHeaderDates(context.options);\n        var stickyFooterScrollbar = !props.forPrint && getStickyFooterScrollbar(context.options);\n        var sections = [];\n        if (headerRowContent) {\n            sections.push({\n                type: 'header',\n                key: 'header',\n                isSticky: stickyHeaderDates,\n                syncRowHeights: true,\n                chunks: [\n                    {\n                        key: 'axis',\n                        rowContent: function (arg) { return (createElement(\"tr\", { role: \"presentation\" }, _this.renderHeadAxis('day', arg.rowSyncHeights[0]))); },\n                    },\n                    {\n                        key: 'cols',\n                        elRef: this.headerElRef,\n                        tableClassName: 'fc-col-header',\n                        rowContent: headerRowContent,\n                    },\n                ],\n            });\n        }\n        if (allDayContent) {\n            sections.push({\n                type: 'body',\n                key: 'all-day',\n                syncRowHeights: true,\n                chunks: [\n                    {\n                        key: 'axis',\n                        rowContent: function (contentArg) { return (createElement(\"tr\", { role: \"presentation\" }, _this.renderTableRowAxis(contentArg.rowSyncHeights[0]))); },\n                    },\n                    {\n                        key: 'cols',\n                        content: allDayContent,\n                    },\n                ],\n            });\n            sections.push({\n                key: 'all-day-divider',\n                type: 'body',\n                outerContent: ( // TODO: rename to cellContent so don't need to define <tr>?\n                createElement(\"tr\", { role: \"presentation\", className: \"fc-scrollgrid-section\" },\n                    createElement(\"td\", { colSpan: 2, className: 'fc-timegrid-divider ' + context.theme.getClass('tableCellShaded') }))),\n            });\n        }\n        var isNowIndicator = context.options.nowIndicator;\n        sections.push({\n            type: 'body',\n            key: 'body',\n            liquid: true,\n            expandRows: Boolean(context.options.expandRows),\n            chunks: [\n                {\n                    key: 'axis',\n                    content: function (arg) { return (\n                    // TODO: make this now-indicator arrow more DRY with TimeColsContent\n                    createElement(\"div\", { className: \"fc-timegrid-axis-chunk\" },\n                        createElement(\"table\", { \"aria-hidden\": true, style: { height: arg.expandRows ? arg.clientHeight : '' } },\n                            arg.tableColGroupNode,\n                            createElement(\"tbody\", null,\n                                createElement(TimeBodyAxis, { slatMetas: slatMetas }))),\n                        createElement(\"div\", { className: \"fc-timegrid-now-indicator-container\" },\n                            createElement(NowTimer, { unit: isNowIndicator ? 'minute' : 'day' /* hacky */ }, function (nowDate) {\n                                var nowIndicatorTop = isNowIndicator &&\n                                    slatCoords &&\n                                    slatCoords.safeComputeTop(nowDate); // might return void\n                                if (typeof nowIndicatorTop === 'number') {\n                                    return (createElement(NowIndicatorRoot, { isAxis: true, date: nowDate }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-timegrid-now-indicator-arrow'].concat(classNames).join(' '), style: { top: nowIndicatorTop } }, innerContent)); }));\n                                }\n                                return null;\n                            })))); },\n                },\n                {\n                    key: 'cols',\n                    scrollerElRef: this.scrollerElRef,\n                    content: timeContent,\n                },\n            ],\n        });\n        if (stickyFooterScrollbar) {\n            sections.push({\n                key: 'footer',\n                type: 'footer',\n                isSticky: true,\n                chunks: [\n                    {\n                        key: 'axis',\n                        content: renderScrollShim,\n                    },\n                    {\n                        key: 'cols',\n                        content: renderScrollShim,\n                    },\n                ],\n            });\n        }\n        return (createElement(ViewRoot, { viewSpec: context.viewSpec, elRef: this.rootElRef }, function (rootElRef, classNames) { return (createElement(\"div\", { className: ['fc-timegrid'].concat(classNames).join(' '), ref: rootElRef },\n            createElement(ScrollGrid, { liquid: !props.isHeightAuto && !props.forPrint, collapsibleWidth: false, colGroups: [\n                    { width: 'shrink', cols: [{ width: 'shrink' }] },\n                    { cols: [{ span: colCnt, minWidth: dayMinWidth }] },\n                ], sections: sections }))); }));\n    };\n    /* Dimensions\n    ------------------------------------------------------------------------------------------------------------------*/\n    TimeColsView.prototype.getAllDayMaxEventProps = function () {\n        var _a = this.context.options, dayMaxEvents = _a.dayMaxEvents, dayMaxEventRows = _a.dayMaxEventRows;\n        if (dayMaxEvents === true || dayMaxEventRows === true) { // is auto?\n            dayMaxEvents = undefined;\n            dayMaxEventRows = AUTO_ALL_DAY_MAX_EVENT_ROWS; // make sure \"auto\" goes to a real number\n        }\n        return { dayMaxEvents: dayMaxEvents, dayMaxEventRows: dayMaxEventRows };\n    };\n    return TimeColsView;\n}(DateComponent));\nfunction renderAllDayInner(hookProps) {\n    return hookProps.text;\n}\n\nvar TimeColsSlatsCoords = /** @class */ (function () {\n    function TimeColsSlatsCoords(positions, dateProfile, slotDuration) {\n        this.positions = positions;\n        this.dateProfile = dateProfile;\n        this.slotDuration = slotDuration;\n    }\n    TimeColsSlatsCoords.prototype.safeComputeTop = function (date) {\n        var dateProfile = this.dateProfile;\n        if (rangeContainsMarker(dateProfile.currentRange, date)) {\n            var startOfDayDate = startOfDay(date);\n            var timeMs = date.valueOf() - startOfDayDate.valueOf();\n            if (timeMs >= asRoughMs(dateProfile.slotMinTime) &&\n                timeMs < asRoughMs(dateProfile.slotMaxTime)) {\n                return this.computeTimeTop(createDuration(timeMs));\n            }\n        }\n        return null;\n    };\n    // Computes the top coordinate, relative to the bounds of the grid, of the given date.\n    // A `startOfDayDate` must be given for avoiding ambiguity over how to treat midnight.\n    TimeColsSlatsCoords.prototype.computeDateTop = function (when, startOfDayDate) {\n        if (!startOfDayDate) {\n            startOfDayDate = startOfDay(when);\n        }\n        return this.computeTimeTop(createDuration(when.valueOf() - startOfDayDate.valueOf()));\n    };\n    // Computes the top coordinate, relative to the bounds of the grid, of the given time (a Duration).\n    // This is a makeshify way to compute the time-top. Assumes all slatMetas dates are uniform.\n    // Eventually allow computation with arbirary slat dates.\n    TimeColsSlatsCoords.prototype.computeTimeTop = function (duration) {\n        var _a = this, positions = _a.positions, dateProfile = _a.dateProfile;\n        var len = positions.els.length;\n        // floating-point value of # of slots covered\n        var slatCoverage = (duration.milliseconds - asRoughMs(dateProfile.slotMinTime)) / asRoughMs(this.slotDuration);\n        var slatIndex;\n        var slatRemainder;\n        // compute a floating-point number for how many slats should be progressed through.\n        // from 0 to number of slats (inclusive)\n        // constrained because slotMinTime/slotMaxTime might be customized.\n        slatCoverage = Math.max(0, slatCoverage);\n        slatCoverage = Math.min(len, slatCoverage);\n        // an integer index of the furthest whole slat\n        // from 0 to number slats (*exclusive*, so len-1)\n        slatIndex = Math.floor(slatCoverage);\n        slatIndex = Math.min(slatIndex, len - 1);\n        // how much further through the slatIndex slat (from 0.0-1.0) must be covered in addition.\n        // could be 1.0 if slatCoverage is covering *all* the slots\n        slatRemainder = slatCoverage - slatIndex;\n        return positions.tops[slatIndex] +\n            positions.getHeight(slatIndex) * slatRemainder;\n    };\n    return TimeColsSlatsCoords;\n}());\n\nvar TimeColsSlatsBody = /** @class */ (function (_super) {\n    __extends(TimeColsSlatsBody, _super);\n    function TimeColsSlatsBody() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimeColsSlatsBody.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        var options = context.options;\n        var slatElRefs = props.slatElRefs;\n        return (createElement(\"tbody\", null, props.slatMetas.map(function (slatMeta, i) {\n            var hookProps = {\n                time: slatMeta.time,\n                date: context.dateEnv.toDate(slatMeta.date),\n                view: context.viewApi,\n            };\n            var classNames = [\n                'fc-timegrid-slot',\n                'fc-timegrid-slot-lane',\n                slatMeta.isLabeled ? '' : 'fc-timegrid-slot-minor',\n            ];\n            return (createElement(\"tr\", { key: slatMeta.key, ref: slatElRefs.createRef(slatMeta.key) },\n                props.axis && (createElement(TimeColsAxisCell, __assign({}, slatMeta))),\n                createElement(RenderHook, { hookProps: hookProps, classNames: options.slotLaneClassNames, content: options.slotLaneContent, didMount: options.slotLaneDidMount, willUnmount: options.slotLaneWillUnmount }, function (rootElRef, customClassNames, innerElRef, innerContent) { return (createElement(\"td\", { ref: rootElRef, className: classNames.concat(customClassNames).join(' '), \"data-time\": slatMeta.isoTimeStr }, innerContent)); })));\n        })));\n    };\n    return TimeColsSlatsBody;\n}(BaseComponent));\n\n/*\nfor the horizontal \"slats\" that run width-wise. Has a time axis on a side. Depends on RTL.\n*/\nvar TimeColsSlats = /** @class */ (function (_super) {\n    __extends(TimeColsSlats, _super);\n    function TimeColsSlats() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        _this.slatElRefs = new RefMap();\n        return _this;\n    }\n    TimeColsSlats.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        return (createElement(\"div\", { ref: this.rootElRef, className: \"fc-timegrid-slots\" },\n            createElement(\"table\", { \"aria-hidden\": true, className: context.theme.getClass('table'), style: {\n                    minWidth: props.tableMinWidth,\n                    width: props.clientWidth,\n                    height: props.minHeight,\n                } },\n                props.tableColGroupNode /* relies on there only being a single <col> for the axis */,\n                createElement(TimeColsSlatsBody, { slatElRefs: this.slatElRefs, axis: props.axis, slatMetas: props.slatMetas }))));\n    };\n    TimeColsSlats.prototype.componentDidMount = function () {\n        this.updateSizing();\n    };\n    TimeColsSlats.prototype.componentDidUpdate = function () {\n        this.updateSizing();\n    };\n    TimeColsSlats.prototype.componentWillUnmount = function () {\n        if (this.props.onCoords) {\n            this.props.onCoords(null);\n        }\n    };\n    TimeColsSlats.prototype.updateSizing = function () {\n        var _a = this, context = _a.context, props = _a.props;\n        if (props.onCoords &&\n            props.clientWidth !== null // means sizing has stabilized\n        ) {\n            var rootEl = this.rootElRef.current;\n            if (rootEl.offsetHeight) { // not hidden by css\n                props.onCoords(new TimeColsSlatsCoords(new PositionCache(this.rootElRef.current, collectSlatEls(this.slatElRefs.currentMap, props.slatMetas), false, true), this.props.dateProfile, context.options.slotDuration));\n            }\n        }\n    };\n    return TimeColsSlats;\n}(BaseComponent));\nfunction collectSlatEls(elMap, slatMetas) {\n    return slatMetas.map(function (slatMeta) { return elMap[slatMeta.key]; });\n}\n\nfunction splitSegsByCol(segs, colCnt) {\n    var segsByCol = [];\n    var i;\n    for (i = 0; i < colCnt; i += 1) {\n        segsByCol.push([]);\n    }\n    if (segs) {\n        for (i = 0; i < segs.length; i += 1) {\n            segsByCol[segs[i].col].push(segs[i]);\n        }\n    }\n    return segsByCol;\n}\nfunction splitInteractionByCol(ui, colCnt) {\n    var byRow = [];\n    if (!ui) {\n        for (var i = 0; i < colCnt; i += 1) {\n            byRow[i] = null;\n        }\n    }\n    else {\n        for (var i = 0; i < colCnt; i += 1) {\n            byRow[i] = {\n                affectedInstances: ui.affectedInstances,\n                isEvent: ui.isEvent,\n                segs: [],\n            };\n        }\n        for (var _i = 0, _a = ui.segs; _i < _a.length; _i++) {\n            var seg = _a[_i];\n            byRow[seg.col].segs.push(seg);\n        }\n    }\n    return byRow;\n}\n\nvar TimeColMoreLink = /** @class */ (function (_super) {\n    __extends(TimeColMoreLink, _super);\n    function TimeColMoreLink() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        return _this;\n    }\n    TimeColMoreLink.prototype.render = function () {\n        var _this = this;\n        var props = this.props;\n        return (createElement(MoreLinkRoot, { allDayDate: null, moreCnt: props.hiddenSegs.length, allSegs: props.hiddenSegs, hiddenSegs: props.hiddenSegs, alignmentElRef: this.rootElRef, defaultContent: renderMoreLinkInner, extraDateSpan: props.extraDateSpan, dateProfile: props.dateProfile, todayRange: props.todayRange, popoverContent: function () { return renderPlainFgSegs(props.hiddenSegs, props); } }, function (rootElRef, classNames, innerElRef, innerContent, handleClick, title, isExpanded, popoverId) { return (createElement(\"a\", { ref: function (el) {\n                setRef(rootElRef, el);\n                setRef(_this.rootElRef, el);\n            }, className: ['fc-timegrid-more-link'].concat(classNames).join(' '), style: { top: props.top, bottom: props.bottom }, onClick: handleClick, title: title, \"aria-expanded\": isExpanded, \"aria-controls\": popoverId },\n            createElement(\"div\", { ref: innerElRef, className: \"fc-timegrid-more-link-inner fc-sticky\" }, innerContent))); }));\n    };\n    return TimeColMoreLink;\n}(BaseComponent));\nfunction renderMoreLinkInner(props) {\n    return props.shortText;\n}\n\n// segInputs assumed sorted\nfunction buildPositioning(segInputs, strictOrder, maxStackCnt) {\n    var hierarchy = new SegHierarchy();\n    if (strictOrder != null) {\n        hierarchy.strictOrder = strictOrder;\n    }\n    if (maxStackCnt != null) {\n        hierarchy.maxStackCnt = maxStackCnt;\n    }\n    var hiddenEntries = hierarchy.addSegs(segInputs);\n    var hiddenGroups = groupIntersectingEntries(hiddenEntries);\n    var web = buildWeb(hierarchy);\n    web = stretchWeb(web, 1); // all levelCoords/thickness will have 0.0-1.0\n    var segRects = webToRects(web);\n    return { segRects: segRects, hiddenGroups: hiddenGroups };\n}\nfunction buildWeb(hierarchy) {\n    var entriesByLevel = hierarchy.entriesByLevel;\n    var buildNode = cacheable(function (level, lateral) { return level + ':' + lateral; }, function (level, lateral) {\n        var siblingRange = findNextLevelSegs(hierarchy, level, lateral);\n        var nextLevelRes = buildNodes(siblingRange, buildNode);\n        var entry = entriesByLevel[level][lateral];\n        return [\n            __assign(__assign({}, entry), { nextLevelNodes: nextLevelRes[0] }),\n            entry.thickness + nextLevelRes[1], // the pressure builds\n        ];\n    });\n    return buildNodes(entriesByLevel.length\n        ? { level: 0, lateralStart: 0, lateralEnd: entriesByLevel[0].length }\n        : null, buildNode)[0];\n}\nfunction buildNodes(siblingRange, buildNode) {\n    if (!siblingRange) {\n        return [[], 0];\n    }\n    var level = siblingRange.level, lateralStart = siblingRange.lateralStart, lateralEnd = siblingRange.lateralEnd;\n    var lateral = lateralStart;\n    var pairs = [];\n    while (lateral < lateralEnd) {\n        pairs.push(buildNode(level, lateral));\n        lateral += 1;\n    }\n    pairs.sort(cmpDescPressures);\n    return [\n        pairs.map(extractNode),\n        pairs[0][1], // first item's pressure\n    ];\n}\nfunction cmpDescPressures(a, b) {\n    return b[1] - a[1];\n}\nfunction extractNode(a) {\n    return a[0];\n}\nfunction findNextLevelSegs(hierarchy, subjectLevel, subjectLateral) {\n    var levelCoords = hierarchy.levelCoords, entriesByLevel = hierarchy.entriesByLevel;\n    var subjectEntry = entriesByLevel[subjectLevel][subjectLateral];\n    var afterSubject = levelCoords[subjectLevel] + subjectEntry.thickness;\n    var levelCnt = levelCoords.length;\n    var level = subjectLevel;\n    // skip past levels that are too high up\n    for (; level < levelCnt && levelCoords[level] < afterSubject; level += 1)\n        ; // do nothing\n    for (; level < levelCnt; level += 1) {\n        var entries = entriesByLevel[level];\n        var entry = void 0;\n        var searchIndex = binarySearch(entries, subjectEntry.span.start, getEntrySpanEnd);\n        var lateralStart = searchIndex[0] + searchIndex[1]; // if exact match (which doesn't collide), go to next one\n        var lateralEnd = lateralStart;\n        while ( // loop through entries that horizontally intersect\n        (entry = entries[lateralEnd]) && // but not past the whole seg list\n            entry.span.start < subjectEntry.span.end) {\n            lateralEnd += 1;\n        }\n        if (lateralStart < lateralEnd) {\n            return { level: level, lateralStart: lateralStart, lateralEnd: lateralEnd };\n        }\n    }\n    return null;\n}\nfunction stretchWeb(topLevelNodes, totalThickness) {\n    var stretchNode = cacheable(function (node, startCoord, prevThickness) { return buildEntryKey(node); }, function (node, startCoord, prevThickness) {\n        var nextLevelNodes = node.nextLevelNodes, thickness = node.thickness;\n        var allThickness = thickness + prevThickness;\n        var thicknessFraction = thickness / allThickness;\n        var endCoord;\n        var newChildren = [];\n        if (!nextLevelNodes.length) {\n            endCoord = totalThickness;\n        }\n        else {\n            for (var _i = 0, nextLevelNodes_1 = nextLevelNodes; _i < nextLevelNodes_1.length; _i++) {\n                var childNode = nextLevelNodes_1[_i];\n                if (endCoord === undefined) {\n                    var res = stretchNode(childNode, startCoord, allThickness);\n                    endCoord = res[0];\n                    newChildren.push(res[1]);\n                }\n                else {\n                    var res = stretchNode(childNode, endCoord, 0);\n                    newChildren.push(res[1]);\n                }\n            }\n        }\n        var newThickness = (endCoord - startCoord) * thicknessFraction;\n        return [endCoord - newThickness, __assign(__assign({}, node), { thickness: newThickness, nextLevelNodes: newChildren })];\n    });\n    return topLevelNodes.map(function (node) { return stretchNode(node, 0, 0)[1]; });\n}\n// not sorted in any particular order\nfunction webToRects(topLevelNodes) {\n    var rects = [];\n    var processNode = cacheable(function (node, levelCoord, stackDepth) { return buildEntryKey(node); }, function (node, levelCoord, stackDepth) {\n        var rect = __assign(__assign({}, node), { levelCoord: levelCoord,\n            stackDepth: stackDepth, stackForward: 0 });\n        rects.push(rect);\n        return (rect.stackForward = processNodes(node.nextLevelNodes, levelCoord + node.thickness, stackDepth + 1) + 1);\n    });\n    function processNodes(nodes, levelCoord, stackDepth) {\n        var stackForward = 0;\n        for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n            var node = nodes_1[_i];\n            stackForward = Math.max(processNode(node, levelCoord, stackDepth), stackForward);\n        }\n        return stackForward;\n    }\n    processNodes(topLevelNodes, 0, 0);\n    return rects; // TODO: sort rects by levelCoord to be consistent with toRects?\n}\n// TODO: move to general util\nfunction cacheable(keyFunc, workFunc) {\n    var cache = {};\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var key = keyFunc.apply(void 0, args);\n        return (key in cache)\n            ? cache[key]\n            : (cache[key] = workFunc.apply(void 0, args));\n    };\n}\n\nfunction computeSegVCoords(segs, colDate, slatCoords, eventMinHeight) {\n    if (slatCoords === void 0) { slatCoords = null; }\n    if (eventMinHeight === void 0) { eventMinHeight = 0; }\n    var vcoords = [];\n    if (slatCoords) {\n        for (var i = 0; i < segs.length; i += 1) {\n            var seg = segs[i];\n            var spanStart = slatCoords.computeDateTop(seg.start, colDate);\n            var spanEnd = Math.max(spanStart + (eventMinHeight || 0), // :(\n            slatCoords.computeDateTop(seg.end, colDate));\n            vcoords.push({\n                start: Math.round(spanStart),\n                end: Math.round(spanEnd), //\n            });\n        }\n    }\n    return vcoords;\n}\nfunction computeFgSegPlacements(segs, segVCoords, // might not have for every seg\neventOrderStrict, eventMaxStack) {\n    var segInputs = [];\n    var dumbSegs = []; // segs without coords\n    for (var i = 0; i < segs.length; i += 1) {\n        var vcoords = segVCoords[i];\n        if (vcoords) {\n            segInputs.push({\n                index: i,\n                thickness: 1,\n                span: vcoords,\n            });\n        }\n        else {\n            dumbSegs.push(segs[i]);\n        }\n    }\n    var _a = buildPositioning(segInputs, eventOrderStrict, eventMaxStack), segRects = _a.segRects, hiddenGroups = _a.hiddenGroups;\n    var segPlacements = [];\n    for (var _i = 0, segRects_1 = segRects; _i < segRects_1.length; _i++) {\n        var segRect = segRects_1[_i];\n        segPlacements.push({\n            seg: segs[segRect.index],\n            rect: segRect,\n        });\n    }\n    for (var _b = 0, dumbSegs_1 = dumbSegs; _b < dumbSegs_1.length; _b++) {\n        var dumbSeg = dumbSegs_1[_b];\n        segPlacements.push({ seg: dumbSeg, rect: null });\n    }\n    return { segPlacements: segPlacements, hiddenGroups: hiddenGroups };\n}\n\nvar DEFAULT_TIME_FORMAT = createFormatter({\n    hour: 'numeric',\n    minute: '2-digit',\n    meridiem: false,\n});\nvar TimeColEvent = /** @class */ (function (_super) {\n    __extends(TimeColEvent, _super);\n    function TimeColEvent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimeColEvent.prototype.render = function () {\n        var classNames = [\n            'fc-timegrid-event',\n            'fc-v-event',\n        ];\n        if (this.props.isShort) {\n            classNames.push('fc-timegrid-event-short');\n        }\n        return (createElement(StandardEvent, __assign({}, this.props, { defaultTimeFormat: DEFAULT_TIME_FORMAT, extraClassNames: classNames })));\n    };\n    return TimeColEvent;\n}(BaseComponent));\n\nvar TimeColMisc = /** @class */ (function (_super) {\n    __extends(TimeColMisc, _super);\n    function TimeColMisc() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimeColMisc.prototype.render = function () {\n        var props = this.props;\n        return (createElement(DayCellContent, { date: props.date, dateProfile: props.dateProfile, todayRange: props.todayRange, extraHookProps: props.extraHookProps }, function (innerElRef, innerContent) { return (innerContent &&\n            createElement(\"div\", { className: \"fc-timegrid-col-misc\", ref: innerElRef }, innerContent)); }));\n    };\n    return TimeColMisc;\n}(BaseComponent));\n\nvar TimeCol = /** @class */ (function (_super) {\n    __extends(TimeCol, _super);\n    function TimeCol() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.sortEventSegs = memoize(sortEventSegs);\n        return _this;\n    }\n    // TODO: memoize event-placement?\n    TimeCol.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var isSelectMirror = context.options.selectMirror;\n        var mirrorSegs = (props.eventDrag && props.eventDrag.segs) ||\n            (props.eventResize && props.eventResize.segs) ||\n            (isSelectMirror && props.dateSelectionSegs) ||\n            [];\n        var interactionAffectedInstances = // TODO: messy way to compute this\n         (props.eventDrag && props.eventDrag.affectedInstances) ||\n            (props.eventResize && props.eventResize.affectedInstances) ||\n            {};\n        var sortedFgSegs = this.sortEventSegs(props.fgEventSegs, context.options.eventOrder);\n        return (createElement(DayCellRoot, { elRef: props.elRef, date: props.date, dateProfile: props.dateProfile, todayRange: props.todayRange, extraHookProps: props.extraHookProps }, function (rootElRef, classNames, dataAttrs) { return (createElement(\"td\", __assign({ ref: rootElRef, role: \"gridcell\", className: ['fc-timegrid-col'].concat(classNames, props.extraClassNames || []).join(' ') }, dataAttrs, props.extraDataAttrs),\n            createElement(\"div\", { className: \"fc-timegrid-col-frame\" },\n                createElement(\"div\", { className: \"fc-timegrid-col-bg\" },\n                    _this.renderFillSegs(props.businessHourSegs, 'non-business'),\n                    _this.renderFillSegs(props.bgEventSegs, 'bg-event'),\n                    _this.renderFillSegs(props.dateSelectionSegs, 'highlight')),\n                createElement(\"div\", { className: \"fc-timegrid-col-events\" }, _this.renderFgSegs(sortedFgSegs, interactionAffectedInstances, false, false, false)),\n                createElement(\"div\", { className: \"fc-timegrid-col-events\" }, _this.renderFgSegs(mirrorSegs, {}, Boolean(props.eventDrag), Boolean(props.eventResize), Boolean(isSelectMirror))),\n                createElement(\"div\", { className: \"fc-timegrid-now-indicator-container\" }, _this.renderNowIndicator(props.nowIndicatorSegs)),\n                createElement(TimeColMisc, { date: props.date, dateProfile: props.dateProfile, todayRange: props.todayRange, extraHookProps: props.extraHookProps })))); }));\n    };\n    TimeCol.prototype.renderFgSegs = function (sortedFgSegs, segIsInvisible, isDragging, isResizing, isDateSelecting) {\n        var props = this.props;\n        if (props.forPrint) {\n            return renderPlainFgSegs(sortedFgSegs, props);\n        }\n        return this.renderPositionedFgSegs(sortedFgSegs, segIsInvisible, isDragging, isResizing, isDateSelecting);\n    };\n    TimeCol.prototype.renderPositionedFgSegs = function (segs, // if not mirror, needs to be sorted\n    segIsInvisible, isDragging, isResizing, isDateSelecting) {\n        var _this = this;\n        var _a = this.context.options, eventMaxStack = _a.eventMaxStack, eventShortHeight = _a.eventShortHeight, eventOrderStrict = _a.eventOrderStrict, eventMinHeight = _a.eventMinHeight;\n        var _b = this.props, date = _b.date, slatCoords = _b.slatCoords, eventSelection = _b.eventSelection, todayRange = _b.todayRange, nowDate = _b.nowDate;\n        var isMirror = isDragging || isResizing || isDateSelecting;\n        var segVCoords = computeSegVCoords(segs, date, slatCoords, eventMinHeight);\n        var _c = computeFgSegPlacements(segs, segVCoords, eventOrderStrict, eventMaxStack), segPlacements = _c.segPlacements, hiddenGroups = _c.hiddenGroups;\n        return (createElement(Fragment, null,\n            this.renderHiddenGroups(hiddenGroups, segs),\n            segPlacements.map(function (segPlacement) {\n                var seg = segPlacement.seg, rect = segPlacement.rect;\n                var instanceId = seg.eventRange.instance.instanceId;\n                var isVisible = isMirror || Boolean(!segIsInvisible[instanceId] && rect);\n                var vStyle = computeSegVStyle(rect && rect.span);\n                var hStyle = (!isMirror && rect) ? _this.computeSegHStyle(rect) : { left: 0, right: 0 };\n                var isInset = Boolean(rect) && rect.stackForward > 0;\n                var isShort = Boolean(rect) && (rect.span.end - rect.span.start) < eventShortHeight; // look at other places for this problem\n                return (createElement(\"div\", { className: 'fc-timegrid-event-harness' +\n                        (isInset ? ' fc-timegrid-event-harness-inset' : ''), key: instanceId, style: __assign(__assign({ visibility: isVisible ? '' : 'hidden' }, vStyle), hStyle) },\n                    createElement(TimeColEvent, __assign({ seg: seg, isDragging: isDragging, isResizing: isResizing, isDateSelecting: isDateSelecting, isSelected: instanceId === eventSelection, isShort: isShort }, getSegMeta(seg, todayRange, nowDate)))));\n            })));\n    };\n    // will already have eventMinHeight applied because segInputs already had it\n    TimeCol.prototype.renderHiddenGroups = function (hiddenGroups, segs) {\n        var _a = this.props, extraDateSpan = _a.extraDateSpan, dateProfile = _a.dateProfile, todayRange = _a.todayRange, nowDate = _a.nowDate, eventSelection = _a.eventSelection, eventDrag = _a.eventDrag, eventResize = _a.eventResize;\n        return (createElement(Fragment, null, hiddenGroups.map(function (hiddenGroup) {\n            var positionCss = computeSegVStyle(hiddenGroup.span);\n            var hiddenSegs = compileSegsFromEntries(hiddenGroup.entries, segs);\n            return (createElement(TimeColMoreLink, { key: buildIsoString(computeEarliestSegStart(hiddenSegs)), hiddenSegs: hiddenSegs, top: positionCss.top, bottom: positionCss.bottom, extraDateSpan: extraDateSpan, dateProfile: dateProfile, todayRange: todayRange, nowDate: nowDate, eventSelection: eventSelection, eventDrag: eventDrag, eventResize: eventResize }));\n        })));\n    };\n    TimeCol.prototype.renderFillSegs = function (segs, fillType) {\n        var _a = this, props = _a.props, context = _a.context;\n        var segVCoords = computeSegVCoords(segs, props.date, props.slatCoords, context.options.eventMinHeight); // don't assume all populated\n        var children = segVCoords.map(function (vcoords, i) {\n            var seg = segs[i];\n            return (createElement(\"div\", { key: buildEventRangeKey(seg.eventRange), className: \"fc-timegrid-bg-harness\", style: computeSegVStyle(vcoords) }, fillType === 'bg-event' ?\n                createElement(BgEvent, __assign({ seg: seg }, getSegMeta(seg, props.todayRange, props.nowDate))) :\n                renderFill(fillType)));\n        });\n        return createElement(Fragment, null, children);\n    };\n    TimeCol.prototype.renderNowIndicator = function (segs) {\n        var _a = this.props, slatCoords = _a.slatCoords, date = _a.date;\n        if (!slatCoords) {\n            return null;\n        }\n        return segs.map(function (seg, i) { return (createElement(NowIndicatorRoot, { isAxis: false, date: date, \n            // key doesn't matter. will only ever be one\n            key: i }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-timegrid-now-indicator-line'].concat(classNames).join(' '), style: { top: slatCoords.computeDateTop(seg.start, date) } }, innerContent)); })); });\n    };\n    TimeCol.prototype.computeSegHStyle = function (segHCoords) {\n        var _a = this.context, isRtl = _a.isRtl, options = _a.options;\n        var shouldOverlap = options.slotEventOverlap;\n        var nearCoord = segHCoords.levelCoord; // the left side if LTR. the right side if RTL. floating-point\n        var farCoord = segHCoords.levelCoord + segHCoords.thickness; // the right side if LTR. the left side if RTL. floating-point\n        var left; // amount of space from left edge, a fraction of the total width\n        var right; // amount of space from right edge, a fraction of the total width\n        if (shouldOverlap) {\n            // double the width, but don't go beyond the maximum forward coordinate (1.0)\n            farCoord = Math.min(1, nearCoord + (farCoord - nearCoord) * 2);\n        }\n        if (isRtl) {\n            left = 1 - farCoord;\n            right = nearCoord;\n        }\n        else {\n            left = nearCoord;\n            right = 1 - farCoord;\n        }\n        var props = {\n            zIndex: segHCoords.stackDepth + 1,\n            left: left * 100 + '%',\n            right: right * 100 + '%',\n        };\n        if (shouldOverlap && !segHCoords.stackForward) {\n            // add padding to the edge so that forward stacked events don't cover the resizer's icon\n            props[isRtl ? 'marginLeft' : 'marginRight'] = 10 * 2; // 10 is a guesstimate of the icon's width\n        }\n        return props;\n    };\n    return TimeCol;\n}(BaseComponent));\nfunction renderPlainFgSegs(sortedFgSegs, _a) {\n    var todayRange = _a.todayRange, nowDate = _a.nowDate, eventSelection = _a.eventSelection, eventDrag = _a.eventDrag, eventResize = _a.eventResize;\n    var hiddenInstances = (eventDrag ? eventDrag.affectedInstances : null) ||\n        (eventResize ? eventResize.affectedInstances : null) ||\n        {};\n    return (createElement(Fragment, null, sortedFgSegs.map(function (seg) {\n        var instanceId = seg.eventRange.instance.instanceId;\n        return (createElement(\"div\", { key: instanceId, style: { visibility: hiddenInstances[instanceId] ? 'hidden' : '' } },\n            createElement(TimeColEvent, __assign({ seg: seg, isDragging: false, isResizing: false, isDateSelecting: false, isSelected: instanceId === eventSelection, isShort: false }, getSegMeta(seg, todayRange, nowDate)))));\n    })));\n}\nfunction computeSegVStyle(segVCoords) {\n    if (!segVCoords) {\n        return { top: '', bottom: '' };\n    }\n    return {\n        top: segVCoords.start,\n        bottom: -segVCoords.end,\n    };\n}\nfunction compileSegsFromEntries(segEntries, allSegs) {\n    return segEntries.map(function (segEntry) { return allSegs[segEntry.index]; });\n}\n\nvar TimeColsContent = /** @class */ (function (_super) {\n    __extends(TimeColsContent, _super);\n    function TimeColsContent() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.splitFgEventSegs = memoize(splitSegsByCol);\n        _this.splitBgEventSegs = memoize(splitSegsByCol);\n        _this.splitBusinessHourSegs = memoize(splitSegsByCol);\n        _this.splitNowIndicatorSegs = memoize(splitSegsByCol);\n        _this.splitDateSelectionSegs = memoize(splitSegsByCol);\n        _this.splitEventDrag = memoize(splitInteractionByCol);\n        _this.splitEventResize = memoize(splitInteractionByCol);\n        _this.rootElRef = createRef();\n        _this.cellElRefs = new RefMap();\n        return _this;\n    }\n    TimeColsContent.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var nowIndicatorTop = context.options.nowIndicator &&\n            props.slatCoords &&\n            props.slatCoords.safeComputeTop(props.nowDate); // might return void\n        var colCnt = props.cells.length;\n        var fgEventSegsByRow = this.splitFgEventSegs(props.fgEventSegs, colCnt);\n        var bgEventSegsByRow = this.splitBgEventSegs(props.bgEventSegs, colCnt);\n        var businessHourSegsByRow = this.splitBusinessHourSegs(props.businessHourSegs, colCnt);\n        var nowIndicatorSegsByRow = this.splitNowIndicatorSegs(props.nowIndicatorSegs, colCnt);\n        var dateSelectionSegsByRow = this.splitDateSelectionSegs(props.dateSelectionSegs, colCnt);\n        var eventDragByRow = this.splitEventDrag(props.eventDrag, colCnt);\n        var eventResizeByRow = this.splitEventResize(props.eventResize, colCnt);\n        return (createElement(\"div\", { className: \"fc-timegrid-cols\", ref: this.rootElRef },\n            createElement(\"table\", { role: \"presentation\", style: {\n                    minWidth: props.tableMinWidth,\n                    width: props.clientWidth,\n                } },\n                props.tableColGroupNode,\n                createElement(\"tbody\", { role: \"presentation\" },\n                    createElement(\"tr\", { role: \"row\" },\n                        props.axis && (createElement(\"td\", { \"aria-hidden\": true, className: \"fc-timegrid-col fc-timegrid-axis\" },\n                            createElement(\"div\", { className: \"fc-timegrid-col-frame\" },\n                                createElement(\"div\", { className: \"fc-timegrid-now-indicator-container\" }, typeof nowIndicatorTop === 'number' && (createElement(NowIndicatorRoot, { isAxis: true, date: props.nowDate }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-timegrid-now-indicator-arrow'].concat(classNames).join(' '), style: { top: nowIndicatorTop } }, innerContent)); })))))),\n                        props.cells.map(function (cell, i) { return (createElement(TimeCol, { key: cell.key, elRef: _this.cellElRefs.createRef(cell.key), dateProfile: props.dateProfile, date: cell.date, nowDate: props.nowDate, todayRange: props.todayRange, extraHookProps: cell.extraHookProps, extraDataAttrs: cell.extraDataAttrs, extraClassNames: cell.extraClassNames, extraDateSpan: cell.extraDateSpan, fgEventSegs: fgEventSegsByRow[i], bgEventSegs: bgEventSegsByRow[i], businessHourSegs: businessHourSegsByRow[i], nowIndicatorSegs: nowIndicatorSegsByRow[i], dateSelectionSegs: dateSelectionSegsByRow[i], eventDrag: eventDragByRow[i], eventResize: eventResizeByRow[i], slatCoords: props.slatCoords, eventSelection: props.eventSelection, forPrint: props.forPrint })); }))))));\n    };\n    TimeColsContent.prototype.componentDidMount = function () {\n        this.updateCoords();\n    };\n    TimeColsContent.prototype.componentDidUpdate = function () {\n        this.updateCoords();\n    };\n    TimeColsContent.prototype.updateCoords = function () {\n        var props = this.props;\n        if (props.onColCoords &&\n            props.clientWidth !== null // means sizing has stabilized\n        ) {\n            props.onColCoords(new PositionCache(this.rootElRef.current, collectCellEls(this.cellElRefs.currentMap, props.cells), true, // horizontal\n            false));\n        }\n    };\n    return TimeColsContent;\n}(BaseComponent));\nfunction collectCellEls(elMap, cells) {\n    return cells.map(function (cell) { return elMap[cell.key]; });\n}\n\n/* A component that renders one or more columns of vertical time slots\n----------------------------------------------------------------------------------------------------------------------*/\nvar TimeCols = /** @class */ (function (_super) {\n    __extends(TimeCols, _super);\n    function TimeCols() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.processSlotOptions = memoize(processSlotOptions);\n        _this.state = {\n            slatCoords: null,\n        };\n        _this.handleRootEl = function (el) {\n            if (el) {\n                _this.context.registerInteractiveComponent(_this, {\n                    el: el,\n                    isHitComboAllowed: _this.props.isHitComboAllowed,\n                });\n            }\n            else {\n                _this.context.unregisterInteractiveComponent(_this);\n            }\n        };\n        _this.handleScrollRequest = function (request) {\n            var onScrollTopRequest = _this.props.onScrollTopRequest;\n            var slatCoords = _this.state.slatCoords;\n            if (onScrollTopRequest && slatCoords) {\n                if (request.time) {\n                    var top_1 = slatCoords.computeTimeTop(request.time);\n                    top_1 = Math.ceil(top_1); // zoom can give weird floating-point values. rather scroll a little bit further\n                    if (top_1) {\n                        top_1 += 1; // to overcome top border that slots beyond the first have. looks better\n                    }\n                    onScrollTopRequest(top_1);\n                }\n                return true;\n            }\n            return false;\n        };\n        _this.handleColCoords = function (colCoords) {\n            _this.colCoords = colCoords;\n        };\n        _this.handleSlatCoords = function (slatCoords) {\n            _this.setState({ slatCoords: slatCoords });\n            if (_this.props.onSlatCoords) {\n                _this.props.onSlatCoords(slatCoords);\n            }\n        };\n        return _this;\n    }\n    TimeCols.prototype.render = function () {\n        var _a = this, props = _a.props, state = _a.state;\n        return (createElement(\"div\", { className: \"fc-timegrid-body\", ref: this.handleRootEl, style: {\n                // these props are important to give this wrapper correct dimensions for interactions\n                // TODO: if we set it here, can we avoid giving to inner tables?\n                width: props.clientWidth,\n                minWidth: props.tableMinWidth,\n            } },\n            createElement(TimeColsSlats, { axis: props.axis, dateProfile: props.dateProfile, slatMetas: props.slatMetas, clientWidth: props.clientWidth, minHeight: props.expandRows ? props.clientHeight : '', tableMinWidth: props.tableMinWidth, tableColGroupNode: props.axis ? props.tableColGroupNode : null /* axis depends on the colgroup's shrinking */, onCoords: this.handleSlatCoords }),\n            createElement(TimeColsContent, { cells: props.cells, axis: props.axis, dateProfile: props.dateProfile, businessHourSegs: props.businessHourSegs, bgEventSegs: props.bgEventSegs, fgEventSegs: props.fgEventSegs, dateSelectionSegs: props.dateSelectionSegs, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, todayRange: props.todayRange, nowDate: props.nowDate, nowIndicatorSegs: props.nowIndicatorSegs, clientWidth: props.clientWidth, tableMinWidth: props.tableMinWidth, tableColGroupNode: props.tableColGroupNode, slatCoords: state.slatCoords, onColCoords: this.handleColCoords, forPrint: props.forPrint })));\n    };\n    TimeCols.prototype.componentDidMount = function () {\n        this.scrollResponder = this.context.createScrollResponder(this.handleScrollRequest);\n    };\n    TimeCols.prototype.componentDidUpdate = function (prevProps) {\n        this.scrollResponder.update(prevProps.dateProfile !== this.props.dateProfile);\n    };\n    TimeCols.prototype.componentWillUnmount = function () {\n        this.scrollResponder.detach();\n    };\n    TimeCols.prototype.queryHit = function (positionLeft, positionTop) {\n        var _a = this.context, dateEnv = _a.dateEnv, options = _a.options;\n        var colCoords = this.colCoords;\n        var dateProfile = this.props.dateProfile;\n        var slatCoords = this.state.slatCoords;\n        var _b = this.processSlotOptions(this.props.slotDuration, options.snapDuration), snapDuration = _b.snapDuration, snapsPerSlot = _b.snapsPerSlot;\n        var colIndex = colCoords.leftToIndex(positionLeft);\n        var slatIndex = slatCoords.positions.topToIndex(positionTop);\n        if (colIndex != null && slatIndex != null) {\n            var cell = this.props.cells[colIndex];\n            var slatTop = slatCoords.positions.tops[slatIndex];\n            var slatHeight = slatCoords.positions.getHeight(slatIndex);\n            var partial = (positionTop - slatTop) / slatHeight; // floating point number between 0 and 1\n            var localSnapIndex = Math.floor(partial * snapsPerSlot); // the snap # relative to start of slat\n            var snapIndex = slatIndex * snapsPerSlot + localSnapIndex;\n            var dayDate = this.props.cells[colIndex].date;\n            var time = addDurations(dateProfile.slotMinTime, multiplyDuration(snapDuration, snapIndex));\n            var start = dateEnv.add(dayDate, time);\n            var end = dateEnv.add(start, snapDuration);\n            return {\n                dateProfile: dateProfile,\n                dateSpan: __assign({ range: { start: start, end: end }, allDay: false }, cell.extraDateSpan),\n                dayEl: colCoords.els[colIndex],\n                rect: {\n                    left: colCoords.lefts[colIndex],\n                    right: colCoords.rights[colIndex],\n                    top: slatTop,\n                    bottom: slatTop + slatHeight,\n                },\n                layer: 0,\n            };\n        }\n        return null;\n    };\n    return TimeCols;\n}(DateComponent));\nfunction processSlotOptions(slotDuration, snapDurationOverride) {\n    var snapDuration = snapDurationOverride || slotDuration;\n    var snapsPerSlot = wholeDivideDurations(slotDuration, snapDuration);\n    if (snapsPerSlot === null) {\n        snapDuration = slotDuration;\n        snapsPerSlot = 1;\n        // TODO: say warning?\n    }\n    return { snapDuration: snapDuration, snapsPerSlot: snapsPerSlot };\n}\n\nvar DayTimeColsSlicer = /** @class */ (function (_super) {\n    __extends(DayTimeColsSlicer, _super);\n    function DayTimeColsSlicer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DayTimeColsSlicer.prototype.sliceRange = function (range, dayRanges) {\n        var segs = [];\n        for (var col = 0; col < dayRanges.length; col += 1) {\n            var segRange = intersectRanges(range, dayRanges[col]);\n            if (segRange) {\n                segs.push({\n                    start: segRange.start,\n                    end: segRange.end,\n                    isStart: segRange.start.valueOf() === range.start.valueOf(),\n                    isEnd: segRange.end.valueOf() === range.end.valueOf(),\n                    col: col,\n                });\n            }\n        }\n        return segs;\n    };\n    return DayTimeColsSlicer;\n}(Slicer));\n\nvar DayTimeCols = /** @class */ (function (_super) {\n    __extends(DayTimeCols, _super);\n    function DayTimeCols() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.buildDayRanges = memoize(buildDayRanges);\n        _this.slicer = new DayTimeColsSlicer();\n        _this.timeColsRef = createRef();\n        return _this;\n    }\n    DayTimeCols.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var dateProfile = props.dateProfile, dayTableModel = props.dayTableModel;\n        var isNowIndicator = context.options.nowIndicator;\n        var dayRanges = this.buildDayRanges(dayTableModel, dateProfile, context.dateEnv);\n        // give it the first row of cells\n        // TODO: would move this further down hierarchy, but sliceNowDate needs it\n        return (createElement(NowTimer, { unit: isNowIndicator ? 'minute' : 'day' }, function (nowDate, todayRange) { return (createElement(TimeCols, __assign({ ref: _this.timeColsRef }, _this.slicer.sliceProps(props, dateProfile, null, context, dayRanges), { forPrint: props.forPrint, axis: props.axis, dateProfile: dateProfile, slatMetas: props.slatMetas, slotDuration: props.slotDuration, cells: dayTableModel.cells[0], tableColGroupNode: props.tableColGroupNode, tableMinWidth: props.tableMinWidth, clientWidth: props.clientWidth, clientHeight: props.clientHeight, expandRows: props.expandRows, nowDate: nowDate, nowIndicatorSegs: isNowIndicator && _this.slicer.sliceNowDate(nowDate, context, dayRanges), todayRange: todayRange, onScrollTopRequest: props.onScrollTopRequest, onSlatCoords: props.onSlatCoords }))); }));\n    };\n    return DayTimeCols;\n}(DateComponent));\nfunction buildDayRanges(dayTableModel, dateProfile, dateEnv) {\n    var ranges = [];\n    for (var _i = 0, _a = dayTableModel.headerDates; _i < _a.length; _i++) {\n        var date = _a[_i];\n        ranges.push({\n            start: dateEnv.add(date, dateProfile.slotMinTime),\n            end: dateEnv.add(date, dateProfile.slotMaxTime),\n        });\n    }\n    return ranges;\n}\n\n// potential nice values for the slot-duration and interval-duration\n// from largest to smallest\nvar STOCK_SUB_DURATIONS = [\n    { hours: 1 },\n    { minutes: 30 },\n    { minutes: 15 },\n    { seconds: 30 },\n    { seconds: 15 },\n];\nfunction buildSlatMetas(slotMinTime, slotMaxTime, explicitLabelInterval, slotDuration, dateEnv) {\n    var dayStart = new Date(0);\n    var slatTime = slotMinTime;\n    var slatIterator = createDuration(0);\n    var labelInterval = explicitLabelInterval || computeLabelInterval(slotDuration);\n    var metas = [];\n    while (asRoughMs(slatTime) < asRoughMs(slotMaxTime)) {\n        var date = dateEnv.add(dayStart, slatTime);\n        var isLabeled = wholeDivideDurations(slatIterator, labelInterval) !== null;\n        metas.push({\n            date: date,\n            time: slatTime,\n            key: date.toISOString(),\n            isoTimeStr: formatIsoTimeString(date),\n            isLabeled: isLabeled,\n        });\n        slatTime = addDurations(slatTime, slotDuration);\n        slatIterator = addDurations(slatIterator, slotDuration);\n    }\n    return metas;\n}\n// Computes an automatic value for slotLabelInterval\nfunction computeLabelInterval(slotDuration) {\n    var i;\n    var labelInterval;\n    var slotsPerLabel;\n    // find the smallest stock label interval that results in more than one slots-per-label\n    for (i = STOCK_SUB_DURATIONS.length - 1; i >= 0; i -= 1) {\n        labelInterval = createDuration(STOCK_SUB_DURATIONS[i]);\n        slotsPerLabel = wholeDivideDurations(labelInterval, slotDuration);\n        if (slotsPerLabel !== null && slotsPerLabel > 1) {\n            return labelInterval;\n        }\n    }\n    return slotDuration; // fall back\n}\n\nvar DayTimeColsView = /** @class */ (function (_super) {\n    __extends(DayTimeColsView, _super);\n    function DayTimeColsView() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.buildTimeColsModel = memoize(buildTimeColsModel);\n        _this.buildSlatMetas = memoize(buildSlatMetas);\n        return _this;\n    }\n    DayTimeColsView.prototype.render = function () {\n        var _this = this;\n        var _a = this.context, options = _a.options, dateEnv = _a.dateEnv, dateProfileGenerator = _a.dateProfileGenerator;\n        var props = this.props;\n        var dateProfile = props.dateProfile;\n        var dayTableModel = this.buildTimeColsModel(dateProfile, dateProfileGenerator);\n        var splitProps = this.allDaySplitter.splitProps(props);\n        var slatMetas = this.buildSlatMetas(dateProfile.slotMinTime, dateProfile.slotMaxTime, options.slotLabelInterval, options.slotDuration, dateEnv);\n        var dayMinWidth = options.dayMinWidth;\n        var hasAttachedAxis = !dayMinWidth;\n        var hasDetachedAxis = dayMinWidth;\n        var headerContent = options.dayHeaders && (createElement(DayHeader, { dates: dayTableModel.headerDates, dateProfile: dateProfile, datesRepDistinctDays: true, renderIntro: hasAttachedAxis ? this.renderHeadAxis : null }));\n        var allDayContent = (options.allDaySlot !== false) && (function (contentArg) { return (createElement(DayTable, __assign({}, splitProps.allDay, { dateProfile: dateProfile, dayTableModel: dayTableModel, nextDayThreshold: options.nextDayThreshold, tableMinWidth: contentArg.tableMinWidth, colGroupNode: contentArg.tableColGroupNode, renderRowIntro: hasAttachedAxis ? _this.renderTableRowAxis : null, showWeekNumbers: false, expandRows: false, headerAlignElRef: _this.headerElRef, clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, forPrint: props.forPrint }, _this.getAllDayMaxEventProps()))); });\n        var timeGridContent = function (contentArg) { return (createElement(DayTimeCols, __assign({}, splitProps.timed, { dayTableModel: dayTableModel, dateProfile: dateProfile, axis: hasAttachedAxis, slotDuration: options.slotDuration, slatMetas: slatMetas, forPrint: props.forPrint, tableColGroupNode: contentArg.tableColGroupNode, tableMinWidth: contentArg.tableMinWidth, clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, onSlatCoords: _this.handleSlatCoords, expandRows: contentArg.expandRows, onScrollTopRequest: _this.handleScrollTopRequest }))); };\n        return hasDetachedAxis\n            ? this.renderHScrollLayout(headerContent, allDayContent, timeGridContent, dayTableModel.colCnt, dayMinWidth, slatMetas, this.state.slatCoords)\n            : this.renderSimpleLayout(headerContent, allDayContent, timeGridContent);\n    };\n    return DayTimeColsView;\n}(TimeColsView));\nfunction buildTimeColsModel(dateProfile, dateProfileGenerator) {\n    var daySeries = new DaySeriesModel(dateProfile.renderRange, dateProfileGenerator);\n    return new DayTableModel(daySeries, false);\n}\n\nvar OPTION_REFINERS = {\n    allDaySlot: Boolean,\n};\n\nvar main = createPlugin({\n    initialView: 'timeGridWeek',\n    optionRefiners: OPTION_REFINERS,\n    views: {\n        timeGrid: {\n            component: DayTimeColsView,\n            usesMinMaxTime: true,\n            allDaySlot: true,\n            slotDuration: '00:30:00',\n            slotEventOverlap: true, // a bad name. confused with overlap/constraint system\n        },\n        timeGridDay: {\n            type: 'timeGrid',\n            duration: { days: 1 },\n        },\n        timeGridWeek: {\n            type: 'timeGrid',\n            duration: { weeks: 1 },\n        },\n    },\n});\n\nexport default main;\nexport { DayTimeCols, DayTimeColsSlicer, DayTimeColsView, TimeCols, TimeColsSlatsCoords, TimeColsView, buildDayRanges, buildSlatMetas, buildTimeColsModel };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}