{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Acer/OneDrive/Documentos/Angular/backend/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { compareAsc, format, parseISO, startOfToday } from \"date-fns\";\nlet ReservasuserComponent = class ReservasuserComponent {\n  constructor(authservice, intmserver, ususer, reserserv) {\n    this.authservice = authservice;\n    this.intmserver = intmserver;\n    this.ususer = ususer;\n    this.reserserv = reserserv; // ------------------------------------------------- Date fns ---------------------------------------------------- //\n    // llegaInicio = document.getElementById(\"from\").value;\n\n    this.today = format(startOfToday(), 'yyyy-MM-dd'); // -------------------------------------------------------------------------------------------------------- //\n    // -------------------------------------------------- Calendar Options ---------------------------------------------- //\n\n    this.calendarOptions = {\n      initialView: 'dayGridMonth',\n      dateClick: this.handleDateClick.bind(this),\n      hiddenDays: [0]\n    };\n    this.espacios = [{\n      name: \"Auditorio\",\n      value: 1\n    }, {\n      name: \"Sala de VideoConferencias 1\",\n      value: 2\n    }, {\n      name: \"Sala de VideoConferencias 2\",\n      value: 3\n    }];\n    this.opcionSeleccionado = '0';\n    this.verSeleccion = ''; // ------------------------------------------------------------------------------------------------------------- //\n    //------------------------------------------Envio de Reserva---------------------------------------------------- //\n\n    this.reserv = {\n      fini: '',\n      fend: '',\n      namevent: '',\n      user: this.ususer.getuser(),\n      sitio: 'Sala de VideoConferencias 1',\n      state: '',\n      anexo: ''\n    };\n    this.FileSelected = false;\n  }\n\n  onHora(e) {\n    this.start = this.today + \" \" + e.target.value;\n  }\n\n  onHora1(e) {\n    this.end = this.today + \" \" + e.target.value;\n  }\n\n  handleDateClick(arg) {\n    this.convert = parseISO(arg.dateStr);\n    this.convert2 = startOfToday();\n\n    if (compareAsc(this.convert, this.convert2) === 1 || compareAsc(this.convert, this.convert2) === 0) {\n      this.today = arg.dateStr;\n    } else {\n      alert(\"Fecha Incorrecta, No se puede agendar para fechas pasadas\");\n    }\n  }\n\n  capturar() {\n    // Pasamos el valor seleccionado a la variable verSeleccion\n    if (this.verSeleccion != '') {\n      this.verSeleccion = this.opcionSeleccionado;\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  ngOnInit() {\n    this.FileSelected = false;\n  }\n\n  selectFile($e) {\n    this.FileSelected = true;\n\n    if (this.FileSelected) {\n      console.log(\"seleccionado\");\n    }\n\n    const [file] = $e.target.files;\n    this.filetmp = {\n      fileraw: file,\n      filename: file.name\n    };\n  }\n\n  Request() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.intmserver.esUser()) {\n        _this.reserv.sitio = _this.opcionSeleccionado;\n        _this.reserv.fini = _this.start;\n        _this.reserv.fend = _this.end;\n        _this.reserv.user = _this.ususer.getuser();\n        _this.reserv.state = 'solicitado';\n        yield (yield _this.reserserv.solReserva(_this.reserv)).subscribe( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (res) {\n            console.log(res);\n\n            if (_this.FileSelected) {\n              const body = new FormData();\n              body.append('file', _this.filetmp.fileraw, _this.filetmp.filename);\n              body.append('res', res._id);\n              (yield _this.reserserv.saveFile(body)).subscribe(res => console.log(res));\n            } else {\n              console.log(\"sin file\");\n            }\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      }\n    })();\n  }\n\n};\nReservasuserComponent = __decorate([Component({\n  selector: 'app-reservasuser',\n  templateUrl: './reservasuser.component.html',\n  styleUrls: ['./reservasuser.component.css']\n})], ReservasuserComponent);\nexport { ReservasuserComponent };","map":{"version":3,"mappings":"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","names":["Component","compareAsc","format","parseISO","startOfToday","ReservasuserComponent","constructor","authservice","intmserver","ususer","reserserv","initialView","dateClick","handleDateClick","bind","hiddenDays","name","value","fini","fend","namevent","user","getuser","sitio","state","anexo","onHora","e","start","today","target","onHora1","end","arg","convert","dateStr","convert2","alert","capturar","verSeleccion","opcionSeleccionado","ngOnInit","FileSelected","selectFile","$e","console","log","file","files","filetmp","fileraw","filename","Request","esUser","reserv","solReserva","subscribe","res","body","FormData","append","_id","saveFile","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\Acer\\OneDrive\\Documentos\\Angular\\backend\\frontend\\src\\app\\components\\reservasuser\\reservasuser.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { CalendarOptions } from '@fullcalendar/angular';\nimport { compareAsc, compareDesc, format, parse, parseISO, startOfToday } from \"date-fns\";\nimport { AuthService } from 'src/app/services/auth.service';\nimport { IntermediumService } from 'src/app/services/intermedium.service';\nimport { UserService } from 'src/app/services/user.service';\nimport { ReservasAdminService } from 'src/app/services/reservas-admin.service';\nimport { Observable } from 'rxjs';\n\n\n@Component({\n  selector: 'app-reservasuser',\n  templateUrl: './reservasuser.component.html',\n  styleUrls: ['./reservasuser.component.css']\n})\nexport class ReservasuserComponent implements OnInit{\n\n// ------------------------------------------------- Date fns ---------------------------------------------------- //\n\n// llegaInicio = document.getElementById(\"from\").value;\n\n\ntoday = format(startOfToday(), 'yyyy-MM-dd');\nstart: any;\nend: any;\nconvert: any;\nconvert2: any;\n\nonHora(e: any){\n  this.start = this.today+\" \"+e.target.value\n}\n\nonHora1(e: any){\n  this.end = this.today+\" \"+e.target.value\n}\n\n\n// -------------------------------------------------------------------------------------------------------- //\n\n\n// -------------------------------------------------- Calendar Options ---------------------------------------------- //\n  calendarOptions: CalendarOptions = {\n    initialView: 'dayGridMonth', // bind is important!\n    dateClick: this.handleDateClick.bind(this),\n    \n    hiddenDays: [0]\n\n  };\n\n  handleDateClick(arg: any) {\n    this.convert = parseISO(arg.dateStr)\n    this.convert2 = startOfToday()\n    if(compareAsc(this.convert, this.convert2) === 1 || compareAsc(this.convert, this.convert2) === 0 ){\n      this.today = arg.dateStr\n    }else{ alert(\"Fecha Incorrecta, No se puede agendar para fechas pasadas\")}\n    \n  };\n\n  espacios: any = [\n    {name: \"Auditorio\", value: 1},{name: \"Sala de VideoConferencias 1\", value: 2}, {name: \"Sala de VideoConferencias 2\", value: 3}\n  ];\n \n\n  opcionSeleccionado: any  = '0';\n  verSeleccion: any        = '';\n\n  capturar() {\n    // Pasamos el valor seleccionado a la variable verSeleccion\n    if (this.verSeleccion!='') {\n      this.verSeleccion = this.opcionSeleccionado;\n      return true\n    }else{\n      return false\n    }\n  };\n\n// ------------------------------------------------------------------------------------------------------------- //\n\n//------------------------------------------Envio de Reserva---------------------------------------------------- //\n\n  reserv={\n    fini:'',\n    fend:'',   \n    namevent:'',\n    user:this.ususer.getuser(),\n    sitio:'Sala de VideoConferencias 1',\n    state:'',\n    anexo:''\n  }\n\n  filetmp:any\n  FileSelected:boolean=false\n\n  constructor(public authservice:AuthService,\n    public intmserver:IntermediumService,\n    public ususer:UserService,\n    public reserserv:ReservasAdminService\n  ) {}\n\n  ngOnInit(): void {\n    this.FileSelected=false\n  }\n\n  selectFile($e: any): void {\n    this.FileSelected=true\n    if (this.FileSelected) {\n      console.log(\"seleccionado\");\n    }\n    const [file] = $e.target.files\n    this.filetmp={\n      fileraw:file,\n      filename:file.name\n    }\n  }\n\n  async Request(){\n    if(this.intmserver.esUser()){\n      this.reserv.sitio=this.opcionSeleccionado\n      this.reserv.fini=this.start\n      this.reserv.fend=this.end\n      this.reserv.user=this.ususer.getuser()\n      this.reserv.state='solicitado'\n      await (await this.reserserv.solReserva(this.reserv)).subscribe(async(res)=>{\n        console.log(res);\n        if (this.FileSelected) {\n          const body=new FormData()\n          body.append('file',this.filetmp.fileraw, this.filetmp.filename);\n          body.append('res',res._id);\n          (await this.reserserv.saveFile(body)).subscribe(res=>console.log(res))\n        }else{\n          console.log(\"sin file\");\n        }\n      })\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}