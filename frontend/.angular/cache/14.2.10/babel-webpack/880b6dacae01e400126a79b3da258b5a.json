{"ast":null,"code":"/*!\nFullCalendar v5.11.3\nDocs & License: https://fullcalendar.io/\n(c) 2022 Adam Shaw\n*/\nimport './main.css';\nimport { createRef, getStickyHeaderDates, createElement, ViewRoot, SimpleScrollGrid, getStickyFooterScrollbar, renderScrollShim, DateComponent, buildNavLinkAttrs, DayCellContent, Fragment, BaseComponent, createFormatter, StandardEvent, buildSegTimeText, EventRoot, getSegAnchorAttrs, memoize, MoreLinkRoot, getSegMeta, createAriaClickAttrs, getUniqueDomId, setRef, DayCellRoot, WeekNumberRoot, buildEntryKey, intersectSpans, SegHierarchy, intersectRanges, addDays, RefMap, sortEventSegs, isPropsEqual, buildEventRangeKey, BgEvent, renderFill, PositionCache, NowTimer, Slicer, DayHeader, DaySeriesModel, DayTableModel, addWeeks, diffWeeks, DateProfileGenerator, createPlugin } from '@fullcalendar/common';\nimport { __extends, __assign, __spreadArray } from 'tslib';\n/* An abstract class for the daygrid views, as well as month view. Renders one or more rows of day cells.\n----------------------------------------------------------------------------------------------------------------------*/\n// It is a manager for a Table subcomponent, which does most of the heavy lifting.\n// It is responsible for managing width/height.\n\nvar TableView =\n/** @class */\nfunction (_super) {\n  __extends(TableView, _super);\n\n  function TableView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.headerElRef = createRef();\n    return _this;\n  }\n\n  TableView.prototype.renderSimpleLayout = function (headerRowContent, bodyContent) {\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var sections = [];\n    var stickyHeaderDates = getStickyHeaderDates(context.options);\n\n    if (headerRowContent) {\n      sections.push({\n        type: 'header',\n        key: 'header',\n        isSticky: stickyHeaderDates,\n        chunk: {\n          elRef: this.headerElRef,\n          tableClassName: 'fc-col-header',\n          rowContent: headerRowContent\n        }\n      });\n    }\n\n    sections.push({\n      type: 'body',\n      key: 'body',\n      liquid: true,\n      chunk: {\n        content: bodyContent\n      }\n    });\n    return createElement(ViewRoot, {\n      viewSpec: context.viewSpec\n    }, function (rootElRef, classNames) {\n      return createElement(\"div\", {\n        ref: rootElRef,\n        className: ['fc-daygrid'].concat(classNames).join(' ')\n      }, createElement(SimpleScrollGrid, {\n        liquid: !props.isHeightAuto && !props.forPrint,\n        collapsibleWidth: props.forPrint,\n        cols: []\n        /* TODO: make optional? */\n        ,\n        sections: sections\n      }));\n    });\n  };\n\n  TableView.prototype.renderHScrollLayout = function (headerRowContent, bodyContent, colCnt, dayMinWidth) {\n    var ScrollGrid = this.context.pluginHooks.scrollGridImpl;\n\n    if (!ScrollGrid) {\n      throw new Error('No ScrollGrid implementation');\n    }\n\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var stickyHeaderDates = !props.forPrint && getStickyHeaderDates(context.options);\n    var stickyFooterScrollbar = !props.forPrint && getStickyFooterScrollbar(context.options);\n    var sections = [];\n\n    if (headerRowContent) {\n      sections.push({\n        type: 'header',\n        key: 'header',\n        isSticky: stickyHeaderDates,\n        chunks: [{\n          key: 'main',\n          elRef: this.headerElRef,\n          tableClassName: 'fc-col-header',\n          rowContent: headerRowContent\n        }]\n      });\n    }\n\n    sections.push({\n      type: 'body',\n      key: 'body',\n      liquid: true,\n      chunks: [{\n        key: 'main',\n        content: bodyContent\n      }]\n    });\n\n    if (stickyFooterScrollbar) {\n      sections.push({\n        type: 'footer',\n        key: 'footer',\n        isSticky: true,\n        chunks: [{\n          key: 'main',\n          content: renderScrollShim\n        }]\n      });\n    }\n\n    return createElement(ViewRoot, {\n      viewSpec: context.viewSpec\n    }, function (rootElRef, classNames) {\n      return createElement(\"div\", {\n        ref: rootElRef,\n        className: ['fc-daygrid'].concat(classNames).join(' ')\n      }, createElement(ScrollGrid, {\n        liquid: !props.isHeightAuto && !props.forPrint,\n        collapsibleWidth: props.forPrint,\n        colGroups: [{\n          cols: [{\n            span: colCnt,\n            minWidth: dayMinWidth\n          }]\n        }],\n        sections: sections\n      }));\n    });\n  };\n\n  return TableView;\n}(DateComponent);\n\nfunction splitSegsByRow(segs, rowCnt) {\n  var byRow = [];\n\n  for (var i = 0; i < rowCnt; i += 1) {\n    byRow[i] = [];\n  }\n\n  for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n    var seg = segs_1[_i];\n    byRow[seg.row].push(seg);\n  }\n\n  return byRow;\n}\n\nfunction splitSegsByFirstCol(segs, colCnt) {\n  var byCol = [];\n\n  for (var i = 0; i < colCnt; i += 1) {\n    byCol[i] = [];\n  }\n\n  for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n    var seg = segs_2[_i];\n    byCol[seg.firstCol].push(seg);\n  }\n\n  return byCol;\n}\n\nfunction splitInteractionByRow(ui, rowCnt) {\n  var byRow = [];\n\n  if (!ui) {\n    for (var i = 0; i < rowCnt; i += 1) {\n      byRow[i] = null;\n    }\n  } else {\n    for (var i = 0; i < rowCnt; i += 1) {\n      byRow[i] = {\n        affectedInstances: ui.affectedInstances,\n        isEvent: ui.isEvent,\n        segs: []\n      };\n    }\n\n    for (var _i = 0, _a = ui.segs; _i < _a.length; _i++) {\n      var seg = _a[_i];\n      byRow[seg.row].segs.push(seg);\n    }\n  }\n\n  return byRow;\n}\n\nvar TableCellTop =\n/** @class */\nfunction (_super) {\n  __extends(TableCellTop, _super);\n\n  function TableCellTop() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TableCellTop.prototype.render = function () {\n    var props = this.props;\n    var navLinkAttrs = buildNavLinkAttrs(this.context, props.date);\n    return createElement(DayCellContent, {\n      date: props.date,\n      dateProfile: props.dateProfile,\n      todayRange: props.todayRange,\n      showDayNumber: props.showDayNumber,\n      extraHookProps: props.extraHookProps,\n      defaultContent: renderTopInner\n    }, function (innerElRef, innerContent) {\n      return (innerContent || props.forceDayTop) && createElement(\"div\", {\n        className: \"fc-daygrid-day-top\",\n        ref: innerElRef\n      }, createElement(\"a\", __assign({\n        id: props.dayNumberId,\n        className: \"fc-daygrid-day-number\"\n      }, navLinkAttrs), innerContent || createElement(Fragment, null, \"\\u00A0\")));\n    });\n  };\n\n  return TableCellTop;\n}(BaseComponent);\n\nfunction renderTopInner(props) {\n  return props.dayNumberText;\n}\n\nvar DEFAULT_TABLE_EVENT_TIME_FORMAT = createFormatter({\n  hour: 'numeric',\n  minute: '2-digit',\n  omitZeroMinute: true,\n  meridiem: 'narrow'\n});\n\nfunction hasListItemDisplay(seg) {\n  var display = seg.eventRange.ui.display;\n  return display === 'list-item' || display === 'auto' && !seg.eventRange.def.allDay && seg.firstCol === seg.lastCol && // can't be multi-day\n  seg.isStart && // \"\n  seg.isEnd // \"\n  ;\n}\n\nvar TableBlockEvent =\n/** @class */\nfunction (_super) {\n  __extends(TableBlockEvent, _super);\n\n  function TableBlockEvent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TableBlockEvent.prototype.render = function () {\n    var props = this.props;\n    return createElement(StandardEvent, __assign({}, props, {\n      extraClassNames: ['fc-daygrid-event', 'fc-daygrid-block-event', 'fc-h-event'],\n      defaultTimeFormat: DEFAULT_TABLE_EVENT_TIME_FORMAT,\n      defaultDisplayEventEnd: props.defaultDisplayEventEnd,\n      disableResizing: !props.seg.eventRange.def.allDay\n    }));\n  };\n\n  return TableBlockEvent;\n}(BaseComponent);\n\nvar TableListItemEvent =\n/** @class */\nfunction (_super) {\n  __extends(TableListItemEvent, _super);\n\n  function TableListItemEvent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TableListItemEvent.prototype.render = function () {\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    var timeFormat = context.options.eventTimeFormat || DEFAULT_TABLE_EVENT_TIME_FORMAT;\n    var timeText = buildSegTimeText(props.seg, timeFormat, context, true, props.defaultDisplayEventEnd);\n    return createElement(EventRoot, {\n      seg: props.seg,\n      timeText: timeText,\n      defaultContent: renderInnerContent,\n      isDragging: props.isDragging,\n      isResizing: false,\n      isDateSelecting: false,\n      isSelected: props.isSelected,\n      isPast: props.isPast,\n      isFuture: props.isFuture,\n      isToday: props.isToday\n    }, function (rootElRef, classNames, innerElRef, innerContent) {\n      return (// we don't use styles!\n        createElement(\"a\", __assign({\n          className: ['fc-daygrid-event', 'fc-daygrid-dot-event'].concat(classNames).join(' '),\n          ref: rootElRef\n        }, getSegAnchorAttrs(props.seg, context)), innerContent)\n      );\n    });\n  };\n\n  return TableListItemEvent;\n}(BaseComponent);\n\nfunction renderInnerContent(innerProps) {\n  return createElement(Fragment, null, createElement(\"div\", {\n    className: \"fc-daygrid-event-dot\",\n    style: {\n      borderColor: innerProps.borderColor || innerProps.backgroundColor\n    }\n  }), innerProps.timeText && createElement(\"div\", {\n    className: \"fc-event-time\"\n  }, innerProps.timeText), createElement(\"div\", {\n    className: \"fc-event-title\"\n  }, innerProps.event.title || createElement(Fragment, null, \"\\u00A0\")));\n}\n\nvar TableCellMoreLink =\n/** @class */\nfunction (_super) {\n  __extends(TableCellMoreLink, _super);\n\n  function TableCellMoreLink() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.compileSegs = memoize(compileSegs);\n    return _this;\n  }\n\n  TableCellMoreLink.prototype.render = function () {\n    var props = this.props;\n\n    var _a = this.compileSegs(props.singlePlacements),\n        allSegs = _a.allSegs,\n        invisibleSegs = _a.invisibleSegs;\n\n    return createElement(MoreLinkRoot, {\n      dateProfile: props.dateProfile,\n      todayRange: props.todayRange,\n      allDayDate: props.allDayDate,\n      moreCnt: props.moreCnt,\n      allSegs: allSegs,\n      hiddenSegs: invisibleSegs,\n      alignmentElRef: props.alignmentElRef,\n      alignGridTop: props.alignGridTop,\n      extraDateSpan: props.extraDateSpan,\n      popoverContent: function () {\n        var isForcedInvisible = (props.eventDrag ? props.eventDrag.affectedInstances : null) || (props.eventResize ? props.eventResize.affectedInstances : null) || {};\n        return createElement(Fragment, null, allSegs.map(function (seg) {\n          var instanceId = seg.eventRange.instance.instanceId;\n          return createElement(\"div\", {\n            className: \"fc-daygrid-event-harness\",\n            key: instanceId,\n            style: {\n              visibility: isForcedInvisible[instanceId] ? 'hidden' : ''\n            }\n          }, hasListItemDisplay(seg) ? createElement(TableListItemEvent, __assign({\n            seg: seg,\n            isDragging: false,\n            isSelected: instanceId === props.eventSelection,\n            defaultDisplayEventEnd: false\n          }, getSegMeta(seg, props.todayRange))) : createElement(TableBlockEvent, __assign({\n            seg: seg,\n            isDragging: false,\n            isResizing: false,\n            isDateSelecting: false,\n            isSelected: instanceId === props.eventSelection,\n            defaultDisplayEventEnd: false\n          }, getSegMeta(seg, props.todayRange))));\n        }));\n      }\n    }, function (rootElRef, classNames, innerElRef, innerContent, handleClick, title, isExpanded, popoverId) {\n      return createElement(\"a\", __assign({\n        ref: rootElRef,\n        className: ['fc-daygrid-more-link'].concat(classNames).join(' '),\n        title: title,\n        \"aria-expanded\": isExpanded,\n        \"aria-controls\": popoverId\n      }, createAriaClickAttrs(handleClick)), innerContent);\n    });\n  };\n\n  return TableCellMoreLink;\n}(BaseComponent);\n\nfunction compileSegs(singlePlacements) {\n  var allSegs = [];\n  var invisibleSegs = [];\n\n  for (var _i = 0, singlePlacements_1 = singlePlacements; _i < singlePlacements_1.length; _i++) {\n    var placement = singlePlacements_1[_i];\n    allSegs.push(placement.seg);\n\n    if (!placement.isVisible) {\n      invisibleSegs.push(placement.seg);\n    }\n  }\n\n  return {\n    allSegs: allSegs,\n    invisibleSegs: invisibleSegs\n  };\n}\n\nvar DEFAULT_WEEK_NUM_FORMAT = createFormatter({\n  week: 'narrow'\n});\n\nvar TableCell =\n/** @class */\nfunction (_super) {\n  __extends(TableCell, _super);\n\n  function TableCell() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.rootElRef = createRef();\n    _this.state = {\n      dayNumberId: getUniqueDomId()\n    };\n\n    _this.handleRootEl = function (el) {\n      setRef(_this.rootElRef, el);\n      setRef(_this.props.elRef, el);\n    };\n\n    return _this;\n  }\n\n  TableCell.prototype.render = function () {\n    var _a = this,\n        context = _a.context,\n        props = _a.props,\n        state = _a.state,\n        rootElRef = _a.rootElRef;\n\n    var date = props.date,\n        dateProfile = props.dateProfile;\n    var navLinkAttrs = buildNavLinkAttrs(context, date, 'week');\n    return createElement(DayCellRoot, {\n      date: date,\n      dateProfile: dateProfile,\n      todayRange: props.todayRange,\n      showDayNumber: props.showDayNumber,\n      extraHookProps: props.extraHookProps,\n      elRef: this.handleRootEl\n    }, function (dayElRef, dayClassNames, rootDataAttrs, isDisabled) {\n      return createElement(\"td\", __assign({\n        ref: dayElRef,\n        role: \"gridcell\",\n        className: ['fc-daygrid-day'].concat(dayClassNames, props.extraClassNames || []).join(' ')\n      }, rootDataAttrs, props.extraDataAttrs, props.showDayNumber ? {\n        'aria-labelledby': state.dayNumberId\n      } : {}), createElement(\"div\", {\n        className: \"fc-daygrid-day-frame fc-scrollgrid-sync-inner\",\n        ref: props.innerElRef\n        /* different from hook system! RENAME */\n\n      }, props.showWeekNumber && createElement(WeekNumberRoot, {\n        date: date,\n        defaultFormat: DEFAULT_WEEK_NUM_FORMAT\n      }, function (weekElRef, weekClassNames, innerElRef, innerContent) {\n        return createElement(\"a\", __assign({\n          ref: weekElRef,\n          className: ['fc-daygrid-week-number'].concat(weekClassNames).join(' ')\n        }, navLinkAttrs), innerContent);\n      }), !isDisabled && createElement(TableCellTop, {\n        date: date,\n        dateProfile: dateProfile,\n        showDayNumber: props.showDayNumber,\n        dayNumberId: state.dayNumberId,\n        forceDayTop: props.forceDayTop,\n        todayRange: props.todayRange,\n        extraHookProps: props.extraHookProps\n      }), createElement(\"div\", {\n        className: \"fc-daygrid-day-events\",\n        ref: props.fgContentElRef\n      }, props.fgContent, createElement(\"div\", {\n        className: \"fc-daygrid-day-bottom\",\n        style: {\n          marginTop: props.moreMarginTop\n        }\n      }, createElement(TableCellMoreLink, {\n        allDayDate: date,\n        singlePlacements: props.singlePlacements,\n        moreCnt: props.moreCnt,\n        alignmentElRef: rootElRef,\n        alignGridTop: !props.showDayNumber,\n        extraDateSpan: props.extraDateSpan,\n        dateProfile: props.dateProfile,\n        eventSelection: props.eventSelection,\n        eventDrag: props.eventDrag,\n        eventResize: props.eventResize,\n        todayRange: props.todayRange\n      }))), createElement(\"div\", {\n        className: \"fc-daygrid-day-bg\"\n      }, props.bgContent)));\n    });\n  };\n\n  return TableCell;\n}(DateComponent);\n\nfunction computeFgSegPlacement(segs, // assumed already sorted\ndayMaxEvents, dayMaxEventRows, strictOrder, eventInstanceHeights, maxContentHeight, cells) {\n  var hierarchy = new DayGridSegHierarchy();\n  hierarchy.allowReslicing = true;\n  hierarchy.strictOrder = strictOrder;\n\n  if (dayMaxEvents === true || dayMaxEventRows === true) {\n    hierarchy.maxCoord = maxContentHeight;\n    hierarchy.hiddenConsumes = true;\n  } else if (typeof dayMaxEvents === 'number') {\n    hierarchy.maxStackCnt = dayMaxEvents;\n  } else if (typeof dayMaxEventRows === 'number') {\n    hierarchy.maxStackCnt = dayMaxEventRows;\n    hierarchy.hiddenConsumes = true;\n  } // create segInputs only for segs with known heights\n\n\n  var segInputs = [];\n  var unknownHeightSegs = [];\n\n  for (var i = 0; i < segs.length; i += 1) {\n    var seg = segs[i];\n    var instanceId = seg.eventRange.instance.instanceId;\n    var eventHeight = eventInstanceHeights[instanceId];\n\n    if (eventHeight != null) {\n      segInputs.push({\n        index: i,\n        thickness: eventHeight,\n        span: {\n          start: seg.firstCol,\n          end: seg.lastCol + 1\n        }\n      });\n    } else {\n      unknownHeightSegs.push(seg);\n    }\n  }\n\n  var hiddenEntries = hierarchy.addSegs(segInputs);\n  var segRects = hierarchy.toRects();\n\n  var _a = placeRects(segRects, segs, cells),\n      singleColPlacements = _a.singleColPlacements,\n      multiColPlacements = _a.multiColPlacements,\n      leftoverMargins = _a.leftoverMargins;\n\n  var moreCnts = [];\n  var moreMarginTops = []; // add segs with unknown heights\n\n  for (var _i = 0, unknownHeightSegs_1 = unknownHeightSegs; _i < unknownHeightSegs_1.length; _i++) {\n    var seg = unknownHeightSegs_1[_i];\n    multiColPlacements[seg.firstCol].push({\n      seg: seg,\n      isVisible: false,\n      isAbsolute: true,\n      absoluteTop: 0,\n      marginTop: 0\n    });\n\n    for (var col = seg.firstCol; col <= seg.lastCol; col += 1) {\n      singleColPlacements[col].push({\n        seg: resliceSeg(seg, col, col + 1, cells),\n        isVisible: false,\n        isAbsolute: false,\n        absoluteTop: 0,\n        marginTop: 0\n      });\n    }\n  } // add the hidden entries\n\n\n  for (var col = 0; col < cells.length; col += 1) {\n    moreCnts.push(0);\n  }\n\n  for (var _b = 0, hiddenEntries_1 = hiddenEntries; _b < hiddenEntries_1.length; _b++) {\n    var hiddenEntry = hiddenEntries_1[_b];\n    var seg = segs[hiddenEntry.index];\n    var hiddenSpan = hiddenEntry.span;\n    multiColPlacements[hiddenSpan.start].push({\n      seg: resliceSeg(seg, hiddenSpan.start, hiddenSpan.end, cells),\n      isVisible: false,\n      isAbsolute: true,\n      absoluteTop: 0,\n      marginTop: 0\n    });\n\n    for (var col = hiddenSpan.start; col < hiddenSpan.end; col += 1) {\n      moreCnts[col] += 1;\n      singleColPlacements[col].push({\n        seg: resliceSeg(seg, col, col + 1, cells),\n        isVisible: false,\n        isAbsolute: false,\n        absoluteTop: 0,\n        marginTop: 0\n      });\n    }\n  } // deal with leftover margins\n\n\n  for (var col = 0; col < cells.length; col += 1) {\n    moreMarginTops.push(leftoverMargins[col]);\n  }\n\n  return {\n    singleColPlacements: singleColPlacements,\n    multiColPlacements: multiColPlacements,\n    moreCnts: moreCnts,\n    moreMarginTops: moreMarginTops\n  };\n} // rects ordered by top coord, then left\n\n\nfunction placeRects(allRects, segs, cells) {\n  var rectsByEachCol = groupRectsByEachCol(allRects, cells.length);\n  var singleColPlacements = [];\n  var multiColPlacements = [];\n  var leftoverMargins = [];\n\n  for (var col = 0; col < cells.length; col += 1) {\n    var rects = rectsByEachCol[col]; // compute all static segs in singlePlacements\n\n    var singlePlacements = [];\n    var currentHeight = 0;\n    var currentMarginTop = 0;\n\n    for (var _i = 0, rects_1 = rects; _i < rects_1.length; _i++) {\n      var rect = rects_1[_i];\n      var seg = segs[rect.index];\n      singlePlacements.push({\n        seg: resliceSeg(seg, col, col + 1, cells),\n        isVisible: true,\n        isAbsolute: false,\n        absoluteTop: rect.levelCoord,\n        marginTop: rect.levelCoord - currentHeight\n      });\n      currentHeight = rect.levelCoord + rect.thickness;\n    } // compute mixed static/absolute segs in multiPlacements\n\n\n    var multiPlacements = [];\n    currentHeight = 0;\n    currentMarginTop = 0;\n\n    for (var _a = 0, rects_2 = rects; _a < rects_2.length; _a++) {\n      var rect = rects_2[_a];\n      var seg = segs[rect.index];\n      var isAbsolute = rect.span.end - rect.span.start > 1; // multi-column?\n\n      var isFirstCol = rect.span.start === col;\n      currentMarginTop += rect.levelCoord - currentHeight; // amount of space since bottom of previous seg\n\n      currentHeight = rect.levelCoord + rect.thickness; // height will now be bottom of current seg\n\n      if (isAbsolute) {\n        currentMarginTop += rect.thickness;\n\n        if (isFirstCol) {\n          multiPlacements.push({\n            seg: resliceSeg(seg, rect.span.start, rect.span.end, cells),\n            isVisible: true,\n            isAbsolute: true,\n            absoluteTop: rect.levelCoord,\n            marginTop: 0\n          });\n        }\n      } else if (isFirstCol) {\n        multiPlacements.push({\n          seg: resliceSeg(seg, rect.span.start, rect.span.end, cells),\n          isVisible: true,\n          isAbsolute: false,\n          absoluteTop: rect.levelCoord,\n          marginTop: currentMarginTop // claim the margin\n\n        });\n        currentMarginTop = 0;\n      }\n    }\n\n    singleColPlacements.push(singlePlacements);\n    multiColPlacements.push(multiPlacements);\n    leftoverMargins.push(currentMarginTop);\n  }\n\n  return {\n    singleColPlacements: singleColPlacements,\n    multiColPlacements: multiColPlacements,\n    leftoverMargins: leftoverMargins\n  };\n}\n\nfunction groupRectsByEachCol(rects, colCnt) {\n  var rectsByEachCol = [];\n\n  for (var col = 0; col < colCnt; col += 1) {\n    rectsByEachCol.push([]);\n  }\n\n  for (var _i = 0, rects_3 = rects; _i < rects_3.length; _i++) {\n    var rect = rects_3[_i];\n\n    for (var col = rect.span.start; col < rect.span.end; col += 1) {\n      rectsByEachCol[col].push(rect);\n    }\n  }\n\n  return rectsByEachCol;\n}\n\nfunction resliceSeg(seg, spanStart, spanEnd, cells) {\n  if (seg.firstCol === spanStart && seg.lastCol === spanEnd - 1) {\n    return seg;\n  }\n\n  var eventRange = seg.eventRange;\n  var origRange = eventRange.range;\n  var slicedRange = intersectRanges(origRange, {\n    start: cells[spanStart].date,\n    end: addDays(cells[spanEnd - 1].date, 1)\n  });\n  return __assign(__assign({}, seg), {\n    firstCol: spanStart,\n    lastCol: spanEnd - 1,\n    eventRange: {\n      def: eventRange.def,\n      ui: __assign(__assign({}, eventRange.ui), {\n        durationEditable: false\n      }),\n      instance: eventRange.instance,\n      range: slicedRange\n    },\n    isStart: seg.isStart && slicedRange.start.valueOf() === origRange.start.valueOf(),\n    isEnd: seg.isEnd && slicedRange.end.valueOf() === origRange.end.valueOf()\n  });\n}\n\nvar DayGridSegHierarchy =\n/** @class */\nfunction (_super) {\n  __extends(DayGridSegHierarchy, _super);\n\n  function DayGridSegHierarchy() {\n    var _this = _super !== null && _super.apply(this, arguments) || this; // config\n\n\n    _this.hiddenConsumes = false; // allows us to keep hidden entries in the hierarchy so they take up space\n\n    _this.forceHidden = {};\n    return _this;\n  }\n\n  DayGridSegHierarchy.prototype.addSegs = function (segInputs) {\n    var _this = this;\n\n    var hiddenSegs = _super.prototype.addSegs.call(this, segInputs);\n\n    var entriesByLevel = this.entriesByLevel;\n\n    var excludeHidden = function (entry) {\n      return !_this.forceHidden[buildEntryKey(entry)];\n    }; // remove the forced-hidden segs\n\n\n    for (var level = 0; level < entriesByLevel.length; level += 1) {\n      entriesByLevel[level] = entriesByLevel[level].filter(excludeHidden);\n    }\n\n    return hiddenSegs;\n  };\n\n  DayGridSegHierarchy.prototype.handleInvalidInsertion = function (insertion, entry, hiddenEntries) {\n    var _a = this,\n        entriesByLevel = _a.entriesByLevel,\n        forceHidden = _a.forceHidden;\n\n    var touchingEntry = insertion.touchingEntry,\n        touchingLevel = insertion.touchingLevel,\n        touchingLateral = insertion.touchingLateral;\n\n    if (this.hiddenConsumes && touchingEntry) {\n      var touchingEntryId = buildEntryKey(touchingEntry); // if not already hidden\n\n      if (!forceHidden[touchingEntryId]) {\n        if (this.allowReslicing) {\n          var placeholderEntry = __assign(__assign({}, touchingEntry), {\n            span: intersectSpans(touchingEntry.span, entry.span)\n          });\n\n          var placeholderEntryId = buildEntryKey(placeholderEntry);\n          forceHidden[placeholderEntryId] = true;\n          entriesByLevel[touchingLevel][touchingLateral] = placeholderEntry; // replace touchingEntry with our placeholder\n\n          this.splitEntry(touchingEntry, entry, hiddenEntries); // split up the touchingEntry, reinsert it\n        } else {\n          forceHidden[touchingEntryId] = true;\n          hiddenEntries.push(touchingEntry);\n        }\n      }\n    }\n\n    return _super.prototype.handleInvalidInsertion.call(this, insertion, entry, hiddenEntries);\n  };\n\n  return DayGridSegHierarchy;\n}(SegHierarchy);\n\nvar TableRow =\n/** @class */\nfunction (_super) {\n  __extends(TableRow, _super);\n\n  function TableRow() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.cellElRefs = new RefMap(); // the <td>\n\n    _this.frameElRefs = new RefMap(); // the fc-daygrid-day-frame\n\n    _this.fgElRefs = new RefMap(); // the fc-daygrid-day-events\n\n    _this.segHarnessRefs = new RefMap(); // indexed by \"instanceId:firstCol\"\n\n    _this.rootElRef = createRef();\n    _this.state = {\n      framePositions: null,\n      maxContentHeight: null,\n      eventInstanceHeights: {}\n    };\n    return _this;\n  }\n\n  TableRow.prototype.render = function () {\n    var _this = this;\n\n    var _a = this,\n        props = _a.props,\n        state = _a.state,\n        context = _a.context;\n\n    var options = context.options;\n    var colCnt = props.cells.length;\n    var businessHoursByCol = splitSegsByFirstCol(props.businessHourSegs, colCnt);\n    var bgEventSegsByCol = splitSegsByFirstCol(props.bgEventSegs, colCnt);\n    var highlightSegsByCol = splitSegsByFirstCol(this.getHighlightSegs(), colCnt);\n    var mirrorSegsByCol = splitSegsByFirstCol(this.getMirrorSegs(), colCnt);\n\n    var _b = computeFgSegPlacement(sortEventSegs(props.fgEventSegs, options.eventOrder), props.dayMaxEvents, props.dayMaxEventRows, options.eventOrderStrict, state.eventInstanceHeights, state.maxContentHeight, props.cells),\n        singleColPlacements = _b.singleColPlacements,\n        multiColPlacements = _b.multiColPlacements,\n        moreCnts = _b.moreCnts,\n        moreMarginTops = _b.moreMarginTops;\n\n    var isForcedInvisible = // TODO: messy way to compute this\n    props.eventDrag && props.eventDrag.affectedInstances || props.eventResize && props.eventResize.affectedInstances || {};\n    return createElement(\"tr\", {\n      ref: this.rootElRef,\n      role: \"row\"\n    }, props.renderIntro && props.renderIntro(), props.cells.map(function (cell, col) {\n      var normalFgNodes = _this.renderFgSegs(col, props.forPrint ? singleColPlacements[col] : multiColPlacements[col], props.todayRange, isForcedInvisible);\n\n      var mirrorFgNodes = _this.renderFgSegs(col, buildMirrorPlacements(mirrorSegsByCol[col], multiColPlacements), props.todayRange, {}, Boolean(props.eventDrag), Boolean(props.eventResize), false);\n\n      return createElement(TableCell, {\n        key: cell.key,\n        elRef: _this.cellElRefs.createRef(cell.key),\n        innerElRef: _this.frameElRefs.createRef(cell.key)\n        /* FF <td> problem, but okay to use for left/right. TODO: rename prop */\n        ,\n        dateProfile: props.dateProfile,\n        date: cell.date,\n        showDayNumber: props.showDayNumbers,\n        showWeekNumber: props.showWeekNumbers && col === 0,\n        forceDayTop: props.showWeekNumbers\n        /* even displaying weeknum for row, not necessarily day */\n        ,\n        todayRange: props.todayRange,\n        eventSelection: props.eventSelection,\n        eventDrag: props.eventDrag,\n        eventResize: props.eventResize,\n        extraHookProps: cell.extraHookProps,\n        extraDataAttrs: cell.extraDataAttrs,\n        extraClassNames: cell.extraClassNames,\n        extraDateSpan: cell.extraDateSpan,\n        moreCnt: moreCnts[col],\n        moreMarginTop: moreMarginTops[col],\n        singlePlacements: singleColPlacements[col],\n        fgContentElRef: _this.fgElRefs.createRef(cell.key),\n        fgContent: // Fragment scopes the keys\n        createElement(Fragment, null, createElement(Fragment, null, normalFgNodes), createElement(Fragment, null, mirrorFgNodes)),\n        bgContent: // Fragment scopes the keys\n        createElement(Fragment, null, _this.renderFillSegs(highlightSegsByCol[col], 'highlight'), _this.renderFillSegs(businessHoursByCol[col], 'non-business'), _this.renderFillSegs(bgEventSegsByCol[col], 'bg-event'))\n      });\n    }));\n  };\n\n  TableRow.prototype.componentDidMount = function () {\n    this.updateSizing(true);\n  };\n\n  TableRow.prototype.componentDidUpdate = function (prevProps, prevState) {\n    var currentProps = this.props;\n    this.updateSizing(!isPropsEqual(prevProps, currentProps));\n  };\n\n  TableRow.prototype.getHighlightSegs = function () {\n    var props = this.props;\n\n    if (props.eventDrag && props.eventDrag.segs.length) {\n      // messy check\n      return props.eventDrag.segs;\n    }\n\n    if (props.eventResize && props.eventResize.segs.length) {\n      // messy check\n      return props.eventResize.segs;\n    }\n\n    return props.dateSelectionSegs;\n  };\n\n  TableRow.prototype.getMirrorSegs = function () {\n    var props = this.props;\n\n    if (props.eventResize && props.eventResize.segs.length) {\n      // messy check\n      return props.eventResize.segs;\n    }\n\n    return [];\n  };\n\n  TableRow.prototype.renderFgSegs = function (col, segPlacements, todayRange, isForcedInvisible, isDragging, isResizing, isDateSelecting) {\n    var context = this.context;\n    var eventSelection = this.props.eventSelection;\n    var framePositions = this.state.framePositions;\n    var defaultDisplayEventEnd = this.props.cells.length === 1; // colCnt === 1\n\n    var isMirror = isDragging || isResizing || isDateSelecting;\n    var nodes = [];\n\n    if (framePositions) {\n      for (var _i = 0, segPlacements_1 = segPlacements; _i < segPlacements_1.length; _i++) {\n        var placement = segPlacements_1[_i];\n        var seg = placement.seg;\n        var instanceId = seg.eventRange.instance.instanceId;\n        var key = instanceId + ':' + col;\n        var isVisible = placement.isVisible && !isForcedInvisible[instanceId];\n        var isAbsolute = placement.isAbsolute;\n        var left = '';\n        var right = '';\n\n        if (isAbsolute) {\n          if (context.isRtl) {\n            right = 0;\n            left = framePositions.lefts[seg.lastCol] - framePositions.lefts[seg.firstCol];\n          } else {\n            left = 0;\n            right = framePositions.rights[seg.firstCol] - framePositions.rights[seg.lastCol];\n          }\n        }\n        /*\n        known bug: events that are force to be list-item but span multiple days still take up space in later columns\n        todo: in print view, for multi-day events, don't display title within non-start/end segs\n        */\n\n\n        nodes.push(createElement(\"div\", {\n          className: 'fc-daygrid-event-harness' + (isAbsolute ? ' fc-daygrid-event-harness-abs' : ''),\n          key: key,\n          ref: isMirror ? null : this.segHarnessRefs.createRef(key),\n          style: {\n            visibility: isVisible ? '' : 'hidden',\n            marginTop: isAbsolute ? '' : placement.marginTop,\n            top: isAbsolute ? placement.absoluteTop : '',\n            left: left,\n            right: right\n          }\n        }, hasListItemDisplay(seg) ? createElement(TableListItemEvent, __assign({\n          seg: seg,\n          isDragging: isDragging,\n          isSelected: instanceId === eventSelection,\n          defaultDisplayEventEnd: defaultDisplayEventEnd\n        }, getSegMeta(seg, todayRange))) : createElement(TableBlockEvent, __assign({\n          seg: seg,\n          isDragging: isDragging,\n          isResizing: isResizing,\n          isDateSelecting: isDateSelecting,\n          isSelected: instanceId === eventSelection,\n          defaultDisplayEventEnd: defaultDisplayEventEnd\n        }, getSegMeta(seg, todayRange)))));\n      }\n    }\n\n    return nodes;\n  };\n\n  TableRow.prototype.renderFillSegs = function (segs, fillType) {\n    var isRtl = this.context.isRtl;\n    var todayRange = this.props.todayRange;\n    var framePositions = this.state.framePositions;\n    var nodes = [];\n\n    if (framePositions) {\n      for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n        var seg = segs_1[_i];\n        var leftRightCss = isRtl ? {\n          right: 0,\n          left: framePositions.lefts[seg.lastCol] - framePositions.lefts[seg.firstCol]\n        } : {\n          left: 0,\n          right: framePositions.rights[seg.firstCol] - framePositions.rights[seg.lastCol]\n        };\n        nodes.push(createElement(\"div\", {\n          key: buildEventRangeKey(seg.eventRange),\n          className: \"fc-daygrid-bg-harness\",\n          style: leftRightCss\n        }, fillType === 'bg-event' ? createElement(BgEvent, __assign({\n          seg: seg\n        }, getSegMeta(seg, todayRange))) : renderFill(fillType)));\n      }\n    }\n\n    return createElement.apply(void 0, __spreadArray([Fragment, {}], nodes));\n  };\n\n  TableRow.prototype.updateSizing = function (isExternalSizingChange) {\n    var _a = this,\n        props = _a.props,\n        frameElRefs = _a.frameElRefs;\n\n    if (!props.forPrint && props.clientWidth !== null // positioning ready?\n    ) {\n      if (isExternalSizingChange) {\n        var frameEls = props.cells.map(function (cell) {\n          return frameElRefs.currentMap[cell.key];\n        });\n\n        if (frameEls.length) {\n          var originEl = this.rootElRef.current;\n          this.setState({\n            framePositions: new PositionCache(originEl, frameEls, true, // isHorizontal\n            false)\n          });\n        }\n      }\n\n      var oldInstanceHeights = this.state.eventInstanceHeights;\n      var newInstanceHeights = this.queryEventInstanceHeights();\n      var limitByContentHeight = props.dayMaxEvents === true || props.dayMaxEventRows === true;\n      this.safeSetState({\n        // HACK to prevent oscillations of events being shown/hidden from max-event-rows\n        // Essentially, once you compute an element's height, never null-out.\n        // TODO: always display all events, as visibility:hidden?\n        eventInstanceHeights: __assign(__assign({}, oldInstanceHeights), newInstanceHeights),\n        maxContentHeight: limitByContentHeight ? this.computeMaxContentHeight() : null\n      });\n    }\n  };\n\n  TableRow.prototype.queryEventInstanceHeights = function () {\n    var segElMap = this.segHarnessRefs.currentMap;\n    var eventInstanceHeights = {}; // get the max height amongst instance segs\n\n    for (var key in segElMap) {\n      var height = Math.round(segElMap[key].getBoundingClientRect().height);\n      var instanceId = key.split(':')[0]; // deconstruct how renderFgSegs makes the key\n\n      eventInstanceHeights[instanceId] = Math.max(eventInstanceHeights[instanceId] || 0, height);\n    }\n\n    return eventInstanceHeights;\n  };\n\n  TableRow.prototype.computeMaxContentHeight = function () {\n    var firstKey = this.props.cells[0].key;\n    var cellEl = this.cellElRefs.currentMap[firstKey];\n    var fcContainerEl = this.fgElRefs.currentMap[firstKey];\n    return cellEl.getBoundingClientRect().bottom - fcContainerEl.getBoundingClientRect().top;\n  };\n\n  TableRow.prototype.getCellEls = function () {\n    var elMap = this.cellElRefs.currentMap;\n    return this.props.cells.map(function (cell) {\n      return elMap[cell.key];\n    });\n  };\n\n  return TableRow;\n}(DateComponent);\n\nTableRow.addStateEquality({\n  eventInstanceHeights: isPropsEqual\n});\n\nfunction buildMirrorPlacements(mirrorSegs, colPlacements) {\n  if (!mirrorSegs.length) {\n    return [];\n  }\n\n  var topsByInstanceId = buildAbsoluteTopHash(colPlacements); // TODO: cache this at first render?\n\n  return mirrorSegs.map(function (seg) {\n    return {\n      seg: seg,\n      isVisible: true,\n      isAbsolute: true,\n      absoluteTop: topsByInstanceId[seg.eventRange.instance.instanceId],\n      marginTop: 0\n    };\n  });\n}\n\nfunction buildAbsoluteTopHash(colPlacements) {\n  var topsByInstanceId = {};\n\n  for (var _i = 0, colPlacements_1 = colPlacements; _i < colPlacements_1.length; _i++) {\n    var placements = colPlacements_1[_i];\n\n    for (var _a = 0, placements_1 = placements; _a < placements_1.length; _a++) {\n      var placement = placements_1[_a];\n      topsByInstanceId[placement.seg.eventRange.instance.instanceId] = placement.absoluteTop;\n    }\n  }\n\n  return topsByInstanceId;\n}\n\nvar Table =\n/** @class */\nfunction (_super) {\n  __extends(Table, _super);\n\n  function Table() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.splitBusinessHourSegs = memoize(splitSegsByRow);\n    _this.splitBgEventSegs = memoize(splitSegsByRow);\n    _this.splitFgEventSegs = memoize(splitSegsByRow);\n    _this.splitDateSelectionSegs = memoize(splitSegsByRow);\n    _this.splitEventDrag = memoize(splitInteractionByRow);\n    _this.splitEventResize = memoize(splitInteractionByRow);\n    _this.rowRefs = new RefMap();\n\n    _this.handleRootEl = function (rootEl) {\n      _this.rootEl = rootEl;\n\n      if (rootEl) {\n        _this.context.registerInteractiveComponent(_this, {\n          el: rootEl,\n          isHitComboAllowed: _this.props.isHitComboAllowed\n        });\n      } else {\n        _this.context.unregisterInteractiveComponent(_this);\n      }\n    };\n\n    return _this;\n  }\n\n  Table.prototype.render = function () {\n    var _this = this;\n\n    var props = this.props;\n    var dateProfile = props.dateProfile,\n        dayMaxEventRows = props.dayMaxEventRows,\n        dayMaxEvents = props.dayMaxEvents,\n        expandRows = props.expandRows;\n    var rowCnt = props.cells.length;\n    var businessHourSegsByRow = this.splitBusinessHourSegs(props.businessHourSegs, rowCnt);\n    var bgEventSegsByRow = this.splitBgEventSegs(props.bgEventSegs, rowCnt);\n    var fgEventSegsByRow = this.splitFgEventSegs(props.fgEventSegs, rowCnt);\n    var dateSelectionSegsByRow = this.splitDateSelectionSegs(props.dateSelectionSegs, rowCnt);\n    var eventDragByRow = this.splitEventDrag(props.eventDrag, rowCnt);\n    var eventResizeByRow = this.splitEventResize(props.eventResize, rowCnt);\n    var limitViaBalanced = dayMaxEvents === true || dayMaxEventRows === true; // if rows can't expand to fill fixed height, can't do balanced-height event limit\n    // TODO: best place to normalize these options?\n\n    if (limitViaBalanced && !expandRows) {\n      limitViaBalanced = false;\n      dayMaxEventRows = null;\n      dayMaxEvents = null;\n    }\n\n    var classNames = ['fc-daygrid-body', limitViaBalanced ? 'fc-daygrid-body-balanced' : 'fc-daygrid-body-unbalanced', expandRows ? '' : 'fc-daygrid-body-natural' // will height of one row depend on the others?\n    ];\n    return createElement(\"div\", {\n      className: classNames.join(' '),\n      ref: this.handleRootEl,\n      style: {\n        // these props are important to give this wrapper correct dimensions for interactions\n        // TODO: if we set it here, can we avoid giving to inner tables?\n        width: props.clientWidth,\n        minWidth: props.tableMinWidth\n      }\n    }, createElement(NowTimer, {\n      unit: \"day\"\n    }, function (nowDate, todayRange) {\n      return createElement(Fragment, null, createElement(\"table\", {\n        role: \"presentation\",\n        className: \"fc-scrollgrid-sync-table\",\n        style: {\n          width: props.clientWidth,\n          minWidth: props.tableMinWidth,\n          height: expandRows ? props.clientHeight : ''\n        }\n      }, props.colGroupNode, createElement(\"tbody\", {\n        role: \"presentation\"\n      }, props.cells.map(function (cells, row) {\n        return createElement(TableRow, {\n          ref: _this.rowRefs.createRef(row),\n          key: cells.length ? cells[0].date.toISOString()\n          /* best? or put key on cell? or use diff formatter? */\n          : row // in case there are no cells (like when resource view is loading)\n          ,\n          showDayNumbers: rowCnt > 1,\n          showWeekNumbers: props.showWeekNumbers,\n          todayRange: todayRange,\n          dateProfile: dateProfile,\n          cells: cells,\n          renderIntro: props.renderRowIntro,\n          businessHourSegs: businessHourSegsByRow[row],\n          eventSelection: props.eventSelection,\n          bgEventSegs: bgEventSegsByRow[row].filter(isSegAllDay)\n          /* hack */\n          ,\n          fgEventSegs: fgEventSegsByRow[row],\n          dateSelectionSegs: dateSelectionSegsByRow[row],\n          eventDrag: eventDragByRow[row],\n          eventResize: eventResizeByRow[row],\n          dayMaxEvents: dayMaxEvents,\n          dayMaxEventRows: dayMaxEventRows,\n          clientWidth: props.clientWidth,\n          clientHeight: props.clientHeight,\n          forPrint: props.forPrint\n        });\n      }))));\n    }));\n  }; // Hit System\n  // ----------------------------------------------------------------------------------------------------\n\n\n  Table.prototype.prepareHits = function () {\n    this.rowPositions = new PositionCache(this.rootEl, this.rowRefs.collect().map(function (rowObj) {\n      return rowObj.getCellEls()[0];\n    }), // first cell el in each row. TODO: not optimal\n    false, true);\n    this.colPositions = new PositionCache(this.rootEl, this.rowRefs.currentMap[0].getCellEls(), // cell els in first row\n    true, // horizontal\n    false);\n  };\n\n  Table.prototype.queryHit = function (positionLeft, positionTop) {\n    var _a = this,\n        colPositions = _a.colPositions,\n        rowPositions = _a.rowPositions;\n\n    var col = colPositions.leftToIndex(positionLeft);\n    var row = rowPositions.topToIndex(positionTop);\n\n    if (row != null && col != null) {\n      var cell = this.props.cells[row][col];\n      return {\n        dateProfile: this.props.dateProfile,\n        dateSpan: __assign({\n          range: this.getCellRange(row, col),\n          allDay: true\n        }, cell.extraDateSpan),\n        dayEl: this.getCellEl(row, col),\n        rect: {\n          left: colPositions.lefts[col],\n          right: colPositions.rights[col],\n          top: rowPositions.tops[row],\n          bottom: rowPositions.bottoms[row]\n        },\n        layer: 0\n      };\n    }\n\n    return null;\n  };\n\n  Table.prototype.getCellEl = function (row, col) {\n    return this.rowRefs.currentMap[row].getCellEls()[col]; // TODO: not optimal\n  };\n\n  Table.prototype.getCellRange = function (row, col) {\n    var start = this.props.cells[row][col].date;\n    var end = addDays(start, 1);\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  return Table;\n}(DateComponent);\n\nfunction isSegAllDay(seg) {\n  return seg.eventRange.def.allDay;\n}\n\nvar DayTableSlicer =\n/** @class */\nfunction (_super) {\n  __extends(DayTableSlicer, _super);\n\n  function DayTableSlicer() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.forceDayIfListItem = true;\n    return _this;\n  }\n\n  DayTableSlicer.prototype.sliceRange = function (dateRange, dayTableModel) {\n    return dayTableModel.sliceRange(dateRange);\n  };\n\n  return DayTableSlicer;\n}(Slicer);\n\nvar DayTable =\n/** @class */\nfunction (_super) {\n  __extends(DayTable, _super);\n\n  function DayTable() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.slicer = new DayTableSlicer();\n    _this.tableRef = createRef();\n    return _this;\n  }\n\n  DayTable.prototype.render = function () {\n    var _a = this,\n        props = _a.props,\n        context = _a.context;\n\n    return createElement(Table, __assign({\n      ref: this.tableRef\n    }, this.slicer.sliceProps(props, props.dateProfile, props.nextDayThreshold, context, props.dayTableModel), {\n      dateProfile: props.dateProfile,\n      cells: props.dayTableModel.cells,\n      colGroupNode: props.colGroupNode,\n      tableMinWidth: props.tableMinWidth,\n      renderRowIntro: props.renderRowIntro,\n      dayMaxEvents: props.dayMaxEvents,\n      dayMaxEventRows: props.dayMaxEventRows,\n      showWeekNumbers: props.showWeekNumbers,\n      expandRows: props.expandRows,\n      headerAlignElRef: props.headerAlignElRef,\n      clientWidth: props.clientWidth,\n      clientHeight: props.clientHeight,\n      forPrint: props.forPrint\n    }));\n  };\n\n  return DayTable;\n}(DateComponent);\n\nvar DayTableView =\n/** @class */\nfunction (_super) {\n  __extends(DayTableView, _super);\n\n  function DayTableView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.buildDayTableModel = memoize(buildDayTableModel);\n    _this.headerRef = createRef();\n    _this.tableRef = createRef();\n    return _this;\n  }\n\n  DayTableView.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.context,\n        options = _a.options,\n        dateProfileGenerator = _a.dateProfileGenerator;\n    var props = this.props;\n    var dayTableModel = this.buildDayTableModel(props.dateProfile, dateProfileGenerator);\n    var headerContent = options.dayHeaders && createElement(DayHeader, {\n      ref: this.headerRef,\n      dateProfile: props.dateProfile,\n      dates: dayTableModel.headerDates,\n      datesRepDistinctDays: dayTableModel.rowCnt === 1\n    });\n\n    var bodyContent = function (contentArg) {\n      return createElement(DayTable, {\n        ref: _this.tableRef,\n        dateProfile: props.dateProfile,\n        dayTableModel: dayTableModel,\n        businessHours: props.businessHours,\n        dateSelection: props.dateSelection,\n        eventStore: props.eventStore,\n        eventUiBases: props.eventUiBases,\n        eventSelection: props.eventSelection,\n        eventDrag: props.eventDrag,\n        eventResize: props.eventResize,\n        nextDayThreshold: options.nextDayThreshold,\n        colGroupNode: contentArg.tableColGroupNode,\n        tableMinWidth: contentArg.tableMinWidth,\n        dayMaxEvents: options.dayMaxEvents,\n        dayMaxEventRows: options.dayMaxEventRows,\n        showWeekNumbers: options.weekNumbers,\n        expandRows: !props.isHeightAuto,\n        headerAlignElRef: _this.headerElRef,\n        clientWidth: contentArg.clientWidth,\n        clientHeight: contentArg.clientHeight,\n        forPrint: props.forPrint\n      });\n    };\n\n    return options.dayMinWidth ? this.renderHScrollLayout(headerContent, bodyContent, dayTableModel.colCnt, options.dayMinWidth) : this.renderSimpleLayout(headerContent, bodyContent);\n  };\n\n  return DayTableView;\n}(TableView);\n\nfunction buildDayTableModel(dateProfile, dateProfileGenerator) {\n  var daySeries = new DaySeriesModel(dateProfile.renderRange, dateProfileGenerator);\n  return new DayTableModel(daySeries, /year|month|week/.test(dateProfile.currentRangeUnit));\n}\n\nvar TableDateProfileGenerator =\n/** @class */\nfunction (_super) {\n  __extends(TableDateProfileGenerator, _super);\n\n  function TableDateProfileGenerator() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  } // Computes the date range that will be rendered.\n\n\n  TableDateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n    var dateEnv = this.props.dateEnv;\n\n    var renderRange = _super.prototype.buildRenderRange.call(this, currentRange, currentRangeUnit, isRangeAllDay);\n\n    var start = renderRange.start;\n    var end = renderRange.end;\n    var endOfWeek; // year and month views should be aligned with weeks. this is already done for week\n\n    if (/^(year|month)$/.test(currentRangeUnit)) {\n      start = dateEnv.startOfWeek(start); // make end-of-week if not already\n\n      endOfWeek = dateEnv.startOfWeek(end);\n\n      if (endOfWeek.valueOf() !== end.valueOf()) {\n        end = addWeeks(endOfWeek, 1);\n      }\n    } // ensure 6 weeks\n\n\n    if (this.props.monthMode && this.props.fixedWeekCount) {\n      var rowCnt = Math.ceil( // could be partial weeks due to hiddenDays\n      diffWeeks(start, end));\n      end = addWeeks(end, 6 - rowCnt);\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  return TableDateProfileGenerator;\n}(DateProfileGenerator);\n\nvar main = createPlugin({\n  initialView: 'dayGridMonth',\n  views: {\n    dayGrid: {\n      component: DayTableView,\n      dateProfileGeneratorClass: TableDateProfileGenerator\n    },\n    dayGridDay: {\n      type: 'dayGrid',\n      duration: {\n        days: 1\n      }\n    },\n    dayGridWeek: {\n      type: 'dayGrid',\n      duration: {\n        weeks: 1\n      }\n    },\n    dayGridMonth: {\n      type: 'dayGrid',\n      duration: {\n        months: 1\n      },\n      monthMode: true,\n      fixedWeekCount: true\n    }\n  }\n});\nexport default main;\nexport { DayTableView as DayGridView, DayTable, DayTableSlicer, Table, TableView, buildDayTableModel };","map":{"version":3,"names":["createRef","getStickyHeaderDates","createElement","ViewRoot","SimpleScrollGrid","getStickyFooterScrollbar","renderScrollShim","DateComponent","buildNavLinkAttrs","DayCellContent","Fragment","BaseComponent","createFormatter","StandardEvent","buildSegTimeText","EventRoot","getSegAnchorAttrs","memoize","MoreLinkRoot","getSegMeta","createAriaClickAttrs","getUniqueDomId","setRef","DayCellRoot","WeekNumberRoot","buildEntryKey","intersectSpans","SegHierarchy","intersectRanges","addDays","RefMap","sortEventSegs","isPropsEqual","buildEventRangeKey","BgEvent","renderFill","PositionCache","NowTimer","Slicer","DayHeader","DaySeriesModel","DayTableModel","addWeeks","diffWeeks","DateProfileGenerator","createPlugin","__extends","__assign","__spreadArray","TableView","_super","_this","apply","arguments","headerElRef","prototype","renderSimpleLayout","headerRowContent","bodyContent","_a","props","context","sections","stickyHeaderDates","options","push","type","key","isSticky","chunk","elRef","tableClassName","rowContent","liquid","content","viewSpec","rootElRef","classNames","ref","className","concat","join","isHeightAuto","forPrint","collapsibleWidth","cols","renderHScrollLayout","colCnt","dayMinWidth","ScrollGrid","pluginHooks","scrollGridImpl","Error","stickyFooterScrollbar","chunks","colGroups","span","minWidth","splitSegsByRow","segs","rowCnt","byRow","i","_i","segs_1","length","seg","row","splitSegsByFirstCol","byCol","segs_2","firstCol","splitInteractionByRow","ui","affectedInstances","isEvent","TableCellTop","render","navLinkAttrs","date","dateProfile","todayRange","showDayNumber","extraHookProps","defaultContent","renderTopInner","innerElRef","innerContent","forceDayTop","id","dayNumberId","dayNumberText","DEFAULT_TABLE_EVENT_TIME_FORMAT","hour","minute","omitZeroMinute","meridiem","hasListItemDisplay","display","eventRange","def","allDay","lastCol","isStart","isEnd","TableBlockEvent","extraClassNames","defaultTimeFormat","defaultDisplayEventEnd","disableResizing","TableListItemEvent","timeFormat","eventTimeFormat","timeText","renderInnerContent","isDragging","isResizing","isDateSelecting","isSelected","isPast","isFuture","isToday","innerProps","style","borderColor","backgroundColor","event","title","TableCellMoreLink","compileSegs","singlePlacements","allSegs","invisibleSegs","allDayDate","moreCnt","hiddenSegs","alignmentElRef","alignGridTop","extraDateSpan","popoverContent","isForcedInvisible","eventDrag","eventResize","map","instanceId","instance","visibility","eventSelection","handleClick","isExpanded","popoverId","singlePlacements_1","placement","isVisible","DEFAULT_WEEK_NUM_FORMAT","week","TableCell","state","handleRootEl","el","dayElRef","dayClassNames","rootDataAttrs","isDisabled","role","extraDataAttrs","showWeekNumber","defaultFormat","weekElRef","weekClassNames","fgContentElRef","fgContent","marginTop","moreMarginTop","bgContent","computeFgSegPlacement","dayMaxEvents","dayMaxEventRows","strictOrder","eventInstanceHeights","maxContentHeight","cells","hierarchy","DayGridSegHierarchy","allowReslicing","maxCoord","hiddenConsumes","maxStackCnt","segInputs","unknownHeightSegs","eventHeight","index","thickness","start","end","hiddenEntries","addSegs","segRects","toRects","placeRects","singleColPlacements","multiColPlacements","leftoverMargins","moreCnts","moreMarginTops","unknownHeightSegs_1","isAbsolute","absoluteTop","col","resliceSeg","_b","hiddenEntries_1","hiddenEntry","hiddenSpan","allRects","rectsByEachCol","groupRectsByEachCol","rects","currentHeight","currentMarginTop","rects_1","rect","levelCoord","multiPlacements","rects_2","isFirstCol","rects_3","spanStart","spanEnd","origRange","range","slicedRange","durationEditable","valueOf","forceHidden","call","entriesByLevel","excludeHidden","entry","level","filter","handleInvalidInsertion","insertion","touchingEntry","touchingLevel","touchingLateral","touchingEntryId","placeholderEntry","placeholderEntryId","splitEntry","TableRow","cellElRefs","frameElRefs","fgElRefs","segHarnessRefs","framePositions","businessHoursByCol","businessHourSegs","bgEventSegsByCol","bgEventSegs","highlightSegsByCol","getHighlightSegs","mirrorSegsByCol","getMirrorSegs","fgEventSegs","eventOrder","eventOrderStrict","renderIntro","cell","normalFgNodes","renderFgSegs","mirrorFgNodes","buildMirrorPlacements","Boolean","showDayNumbers","showWeekNumbers","renderFillSegs","componentDidMount","updateSizing","componentDidUpdate","prevProps","prevState","currentProps","dateSelectionSegs","segPlacements","isMirror","nodes","segPlacements_1","left","right","isRtl","lefts","rights","top","fillType","leftRightCss","isExternalSizingChange","clientWidth","frameEls","currentMap","originEl","current","setState","oldInstanceHeights","newInstanceHeights","queryEventInstanceHeights","limitByContentHeight","safeSetState","computeMaxContentHeight","segElMap","height","Math","round","getBoundingClientRect","split","max","firstKey","cellEl","fcContainerEl","bottom","getCellEls","elMap","addStateEquality","mirrorSegs","colPlacements","topsByInstanceId","buildAbsoluteTopHash","colPlacements_1","placements","placements_1","Table","splitBusinessHourSegs","splitBgEventSegs","splitFgEventSegs","splitDateSelectionSegs","splitEventDrag","splitEventResize","rowRefs","rootEl","registerInteractiveComponent","isHitComboAllowed","unregisterInteractiveComponent","expandRows","businessHourSegsByRow","bgEventSegsByRow","fgEventSegsByRow","dateSelectionSegsByRow","eventDragByRow","eventResizeByRow","limitViaBalanced","width","tableMinWidth","unit","nowDate","clientHeight","colGroupNode","toISOString","renderRowIntro","isSegAllDay","prepareHits","rowPositions","collect","rowObj","colPositions","queryHit","positionLeft","positionTop","leftToIndex","topToIndex","dateSpan","getCellRange","dayEl","getCellEl","tops","bottoms","layer","DayTableSlicer","forceDayIfListItem","sliceRange","dateRange","dayTableModel","DayTable","slicer","tableRef","sliceProps","nextDayThreshold","headerAlignElRef","DayTableView","buildDayTableModel","headerRef","dateProfileGenerator","headerContent","dayHeaders","dates","headerDates","datesRepDistinctDays","contentArg","businessHours","dateSelection","eventStore","eventUiBases","tableColGroupNode","weekNumbers","daySeries","renderRange","test","currentRangeUnit","TableDateProfileGenerator","buildRenderRange","currentRange","isRangeAllDay","dateEnv","endOfWeek","startOfWeek","monthMode","fixedWeekCount","ceil","main","initialView","views","dayGrid","component","dateProfileGeneratorClass","dayGridDay","duration","days","dayGridWeek","weeks","dayGridMonth","months","DayGridView"],"sources":["C:/Users/Udenar/Desktop/backend-main/frontend/node_modules/@fullcalendar/daygrid/main.js"],"sourcesContent":["/*!\nFullCalendar v5.11.3\nDocs & License: https://fullcalendar.io/\n(c) 2022 Adam Shaw\n*/\nimport './main.css';\n\nimport { createRef, getStickyHeaderDates, createElement, ViewRoot, SimpleScrollGrid, getStickyFooterScrollbar, renderScrollShim, DateComponent, buildNavLinkAttrs, DayCellContent, Fragment, BaseComponent, createFormatter, StandardEvent, buildSegTimeText, EventRoot, getSegAnchorAttrs, memoize, MoreLinkRoot, getSegMeta, createAriaClickAttrs, getUniqueDomId, setRef, DayCellRoot, WeekNumberRoot, buildEntryKey, intersectSpans, SegHierarchy, intersectRanges, addDays, RefMap, sortEventSegs, isPropsEqual, buildEventRangeKey, BgEvent, renderFill, PositionCache, NowTimer, Slicer, DayHeader, DaySeriesModel, DayTableModel, addWeeks, diffWeeks, DateProfileGenerator, createPlugin } from '@fullcalendar/common';\nimport { __extends, __assign, __spreadArray } from 'tslib';\n\n/* An abstract class for the daygrid views, as well as month view. Renders one or more rows of day cells.\n----------------------------------------------------------------------------------------------------------------------*/\n// It is a manager for a Table subcomponent, which does most of the heavy lifting.\n// It is responsible for managing width/height.\nvar TableView = /** @class */ (function (_super) {\n    __extends(TableView, _super);\n    function TableView() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.headerElRef = createRef();\n        return _this;\n    }\n    TableView.prototype.renderSimpleLayout = function (headerRowContent, bodyContent) {\n        var _a = this, props = _a.props, context = _a.context;\n        var sections = [];\n        var stickyHeaderDates = getStickyHeaderDates(context.options);\n        if (headerRowContent) {\n            sections.push({\n                type: 'header',\n                key: 'header',\n                isSticky: stickyHeaderDates,\n                chunk: {\n                    elRef: this.headerElRef,\n                    tableClassName: 'fc-col-header',\n                    rowContent: headerRowContent,\n                },\n            });\n        }\n        sections.push({\n            type: 'body',\n            key: 'body',\n            liquid: true,\n            chunk: { content: bodyContent },\n        });\n        return (createElement(ViewRoot, { viewSpec: context.viewSpec }, function (rootElRef, classNames) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-daygrid'].concat(classNames).join(' ') },\n            createElement(SimpleScrollGrid, { liquid: !props.isHeightAuto && !props.forPrint, collapsibleWidth: props.forPrint, cols: [] /* TODO: make optional? */, sections: sections }))); }));\n    };\n    TableView.prototype.renderHScrollLayout = function (headerRowContent, bodyContent, colCnt, dayMinWidth) {\n        var ScrollGrid = this.context.pluginHooks.scrollGridImpl;\n        if (!ScrollGrid) {\n            throw new Error('No ScrollGrid implementation');\n        }\n        var _a = this, props = _a.props, context = _a.context;\n        var stickyHeaderDates = !props.forPrint && getStickyHeaderDates(context.options);\n        var stickyFooterScrollbar = !props.forPrint && getStickyFooterScrollbar(context.options);\n        var sections = [];\n        if (headerRowContent) {\n            sections.push({\n                type: 'header',\n                key: 'header',\n                isSticky: stickyHeaderDates,\n                chunks: [{\n                        key: 'main',\n                        elRef: this.headerElRef,\n                        tableClassName: 'fc-col-header',\n                        rowContent: headerRowContent,\n                    }],\n            });\n        }\n        sections.push({\n            type: 'body',\n            key: 'body',\n            liquid: true,\n            chunks: [{\n                    key: 'main',\n                    content: bodyContent,\n                }],\n        });\n        if (stickyFooterScrollbar) {\n            sections.push({\n                type: 'footer',\n                key: 'footer',\n                isSticky: true,\n                chunks: [{\n                        key: 'main',\n                        content: renderScrollShim,\n                    }],\n            });\n        }\n        return (createElement(ViewRoot, { viewSpec: context.viewSpec }, function (rootElRef, classNames) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-daygrid'].concat(classNames).join(' ') },\n            createElement(ScrollGrid, { liquid: !props.isHeightAuto && !props.forPrint, collapsibleWidth: props.forPrint, colGroups: [{ cols: [{ span: colCnt, minWidth: dayMinWidth }] }], sections: sections }))); }));\n    };\n    return TableView;\n}(DateComponent));\n\nfunction splitSegsByRow(segs, rowCnt) {\n    var byRow = [];\n    for (var i = 0; i < rowCnt; i += 1) {\n        byRow[i] = [];\n    }\n    for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n        var seg = segs_1[_i];\n        byRow[seg.row].push(seg);\n    }\n    return byRow;\n}\nfunction splitSegsByFirstCol(segs, colCnt) {\n    var byCol = [];\n    for (var i = 0; i < colCnt; i += 1) {\n        byCol[i] = [];\n    }\n    for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n        var seg = segs_2[_i];\n        byCol[seg.firstCol].push(seg);\n    }\n    return byCol;\n}\nfunction splitInteractionByRow(ui, rowCnt) {\n    var byRow = [];\n    if (!ui) {\n        for (var i = 0; i < rowCnt; i += 1) {\n            byRow[i] = null;\n        }\n    }\n    else {\n        for (var i = 0; i < rowCnt; i += 1) {\n            byRow[i] = {\n                affectedInstances: ui.affectedInstances,\n                isEvent: ui.isEvent,\n                segs: [],\n            };\n        }\n        for (var _i = 0, _a = ui.segs; _i < _a.length; _i++) {\n            var seg = _a[_i];\n            byRow[seg.row].segs.push(seg);\n        }\n    }\n    return byRow;\n}\n\nvar TableCellTop = /** @class */ (function (_super) {\n    __extends(TableCellTop, _super);\n    function TableCellTop() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TableCellTop.prototype.render = function () {\n        var props = this.props;\n        var navLinkAttrs = buildNavLinkAttrs(this.context, props.date);\n        return (createElement(DayCellContent, { date: props.date, dateProfile: props.dateProfile, todayRange: props.todayRange, showDayNumber: props.showDayNumber, extraHookProps: props.extraHookProps, defaultContent: renderTopInner }, function (innerElRef, innerContent) { return ((innerContent || props.forceDayTop) && (createElement(\"div\", { className: \"fc-daygrid-day-top\", ref: innerElRef },\n            createElement(\"a\", __assign({ id: props.dayNumberId, className: \"fc-daygrid-day-number\" }, navLinkAttrs), innerContent || createElement(Fragment, null, \"\\u00A0\"))))); }));\n    };\n    return TableCellTop;\n}(BaseComponent));\nfunction renderTopInner(props) {\n    return props.dayNumberText;\n}\n\nvar DEFAULT_TABLE_EVENT_TIME_FORMAT = createFormatter({\n    hour: 'numeric',\n    minute: '2-digit',\n    omitZeroMinute: true,\n    meridiem: 'narrow',\n});\nfunction hasListItemDisplay(seg) {\n    var display = seg.eventRange.ui.display;\n    return display === 'list-item' || (display === 'auto' &&\n        !seg.eventRange.def.allDay &&\n        seg.firstCol === seg.lastCol && // can't be multi-day\n        seg.isStart && // \"\n        seg.isEnd // \"\n    );\n}\n\nvar TableBlockEvent = /** @class */ (function (_super) {\n    __extends(TableBlockEvent, _super);\n    function TableBlockEvent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TableBlockEvent.prototype.render = function () {\n        var props = this.props;\n        return (createElement(StandardEvent, __assign({}, props, { extraClassNames: ['fc-daygrid-event', 'fc-daygrid-block-event', 'fc-h-event'], defaultTimeFormat: DEFAULT_TABLE_EVENT_TIME_FORMAT, defaultDisplayEventEnd: props.defaultDisplayEventEnd, disableResizing: !props.seg.eventRange.def.allDay })));\n    };\n    return TableBlockEvent;\n}(BaseComponent));\n\nvar TableListItemEvent = /** @class */ (function (_super) {\n    __extends(TableListItemEvent, _super);\n    function TableListItemEvent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TableListItemEvent.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        var timeFormat = context.options.eventTimeFormat || DEFAULT_TABLE_EVENT_TIME_FORMAT;\n        var timeText = buildSegTimeText(props.seg, timeFormat, context, true, props.defaultDisplayEventEnd);\n        return (createElement(EventRoot, { seg: props.seg, timeText: timeText, defaultContent: renderInnerContent, isDragging: props.isDragging, isResizing: false, isDateSelecting: false, isSelected: props.isSelected, isPast: props.isPast, isFuture: props.isFuture, isToday: props.isToday }, function (rootElRef, classNames, innerElRef, innerContent) { return ( // we don't use styles!\n        createElement(\"a\", __assign({ className: ['fc-daygrid-event', 'fc-daygrid-dot-event'].concat(classNames).join(' '), ref: rootElRef }, getSegAnchorAttrs(props.seg, context)), innerContent)); }));\n    };\n    return TableListItemEvent;\n}(BaseComponent));\nfunction renderInnerContent(innerProps) {\n    return (createElement(Fragment, null,\n        createElement(\"div\", { className: \"fc-daygrid-event-dot\", style: { borderColor: innerProps.borderColor || innerProps.backgroundColor } }),\n        innerProps.timeText && (createElement(\"div\", { className: \"fc-event-time\" }, innerProps.timeText)),\n        createElement(\"div\", { className: \"fc-event-title\" }, innerProps.event.title || createElement(Fragment, null, \"\\u00A0\"))));\n}\n\nvar TableCellMoreLink = /** @class */ (function (_super) {\n    __extends(TableCellMoreLink, _super);\n    function TableCellMoreLink() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.compileSegs = memoize(compileSegs);\n        return _this;\n    }\n    TableCellMoreLink.prototype.render = function () {\n        var props = this.props;\n        var _a = this.compileSegs(props.singlePlacements), allSegs = _a.allSegs, invisibleSegs = _a.invisibleSegs;\n        return (createElement(MoreLinkRoot, { dateProfile: props.dateProfile, todayRange: props.todayRange, allDayDate: props.allDayDate, moreCnt: props.moreCnt, allSegs: allSegs, hiddenSegs: invisibleSegs, alignmentElRef: props.alignmentElRef, alignGridTop: props.alignGridTop, extraDateSpan: props.extraDateSpan, popoverContent: function () {\n                var isForcedInvisible = (props.eventDrag ? props.eventDrag.affectedInstances : null) ||\n                    (props.eventResize ? props.eventResize.affectedInstances : null) ||\n                    {};\n                return (createElement(Fragment, null, allSegs.map(function (seg) {\n                    var instanceId = seg.eventRange.instance.instanceId;\n                    return (createElement(\"div\", { className: \"fc-daygrid-event-harness\", key: instanceId, style: {\n                            visibility: isForcedInvisible[instanceId] ? 'hidden' : '',\n                        } }, hasListItemDisplay(seg) ? (createElement(TableListItemEvent, __assign({ seg: seg, isDragging: false, isSelected: instanceId === props.eventSelection, defaultDisplayEventEnd: false }, getSegMeta(seg, props.todayRange)))) : (createElement(TableBlockEvent, __assign({ seg: seg, isDragging: false, isResizing: false, isDateSelecting: false, isSelected: instanceId === props.eventSelection, defaultDisplayEventEnd: false }, getSegMeta(seg, props.todayRange))))));\n                })));\n            } }, function (rootElRef, classNames, innerElRef, innerContent, handleClick, title, isExpanded, popoverId) { return (createElement(\"a\", __assign({ ref: rootElRef, className: ['fc-daygrid-more-link'].concat(classNames).join(' '), title: title, \"aria-expanded\": isExpanded, \"aria-controls\": popoverId }, createAriaClickAttrs(handleClick)), innerContent)); }));\n    };\n    return TableCellMoreLink;\n}(BaseComponent));\nfunction compileSegs(singlePlacements) {\n    var allSegs = [];\n    var invisibleSegs = [];\n    for (var _i = 0, singlePlacements_1 = singlePlacements; _i < singlePlacements_1.length; _i++) {\n        var placement = singlePlacements_1[_i];\n        allSegs.push(placement.seg);\n        if (!placement.isVisible) {\n            invisibleSegs.push(placement.seg);\n        }\n    }\n    return { allSegs: allSegs, invisibleSegs: invisibleSegs };\n}\n\nvar DEFAULT_WEEK_NUM_FORMAT = createFormatter({ week: 'narrow' });\nvar TableCell = /** @class */ (function (_super) {\n    __extends(TableCell, _super);\n    function TableCell() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        _this.state = {\n            dayNumberId: getUniqueDomId(),\n        };\n        _this.handleRootEl = function (el) {\n            setRef(_this.rootElRef, el);\n            setRef(_this.props.elRef, el);\n        };\n        return _this;\n    }\n    TableCell.prototype.render = function () {\n        var _a = this, context = _a.context, props = _a.props, state = _a.state, rootElRef = _a.rootElRef;\n        var date = props.date, dateProfile = props.dateProfile;\n        var navLinkAttrs = buildNavLinkAttrs(context, date, 'week');\n        return (createElement(DayCellRoot, { date: date, dateProfile: dateProfile, todayRange: props.todayRange, showDayNumber: props.showDayNumber, extraHookProps: props.extraHookProps, elRef: this.handleRootEl }, function (dayElRef, dayClassNames, rootDataAttrs, isDisabled) { return (createElement(\"td\", __assign({ ref: dayElRef, role: \"gridcell\", className: ['fc-daygrid-day'].concat(dayClassNames, props.extraClassNames || []).join(' ') }, rootDataAttrs, props.extraDataAttrs, (props.showDayNumber ? { 'aria-labelledby': state.dayNumberId } : {})),\n            createElement(\"div\", { className: \"fc-daygrid-day-frame fc-scrollgrid-sync-inner\", ref: props.innerElRef /* different from hook system! RENAME */ },\n                props.showWeekNumber && (createElement(WeekNumberRoot, { date: date, defaultFormat: DEFAULT_WEEK_NUM_FORMAT }, function (weekElRef, weekClassNames, innerElRef, innerContent) { return (createElement(\"a\", __assign({ ref: weekElRef, className: ['fc-daygrid-week-number'].concat(weekClassNames).join(' ') }, navLinkAttrs), innerContent)); })),\n                !isDisabled && (createElement(TableCellTop, { date: date, dateProfile: dateProfile, showDayNumber: props.showDayNumber, dayNumberId: state.dayNumberId, forceDayTop: props.forceDayTop, todayRange: props.todayRange, extraHookProps: props.extraHookProps })),\n                createElement(\"div\", { className: \"fc-daygrid-day-events\", ref: props.fgContentElRef },\n                    props.fgContent,\n                    createElement(\"div\", { className: \"fc-daygrid-day-bottom\", style: { marginTop: props.moreMarginTop } },\n                        createElement(TableCellMoreLink, { allDayDate: date, singlePlacements: props.singlePlacements, moreCnt: props.moreCnt, alignmentElRef: rootElRef, alignGridTop: !props.showDayNumber, extraDateSpan: props.extraDateSpan, dateProfile: props.dateProfile, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, todayRange: props.todayRange }))),\n                createElement(\"div\", { className: \"fc-daygrid-day-bg\" }, props.bgContent)))); }));\n    };\n    return TableCell;\n}(DateComponent));\n\nfunction computeFgSegPlacement(segs, // assumed already sorted\ndayMaxEvents, dayMaxEventRows, strictOrder, eventInstanceHeights, maxContentHeight, cells) {\n    var hierarchy = new DayGridSegHierarchy();\n    hierarchy.allowReslicing = true;\n    hierarchy.strictOrder = strictOrder;\n    if (dayMaxEvents === true || dayMaxEventRows === true) {\n        hierarchy.maxCoord = maxContentHeight;\n        hierarchy.hiddenConsumes = true;\n    }\n    else if (typeof dayMaxEvents === 'number') {\n        hierarchy.maxStackCnt = dayMaxEvents;\n    }\n    else if (typeof dayMaxEventRows === 'number') {\n        hierarchy.maxStackCnt = dayMaxEventRows;\n        hierarchy.hiddenConsumes = true;\n    }\n    // create segInputs only for segs with known heights\n    var segInputs = [];\n    var unknownHeightSegs = [];\n    for (var i = 0; i < segs.length; i += 1) {\n        var seg = segs[i];\n        var instanceId = seg.eventRange.instance.instanceId;\n        var eventHeight = eventInstanceHeights[instanceId];\n        if (eventHeight != null) {\n            segInputs.push({\n                index: i,\n                thickness: eventHeight,\n                span: {\n                    start: seg.firstCol,\n                    end: seg.lastCol + 1,\n                },\n            });\n        }\n        else {\n            unknownHeightSegs.push(seg);\n        }\n    }\n    var hiddenEntries = hierarchy.addSegs(segInputs);\n    var segRects = hierarchy.toRects();\n    var _a = placeRects(segRects, segs, cells), singleColPlacements = _a.singleColPlacements, multiColPlacements = _a.multiColPlacements, leftoverMargins = _a.leftoverMargins;\n    var moreCnts = [];\n    var moreMarginTops = [];\n    // add segs with unknown heights\n    for (var _i = 0, unknownHeightSegs_1 = unknownHeightSegs; _i < unknownHeightSegs_1.length; _i++) {\n        var seg = unknownHeightSegs_1[_i];\n        multiColPlacements[seg.firstCol].push({\n            seg: seg,\n            isVisible: false,\n            isAbsolute: true,\n            absoluteTop: 0,\n            marginTop: 0,\n        });\n        for (var col = seg.firstCol; col <= seg.lastCol; col += 1) {\n            singleColPlacements[col].push({\n                seg: resliceSeg(seg, col, col + 1, cells),\n                isVisible: false,\n                isAbsolute: false,\n                absoluteTop: 0,\n                marginTop: 0,\n            });\n        }\n    }\n    // add the hidden entries\n    for (var col = 0; col < cells.length; col += 1) {\n        moreCnts.push(0);\n    }\n    for (var _b = 0, hiddenEntries_1 = hiddenEntries; _b < hiddenEntries_1.length; _b++) {\n        var hiddenEntry = hiddenEntries_1[_b];\n        var seg = segs[hiddenEntry.index];\n        var hiddenSpan = hiddenEntry.span;\n        multiColPlacements[hiddenSpan.start].push({\n            seg: resliceSeg(seg, hiddenSpan.start, hiddenSpan.end, cells),\n            isVisible: false,\n            isAbsolute: true,\n            absoluteTop: 0,\n            marginTop: 0,\n        });\n        for (var col = hiddenSpan.start; col < hiddenSpan.end; col += 1) {\n            moreCnts[col] += 1;\n            singleColPlacements[col].push({\n                seg: resliceSeg(seg, col, col + 1, cells),\n                isVisible: false,\n                isAbsolute: false,\n                absoluteTop: 0,\n                marginTop: 0,\n            });\n        }\n    }\n    // deal with leftover margins\n    for (var col = 0; col < cells.length; col += 1) {\n        moreMarginTops.push(leftoverMargins[col]);\n    }\n    return { singleColPlacements: singleColPlacements, multiColPlacements: multiColPlacements, moreCnts: moreCnts, moreMarginTops: moreMarginTops };\n}\n// rects ordered by top coord, then left\nfunction placeRects(allRects, segs, cells) {\n    var rectsByEachCol = groupRectsByEachCol(allRects, cells.length);\n    var singleColPlacements = [];\n    var multiColPlacements = [];\n    var leftoverMargins = [];\n    for (var col = 0; col < cells.length; col += 1) {\n        var rects = rectsByEachCol[col];\n        // compute all static segs in singlePlacements\n        var singlePlacements = [];\n        var currentHeight = 0;\n        var currentMarginTop = 0;\n        for (var _i = 0, rects_1 = rects; _i < rects_1.length; _i++) {\n            var rect = rects_1[_i];\n            var seg = segs[rect.index];\n            singlePlacements.push({\n                seg: resliceSeg(seg, col, col + 1, cells),\n                isVisible: true,\n                isAbsolute: false,\n                absoluteTop: rect.levelCoord,\n                marginTop: rect.levelCoord - currentHeight,\n            });\n            currentHeight = rect.levelCoord + rect.thickness;\n        }\n        // compute mixed static/absolute segs in multiPlacements\n        var multiPlacements = [];\n        currentHeight = 0;\n        currentMarginTop = 0;\n        for (var _a = 0, rects_2 = rects; _a < rects_2.length; _a++) {\n            var rect = rects_2[_a];\n            var seg = segs[rect.index];\n            var isAbsolute = rect.span.end - rect.span.start > 1; // multi-column?\n            var isFirstCol = rect.span.start === col;\n            currentMarginTop += rect.levelCoord - currentHeight; // amount of space since bottom of previous seg\n            currentHeight = rect.levelCoord + rect.thickness; // height will now be bottom of current seg\n            if (isAbsolute) {\n                currentMarginTop += rect.thickness;\n                if (isFirstCol) {\n                    multiPlacements.push({\n                        seg: resliceSeg(seg, rect.span.start, rect.span.end, cells),\n                        isVisible: true,\n                        isAbsolute: true,\n                        absoluteTop: rect.levelCoord,\n                        marginTop: 0,\n                    });\n                }\n            }\n            else if (isFirstCol) {\n                multiPlacements.push({\n                    seg: resliceSeg(seg, rect.span.start, rect.span.end, cells),\n                    isVisible: true,\n                    isAbsolute: false,\n                    absoluteTop: rect.levelCoord,\n                    marginTop: currentMarginTop, // claim the margin\n                });\n                currentMarginTop = 0;\n            }\n        }\n        singleColPlacements.push(singlePlacements);\n        multiColPlacements.push(multiPlacements);\n        leftoverMargins.push(currentMarginTop);\n    }\n    return { singleColPlacements: singleColPlacements, multiColPlacements: multiColPlacements, leftoverMargins: leftoverMargins };\n}\nfunction groupRectsByEachCol(rects, colCnt) {\n    var rectsByEachCol = [];\n    for (var col = 0; col < colCnt; col += 1) {\n        rectsByEachCol.push([]);\n    }\n    for (var _i = 0, rects_3 = rects; _i < rects_3.length; _i++) {\n        var rect = rects_3[_i];\n        for (var col = rect.span.start; col < rect.span.end; col += 1) {\n            rectsByEachCol[col].push(rect);\n        }\n    }\n    return rectsByEachCol;\n}\nfunction resliceSeg(seg, spanStart, spanEnd, cells) {\n    if (seg.firstCol === spanStart && seg.lastCol === spanEnd - 1) {\n        return seg;\n    }\n    var eventRange = seg.eventRange;\n    var origRange = eventRange.range;\n    var slicedRange = intersectRanges(origRange, {\n        start: cells[spanStart].date,\n        end: addDays(cells[spanEnd - 1].date, 1),\n    });\n    return __assign(__assign({}, seg), { firstCol: spanStart, lastCol: spanEnd - 1, eventRange: {\n            def: eventRange.def,\n            ui: __assign(__assign({}, eventRange.ui), { durationEditable: false }),\n            instance: eventRange.instance,\n            range: slicedRange,\n        }, isStart: seg.isStart && slicedRange.start.valueOf() === origRange.start.valueOf(), isEnd: seg.isEnd && slicedRange.end.valueOf() === origRange.end.valueOf() });\n}\nvar DayGridSegHierarchy = /** @class */ (function (_super) {\n    __extends(DayGridSegHierarchy, _super);\n    function DayGridSegHierarchy() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        // config\n        _this.hiddenConsumes = false;\n        // allows us to keep hidden entries in the hierarchy so they take up space\n        _this.forceHidden = {};\n        return _this;\n    }\n    DayGridSegHierarchy.prototype.addSegs = function (segInputs) {\n        var _this = this;\n        var hiddenSegs = _super.prototype.addSegs.call(this, segInputs);\n        var entriesByLevel = this.entriesByLevel;\n        var excludeHidden = function (entry) { return !_this.forceHidden[buildEntryKey(entry)]; };\n        // remove the forced-hidden segs\n        for (var level = 0; level < entriesByLevel.length; level += 1) {\n            entriesByLevel[level] = entriesByLevel[level].filter(excludeHidden);\n        }\n        return hiddenSegs;\n    };\n    DayGridSegHierarchy.prototype.handleInvalidInsertion = function (insertion, entry, hiddenEntries) {\n        var _a = this, entriesByLevel = _a.entriesByLevel, forceHidden = _a.forceHidden;\n        var touchingEntry = insertion.touchingEntry, touchingLevel = insertion.touchingLevel, touchingLateral = insertion.touchingLateral;\n        if (this.hiddenConsumes && touchingEntry) {\n            var touchingEntryId = buildEntryKey(touchingEntry);\n            // if not already hidden\n            if (!forceHidden[touchingEntryId]) {\n                if (this.allowReslicing) {\n                    var placeholderEntry = __assign(__assign({}, touchingEntry), { span: intersectSpans(touchingEntry.span, entry.span) });\n                    var placeholderEntryId = buildEntryKey(placeholderEntry);\n                    forceHidden[placeholderEntryId] = true;\n                    entriesByLevel[touchingLevel][touchingLateral] = placeholderEntry; // replace touchingEntry with our placeholder\n                    this.splitEntry(touchingEntry, entry, hiddenEntries); // split up the touchingEntry, reinsert it\n                }\n                else {\n                    forceHidden[touchingEntryId] = true;\n                    hiddenEntries.push(touchingEntry);\n                }\n            }\n        }\n        return _super.prototype.handleInvalidInsertion.call(this, insertion, entry, hiddenEntries);\n    };\n    return DayGridSegHierarchy;\n}(SegHierarchy));\n\nvar TableRow = /** @class */ (function (_super) {\n    __extends(TableRow, _super);\n    function TableRow() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.cellElRefs = new RefMap(); // the <td>\n        _this.frameElRefs = new RefMap(); // the fc-daygrid-day-frame\n        _this.fgElRefs = new RefMap(); // the fc-daygrid-day-events\n        _this.segHarnessRefs = new RefMap(); // indexed by \"instanceId:firstCol\"\n        _this.rootElRef = createRef();\n        _this.state = {\n            framePositions: null,\n            maxContentHeight: null,\n            eventInstanceHeights: {},\n        };\n        return _this;\n    }\n    TableRow.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var options = context.options;\n        var colCnt = props.cells.length;\n        var businessHoursByCol = splitSegsByFirstCol(props.businessHourSegs, colCnt);\n        var bgEventSegsByCol = splitSegsByFirstCol(props.bgEventSegs, colCnt);\n        var highlightSegsByCol = splitSegsByFirstCol(this.getHighlightSegs(), colCnt);\n        var mirrorSegsByCol = splitSegsByFirstCol(this.getMirrorSegs(), colCnt);\n        var _b = computeFgSegPlacement(sortEventSegs(props.fgEventSegs, options.eventOrder), props.dayMaxEvents, props.dayMaxEventRows, options.eventOrderStrict, state.eventInstanceHeights, state.maxContentHeight, props.cells), singleColPlacements = _b.singleColPlacements, multiColPlacements = _b.multiColPlacements, moreCnts = _b.moreCnts, moreMarginTops = _b.moreMarginTops;\n        var isForcedInvisible = // TODO: messy way to compute this\n         (props.eventDrag && props.eventDrag.affectedInstances) ||\n            (props.eventResize && props.eventResize.affectedInstances) ||\n            {};\n        return (createElement(\"tr\", { ref: this.rootElRef, role: \"row\" },\n            props.renderIntro && props.renderIntro(),\n            props.cells.map(function (cell, col) {\n                var normalFgNodes = _this.renderFgSegs(col, props.forPrint ? singleColPlacements[col] : multiColPlacements[col], props.todayRange, isForcedInvisible);\n                var mirrorFgNodes = _this.renderFgSegs(col, buildMirrorPlacements(mirrorSegsByCol[col], multiColPlacements), props.todayRange, {}, Boolean(props.eventDrag), Boolean(props.eventResize), false);\n                return (createElement(TableCell, { key: cell.key, elRef: _this.cellElRefs.createRef(cell.key), innerElRef: _this.frameElRefs.createRef(cell.key) /* FF <td> problem, but okay to use for left/right. TODO: rename prop */, dateProfile: props.dateProfile, date: cell.date, showDayNumber: props.showDayNumbers, showWeekNumber: props.showWeekNumbers && col === 0, forceDayTop: props.showWeekNumbers /* even displaying weeknum for row, not necessarily day */, todayRange: props.todayRange, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, extraHookProps: cell.extraHookProps, extraDataAttrs: cell.extraDataAttrs, extraClassNames: cell.extraClassNames, extraDateSpan: cell.extraDateSpan, moreCnt: moreCnts[col], moreMarginTop: moreMarginTops[col], singlePlacements: singleColPlacements[col], fgContentElRef: _this.fgElRefs.createRef(cell.key), fgContent: ( // Fragment scopes the keys\n                    createElement(Fragment, null,\n                        createElement(Fragment, null, normalFgNodes),\n                        createElement(Fragment, null, mirrorFgNodes))), bgContent: ( // Fragment scopes the keys\n                    createElement(Fragment, null,\n                        _this.renderFillSegs(highlightSegsByCol[col], 'highlight'),\n                        _this.renderFillSegs(businessHoursByCol[col], 'non-business'),\n                        _this.renderFillSegs(bgEventSegsByCol[col], 'bg-event'))) }));\n            })));\n    };\n    TableRow.prototype.componentDidMount = function () {\n        this.updateSizing(true);\n    };\n    TableRow.prototype.componentDidUpdate = function (prevProps, prevState) {\n        var currentProps = this.props;\n        this.updateSizing(!isPropsEqual(prevProps, currentProps));\n    };\n    TableRow.prototype.getHighlightSegs = function () {\n        var props = this.props;\n        if (props.eventDrag && props.eventDrag.segs.length) { // messy check\n            return props.eventDrag.segs;\n        }\n        if (props.eventResize && props.eventResize.segs.length) { // messy check\n            return props.eventResize.segs;\n        }\n        return props.dateSelectionSegs;\n    };\n    TableRow.prototype.getMirrorSegs = function () {\n        var props = this.props;\n        if (props.eventResize && props.eventResize.segs.length) { // messy check\n            return props.eventResize.segs;\n        }\n        return [];\n    };\n    TableRow.prototype.renderFgSegs = function (col, segPlacements, todayRange, isForcedInvisible, isDragging, isResizing, isDateSelecting) {\n        var context = this.context;\n        var eventSelection = this.props.eventSelection;\n        var framePositions = this.state.framePositions;\n        var defaultDisplayEventEnd = this.props.cells.length === 1; // colCnt === 1\n        var isMirror = isDragging || isResizing || isDateSelecting;\n        var nodes = [];\n        if (framePositions) {\n            for (var _i = 0, segPlacements_1 = segPlacements; _i < segPlacements_1.length; _i++) {\n                var placement = segPlacements_1[_i];\n                var seg = placement.seg;\n                var instanceId = seg.eventRange.instance.instanceId;\n                var key = instanceId + ':' + col;\n                var isVisible = placement.isVisible && !isForcedInvisible[instanceId];\n                var isAbsolute = placement.isAbsolute;\n                var left = '';\n                var right = '';\n                if (isAbsolute) {\n                    if (context.isRtl) {\n                        right = 0;\n                        left = framePositions.lefts[seg.lastCol] - framePositions.lefts[seg.firstCol];\n                    }\n                    else {\n                        left = 0;\n                        right = framePositions.rights[seg.firstCol] - framePositions.rights[seg.lastCol];\n                    }\n                }\n                /*\n                known bug: events that are force to be list-item but span multiple days still take up space in later columns\n                todo: in print view, for multi-day events, don't display title within non-start/end segs\n                */\n                nodes.push(createElement(\"div\", { className: 'fc-daygrid-event-harness' + (isAbsolute ? ' fc-daygrid-event-harness-abs' : ''), key: key, ref: isMirror ? null : this.segHarnessRefs.createRef(key), style: {\n                        visibility: isVisible ? '' : 'hidden',\n                        marginTop: isAbsolute ? '' : placement.marginTop,\n                        top: isAbsolute ? placement.absoluteTop : '',\n                        left: left,\n                        right: right,\n                    } }, hasListItemDisplay(seg) ? (createElement(TableListItemEvent, __assign({ seg: seg, isDragging: isDragging, isSelected: instanceId === eventSelection, defaultDisplayEventEnd: defaultDisplayEventEnd }, getSegMeta(seg, todayRange)))) : (createElement(TableBlockEvent, __assign({ seg: seg, isDragging: isDragging, isResizing: isResizing, isDateSelecting: isDateSelecting, isSelected: instanceId === eventSelection, defaultDisplayEventEnd: defaultDisplayEventEnd }, getSegMeta(seg, todayRange))))));\n            }\n        }\n        return nodes;\n    };\n    TableRow.prototype.renderFillSegs = function (segs, fillType) {\n        var isRtl = this.context.isRtl;\n        var todayRange = this.props.todayRange;\n        var framePositions = this.state.framePositions;\n        var nodes = [];\n        if (framePositions) {\n            for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n                var seg = segs_1[_i];\n                var leftRightCss = isRtl ? {\n                    right: 0,\n                    left: framePositions.lefts[seg.lastCol] - framePositions.lefts[seg.firstCol],\n                } : {\n                    left: 0,\n                    right: framePositions.rights[seg.firstCol] - framePositions.rights[seg.lastCol],\n                };\n                nodes.push(createElement(\"div\", { key: buildEventRangeKey(seg.eventRange), className: \"fc-daygrid-bg-harness\", style: leftRightCss }, fillType === 'bg-event' ?\n                    createElement(BgEvent, __assign({ seg: seg }, getSegMeta(seg, todayRange))) :\n                    renderFill(fillType)));\n            }\n        }\n        return createElement.apply(void 0, __spreadArray([Fragment, {}], nodes));\n    };\n    TableRow.prototype.updateSizing = function (isExternalSizingChange) {\n        var _a = this, props = _a.props, frameElRefs = _a.frameElRefs;\n        if (!props.forPrint &&\n            props.clientWidth !== null // positioning ready?\n        ) {\n            if (isExternalSizingChange) {\n                var frameEls = props.cells.map(function (cell) { return frameElRefs.currentMap[cell.key]; });\n                if (frameEls.length) {\n                    var originEl = this.rootElRef.current;\n                    this.setState({\n                        framePositions: new PositionCache(originEl, frameEls, true, // isHorizontal\n                        false),\n                    });\n                }\n            }\n            var oldInstanceHeights = this.state.eventInstanceHeights;\n            var newInstanceHeights = this.queryEventInstanceHeights();\n            var limitByContentHeight = props.dayMaxEvents === true || props.dayMaxEventRows === true;\n            this.safeSetState({\n                // HACK to prevent oscillations of events being shown/hidden from max-event-rows\n                // Essentially, once you compute an element's height, never null-out.\n                // TODO: always display all events, as visibility:hidden?\n                eventInstanceHeights: __assign(__assign({}, oldInstanceHeights), newInstanceHeights),\n                maxContentHeight: limitByContentHeight ? this.computeMaxContentHeight() : null,\n            });\n        }\n    };\n    TableRow.prototype.queryEventInstanceHeights = function () {\n        var segElMap = this.segHarnessRefs.currentMap;\n        var eventInstanceHeights = {};\n        // get the max height amongst instance segs\n        for (var key in segElMap) {\n            var height = Math.round(segElMap[key].getBoundingClientRect().height);\n            var instanceId = key.split(':')[0]; // deconstruct how renderFgSegs makes the key\n            eventInstanceHeights[instanceId] = Math.max(eventInstanceHeights[instanceId] || 0, height);\n        }\n        return eventInstanceHeights;\n    };\n    TableRow.prototype.computeMaxContentHeight = function () {\n        var firstKey = this.props.cells[0].key;\n        var cellEl = this.cellElRefs.currentMap[firstKey];\n        var fcContainerEl = this.fgElRefs.currentMap[firstKey];\n        return cellEl.getBoundingClientRect().bottom - fcContainerEl.getBoundingClientRect().top;\n    };\n    TableRow.prototype.getCellEls = function () {\n        var elMap = this.cellElRefs.currentMap;\n        return this.props.cells.map(function (cell) { return elMap[cell.key]; });\n    };\n    return TableRow;\n}(DateComponent));\nTableRow.addStateEquality({\n    eventInstanceHeights: isPropsEqual,\n});\nfunction buildMirrorPlacements(mirrorSegs, colPlacements) {\n    if (!mirrorSegs.length) {\n        return [];\n    }\n    var topsByInstanceId = buildAbsoluteTopHash(colPlacements); // TODO: cache this at first render?\n    return mirrorSegs.map(function (seg) { return ({\n        seg: seg,\n        isVisible: true,\n        isAbsolute: true,\n        absoluteTop: topsByInstanceId[seg.eventRange.instance.instanceId],\n        marginTop: 0,\n    }); });\n}\nfunction buildAbsoluteTopHash(colPlacements) {\n    var topsByInstanceId = {};\n    for (var _i = 0, colPlacements_1 = colPlacements; _i < colPlacements_1.length; _i++) {\n        var placements = colPlacements_1[_i];\n        for (var _a = 0, placements_1 = placements; _a < placements_1.length; _a++) {\n            var placement = placements_1[_a];\n            topsByInstanceId[placement.seg.eventRange.instance.instanceId] = placement.absoluteTop;\n        }\n    }\n    return topsByInstanceId;\n}\n\nvar Table = /** @class */ (function (_super) {\n    __extends(Table, _super);\n    function Table() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.splitBusinessHourSegs = memoize(splitSegsByRow);\n        _this.splitBgEventSegs = memoize(splitSegsByRow);\n        _this.splitFgEventSegs = memoize(splitSegsByRow);\n        _this.splitDateSelectionSegs = memoize(splitSegsByRow);\n        _this.splitEventDrag = memoize(splitInteractionByRow);\n        _this.splitEventResize = memoize(splitInteractionByRow);\n        _this.rowRefs = new RefMap();\n        _this.handleRootEl = function (rootEl) {\n            _this.rootEl = rootEl;\n            if (rootEl) {\n                _this.context.registerInteractiveComponent(_this, {\n                    el: rootEl,\n                    isHitComboAllowed: _this.props.isHitComboAllowed,\n                });\n            }\n            else {\n                _this.context.unregisterInteractiveComponent(_this);\n            }\n        };\n        return _this;\n    }\n    Table.prototype.render = function () {\n        var _this = this;\n        var props = this.props;\n        var dateProfile = props.dateProfile, dayMaxEventRows = props.dayMaxEventRows, dayMaxEvents = props.dayMaxEvents, expandRows = props.expandRows;\n        var rowCnt = props.cells.length;\n        var businessHourSegsByRow = this.splitBusinessHourSegs(props.businessHourSegs, rowCnt);\n        var bgEventSegsByRow = this.splitBgEventSegs(props.bgEventSegs, rowCnt);\n        var fgEventSegsByRow = this.splitFgEventSegs(props.fgEventSegs, rowCnt);\n        var dateSelectionSegsByRow = this.splitDateSelectionSegs(props.dateSelectionSegs, rowCnt);\n        var eventDragByRow = this.splitEventDrag(props.eventDrag, rowCnt);\n        var eventResizeByRow = this.splitEventResize(props.eventResize, rowCnt);\n        var limitViaBalanced = dayMaxEvents === true || dayMaxEventRows === true;\n        // if rows can't expand to fill fixed height, can't do balanced-height event limit\n        // TODO: best place to normalize these options?\n        if (limitViaBalanced && !expandRows) {\n            limitViaBalanced = false;\n            dayMaxEventRows = null;\n            dayMaxEvents = null;\n        }\n        var classNames = [\n            'fc-daygrid-body',\n            limitViaBalanced ? 'fc-daygrid-body-balanced' : 'fc-daygrid-body-unbalanced',\n            expandRows ? '' : 'fc-daygrid-body-natural', // will height of one row depend on the others?\n        ];\n        return (createElement(\"div\", { className: classNames.join(' '), ref: this.handleRootEl, style: {\n                // these props are important to give this wrapper correct dimensions for interactions\n                // TODO: if we set it here, can we avoid giving to inner tables?\n                width: props.clientWidth,\n                minWidth: props.tableMinWidth,\n            } },\n            createElement(NowTimer, { unit: \"day\" }, function (nowDate, todayRange) { return (createElement(Fragment, null,\n                createElement(\"table\", { role: \"presentation\", className: \"fc-scrollgrid-sync-table\", style: {\n                        width: props.clientWidth,\n                        minWidth: props.tableMinWidth,\n                        height: expandRows ? props.clientHeight : '',\n                    } },\n                    props.colGroupNode,\n                    createElement(\"tbody\", { role: \"presentation\" }, props.cells.map(function (cells, row) { return (createElement(TableRow, { ref: _this.rowRefs.createRef(row), key: cells.length\n                            ? cells[0].date.toISOString() /* best? or put key on cell? or use diff formatter? */\n                            : row // in case there are no cells (like when resource view is loading)\n                        , showDayNumbers: rowCnt > 1, showWeekNumbers: props.showWeekNumbers, todayRange: todayRange, dateProfile: dateProfile, cells: cells, renderIntro: props.renderRowIntro, businessHourSegs: businessHourSegsByRow[row], eventSelection: props.eventSelection, bgEventSegs: bgEventSegsByRow[row].filter(isSegAllDay) /* hack */, fgEventSegs: fgEventSegsByRow[row], dateSelectionSegs: dateSelectionSegsByRow[row], eventDrag: eventDragByRow[row], eventResize: eventResizeByRow[row], dayMaxEvents: dayMaxEvents, dayMaxEventRows: dayMaxEventRows, clientWidth: props.clientWidth, clientHeight: props.clientHeight, forPrint: props.forPrint })); }))))); })));\n    };\n    // Hit System\n    // ----------------------------------------------------------------------------------------------------\n    Table.prototype.prepareHits = function () {\n        this.rowPositions = new PositionCache(this.rootEl, this.rowRefs.collect().map(function (rowObj) { return rowObj.getCellEls()[0]; }), // first cell el in each row. TODO: not optimal\n        false, true);\n        this.colPositions = new PositionCache(this.rootEl, this.rowRefs.currentMap[0].getCellEls(), // cell els in first row\n        true, // horizontal\n        false);\n    };\n    Table.prototype.queryHit = function (positionLeft, positionTop) {\n        var _a = this, colPositions = _a.colPositions, rowPositions = _a.rowPositions;\n        var col = colPositions.leftToIndex(positionLeft);\n        var row = rowPositions.topToIndex(positionTop);\n        if (row != null && col != null) {\n            var cell = this.props.cells[row][col];\n            return {\n                dateProfile: this.props.dateProfile,\n                dateSpan: __assign({ range: this.getCellRange(row, col), allDay: true }, cell.extraDateSpan),\n                dayEl: this.getCellEl(row, col),\n                rect: {\n                    left: colPositions.lefts[col],\n                    right: colPositions.rights[col],\n                    top: rowPositions.tops[row],\n                    bottom: rowPositions.bottoms[row],\n                },\n                layer: 0,\n            };\n        }\n        return null;\n    };\n    Table.prototype.getCellEl = function (row, col) {\n        return this.rowRefs.currentMap[row].getCellEls()[col]; // TODO: not optimal\n    };\n    Table.prototype.getCellRange = function (row, col) {\n        var start = this.props.cells[row][col].date;\n        var end = addDays(start, 1);\n        return { start: start, end: end };\n    };\n    return Table;\n}(DateComponent));\nfunction isSegAllDay(seg) {\n    return seg.eventRange.def.allDay;\n}\n\nvar DayTableSlicer = /** @class */ (function (_super) {\n    __extends(DayTableSlicer, _super);\n    function DayTableSlicer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.forceDayIfListItem = true;\n        return _this;\n    }\n    DayTableSlicer.prototype.sliceRange = function (dateRange, dayTableModel) {\n        return dayTableModel.sliceRange(dateRange);\n    };\n    return DayTableSlicer;\n}(Slicer));\n\nvar DayTable = /** @class */ (function (_super) {\n    __extends(DayTable, _super);\n    function DayTable() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.slicer = new DayTableSlicer();\n        _this.tableRef = createRef();\n        return _this;\n    }\n    DayTable.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        return (createElement(Table, __assign({ ref: this.tableRef }, this.slicer.sliceProps(props, props.dateProfile, props.nextDayThreshold, context, props.dayTableModel), { dateProfile: props.dateProfile, cells: props.dayTableModel.cells, colGroupNode: props.colGroupNode, tableMinWidth: props.tableMinWidth, renderRowIntro: props.renderRowIntro, dayMaxEvents: props.dayMaxEvents, dayMaxEventRows: props.dayMaxEventRows, showWeekNumbers: props.showWeekNumbers, expandRows: props.expandRows, headerAlignElRef: props.headerAlignElRef, clientWidth: props.clientWidth, clientHeight: props.clientHeight, forPrint: props.forPrint })));\n    };\n    return DayTable;\n}(DateComponent));\n\nvar DayTableView = /** @class */ (function (_super) {\n    __extends(DayTableView, _super);\n    function DayTableView() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.buildDayTableModel = memoize(buildDayTableModel);\n        _this.headerRef = createRef();\n        _this.tableRef = createRef();\n        return _this;\n    }\n    DayTableView.prototype.render = function () {\n        var _this = this;\n        var _a = this.context, options = _a.options, dateProfileGenerator = _a.dateProfileGenerator;\n        var props = this.props;\n        var dayTableModel = this.buildDayTableModel(props.dateProfile, dateProfileGenerator);\n        var headerContent = options.dayHeaders && (createElement(DayHeader, { ref: this.headerRef, dateProfile: props.dateProfile, dates: dayTableModel.headerDates, datesRepDistinctDays: dayTableModel.rowCnt === 1 }));\n        var bodyContent = function (contentArg) { return (createElement(DayTable, { ref: _this.tableRef, dateProfile: props.dateProfile, dayTableModel: dayTableModel, businessHours: props.businessHours, dateSelection: props.dateSelection, eventStore: props.eventStore, eventUiBases: props.eventUiBases, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, nextDayThreshold: options.nextDayThreshold, colGroupNode: contentArg.tableColGroupNode, tableMinWidth: contentArg.tableMinWidth, dayMaxEvents: options.dayMaxEvents, dayMaxEventRows: options.dayMaxEventRows, showWeekNumbers: options.weekNumbers, expandRows: !props.isHeightAuto, headerAlignElRef: _this.headerElRef, clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, forPrint: props.forPrint })); };\n        return options.dayMinWidth\n            ? this.renderHScrollLayout(headerContent, bodyContent, dayTableModel.colCnt, options.dayMinWidth)\n            : this.renderSimpleLayout(headerContent, bodyContent);\n    };\n    return DayTableView;\n}(TableView));\nfunction buildDayTableModel(dateProfile, dateProfileGenerator) {\n    var daySeries = new DaySeriesModel(dateProfile.renderRange, dateProfileGenerator);\n    return new DayTableModel(daySeries, /year|month|week/.test(dateProfile.currentRangeUnit));\n}\n\nvar TableDateProfileGenerator = /** @class */ (function (_super) {\n    __extends(TableDateProfileGenerator, _super);\n    function TableDateProfileGenerator() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    // Computes the date range that will be rendered.\n    TableDateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n        var dateEnv = this.props.dateEnv;\n        var renderRange = _super.prototype.buildRenderRange.call(this, currentRange, currentRangeUnit, isRangeAllDay);\n        var start = renderRange.start;\n        var end = renderRange.end;\n        var endOfWeek;\n        // year and month views should be aligned with weeks. this is already done for week\n        if (/^(year|month)$/.test(currentRangeUnit)) {\n            start = dateEnv.startOfWeek(start);\n            // make end-of-week if not already\n            endOfWeek = dateEnv.startOfWeek(end);\n            if (endOfWeek.valueOf() !== end.valueOf()) {\n                end = addWeeks(endOfWeek, 1);\n            }\n        }\n        // ensure 6 weeks\n        if (this.props.monthMode &&\n            this.props.fixedWeekCount) {\n            var rowCnt = Math.ceil(// could be partial weeks due to hiddenDays\n            diffWeeks(start, end));\n            end = addWeeks(end, 6 - rowCnt);\n        }\n        return { start: start, end: end };\n    };\n    return TableDateProfileGenerator;\n}(DateProfileGenerator));\n\nvar main = createPlugin({\n    initialView: 'dayGridMonth',\n    views: {\n        dayGrid: {\n            component: DayTableView,\n            dateProfileGeneratorClass: TableDateProfileGenerator,\n        },\n        dayGridDay: {\n            type: 'dayGrid',\n            duration: { days: 1 },\n        },\n        dayGridWeek: {\n            type: 'dayGrid',\n            duration: { weeks: 1 },\n        },\n        dayGridMonth: {\n            type: 'dayGrid',\n            duration: { months: 1 },\n            monthMode: true,\n            fixedWeekCount: true,\n        },\n    },\n});\n\nexport default main;\nexport { DayTableView as DayGridView, DayTable, DayTableSlicer, Table, TableView, buildDayTableModel };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}